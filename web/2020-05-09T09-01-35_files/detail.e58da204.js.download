/*
BUILT_AT: 2020年5月7日 09:14
*/
!function(t){function e(e){for(var i,a,s=e[0],c=e[1],u=e[2],d=0,f=[];d<s.length;d++)a=s[d],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&f.push(o[a][0]),o[a]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);for(l&&l(e);f.length;)f.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],i=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(i=!1)}i&&(r.splice(e--,1),t=a(a.s=n[0]))}return t}var i={},o={3:0},r=[];function a(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.e=function(t){var e=[],n=o[t];if(0!==n)if(n)e.push(n[2]);else{var i=new Promise(function(e,i){n=o[t]=[e,i]});e.push(n[2]=i);var r,s=document.createElement("script");s.charset="utf-8",s.timeout=120,a.nc&&s.setAttribute("nonce",a.nc),s.src=function(t){return a.p+"static/js/"+({}[t]||t)+".e58da204.js"}(t);var c=new Error;r=function(e){s.onerror=s.onload=null,clearTimeout(u);var n=o[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;c.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",c.name="ChunkLoadError",c.type=i,c.request=r,n[1](c)}o[t]=void 0}};var u=setTimeout(function(){r({type:"timeout",target:s})},12e4);s.onerror=s.onload=r,document.head.appendChild(s)}return Promise.all(e)},a.m=t,a.c=i,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(n,i,function(e){return t[e]}.bind(null,i));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="//s2.hdslb.com/bfs/static/blive/blfe-dynamic-web/",a.oe=function(t){throw console.error(t),t};var s=("undefined"!=typeof self?self:this).webpackJsonp=("undefined"!=typeof self?self:this).webpackJsonp||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var l=c;r.push([522,0,1]),n()}([function(t,e,n){"use strict";var i={ALL:268435455,REPOST:1,PIC:2,WORD:4,VIDEO:8,CLIP:16,DRAMA:32,ARTICLE:64,MUSIC:256,BANGUMI:512,NONE:1024,H5_SHARE:2048,COMIC_SHARE:2049,PGC_BANGUMI:4097,FILM:4098,TV:4099,GUOCHUANG:4100,DOCUMENTARY:4101,LIVE_ROOM:4200,LIVE:4201,MEDIA_LIST:4300,CHEESE_SERIES:4302,CHEESE_UPDATE:4303,LIVE_PUSH:4308,HOT:1e3,QUICK:1001},o={LOAD_NOTICE:"LOAD_NOTICE",SCROLL:"SCROLL",REMOVE_SCROLL:"REMOVE_SCROLL",UNFOCUS:"UNFOCUS",STORAGE_UPDATE:"STORAGE_UPDATE",ADD:"ADD",LOCATE_CARD_EL:"LOCATE_CARD_EL",SET_TOP:"SET_TOP",IFRAME_WRAPPER_CLICK:"IFRAME_WRAPPER_CLICK",MORE_PANEL_CLOSE:"MORE_PANEL_CLOSE",FORWARDING_SCROLL:"FORWARDING_SCROLL",FORWARD_DYNAMIC:"FORWARD_DYNAMIC",INSERT_FORWARDING:"INSERT_FORWARDING",COMM_FOCUS:"COMM_FOCUS",COMM_SCROLL:"COMM_SCROLL",INSERT_COMM:"INSERT_COMM",DELETE_ITEM_COMM:"DELETE_ITEM_COMM",DELETE_CHILDITEM_COMM:"DELETE_CHILD_COMM",ADD_FORWARD_COUNT:"ADD_FORWARD_COUNT",ATTENTION_LIST_UPDATE:"ATTENTION_LIST_UPDATE"},r={MAIN:"MAIN",GUEST:"GUEST",DETAIL:"DETAIL",SPACE:"SPACE",LIVE:"LIVE",TAG:"TAG",GAME:"GAME"},a={NAV_INDEX:"nav_index",NAV_HEAD:"nav_head",NAV_IM:"nav_im",NAV_PUBLISH:"nav_publish",INFO_HEAD:"info_head",INFO_NICKNAME:"info_nickname",INFO_FOLLOW:"info_follow",INFO_FANS:"info_fans",INFO_DYNAMIC:"info_dynamic",TOPIC:"topic",MYTOPIC_SHOW:"mytopic_show",MYTOPIC_ITEMCLICK:"mytopic_itemclick",MYTOPIC_MORE:"mytopic_more",HOTTOPIC_SHOW:"hottopic_show",HOTTOPIC_ITEMCLICK:"hottopic_itemclick",HOTTOPIC_MORE:"hottopic_more",MYTOPIC_LISTCLICK:"mytopic_listclick",HOTTOPIC_LISTCLICK:"hottopic_listclick",LIVE_SHOW:"live_show",LIVE_HEAD:"live_head",LIVE_NICKNAME:"live_nickname",LIVE_MORE:"live_more",LIVE_TITLE:"live_title",LIVE_GROUP_TEST_VIEW:"live_group_test_view",LIVE_GROUP_TEST_CLICK:"live_group_test_click",NEWS_BANNER:"news_banner",NEWS_CONTENT:"news_content",PUBLICH_EMOJI_1:"publish_emoji1",PUBLICH_EMOJI_2:"publish_emoji2",PUBLICH_PIC_1:"publish_pic1",PUBLICH_PIC_2:"publish_pic2",PUBLICH_CLICK_1:"publish_click1",PUBLICH_CLICK_2:"publish_click2",PUBLISH_AT_LIST_SHOW_1:"publish_at_list_show1",PUBLISH_AT_LIST_SHOW_2:"publish_at_list_show2",TAB_CLICK:"tab_click",CARD_HEAD:"card_head",CARD_NICKNAME:"card_nickname",CARD_SHARE_NICKNAME:"card_share_nickname",CARD_SHARE_1:"card_share_1",CARD_COMMENT_1:"card_comment_1",CARD_LIKE_1:"card_like_1",CARD_SHARE_0:"card_share_0",CARD_COMMENT_0:"card_comment_0",CARD_LIKE_0:"card_like_0",CARD_COMMENT_2:"card_comment_2",CARD_COMMENT_3:"card_comment_3",CARD_SHARE_2:"card_share_2",CARD_SHARE_3:"card_share_3",CARD_BPM:"card_bpm",CARD_ORIGINAL_PIC:"card_original_pic",CARD_CLICK:"card_click",CARD_VC_PLAY:"card_vc_play",CARD_WATCH_LATER:"card_watch_later",CARD_SHOW:"card_show",CARD_WATCH_LATER_CANCEL:"card_watch_later_cancel",PUBLISH_AT_LIST_SHOW:"publish_at_list_show",CARD_ATCLICK:"card_atclick",CARD_RT_ATCLICK:"card_rt_atclick",PAGE_HOTSHOW:"page_hotshow",HOTFOLLOW:"hotfollow",LIVEVIEW:"liveview",TAGVIEW:"tagview",POLLCLICK:"pollclick",LOTTERY_RETWEET:"lottery_retweet",DETAIL_VISIT:"detail_visit",DETAIL_USERPIC_CLICK:"detail_userpic_click",DETAIL_NICKNAME_CLICK:"detail_nickname_click",DETAIL_FOLLOW_CLICK:"detail_follow_click",DETAIL_TAB_COMMENT_CLICK:"detail_tab_comment_click",DETAIL_TAB_COMMENT_USERPIC_CLICK:"detail_tab_comment_userpic_click",DETAIL_TAB_RETWEET_CLICK:"detail_tab_retweet_click",DETAIL_TAB_RETWEET_USERPIC_CLICK:"detail_tab_retweet_userpic_click",DETAIL_CONTENT_CLICK:"detail_content_click",DETAIL_AT_CLICK:"detail_at_click",DETAIL_LINK_CLICK:"detail_link_click",DETAIL_RETWEETUSER_CLICK:"detail_retweetuser_click",DETAIL_GOTOAPP_CLICK:"detail_gotoapp_click",DT_DETAIL_PIC_CLICK:"dt_detail_pic_click",DT_DETAIL_PIC_CLICKOFF:"dt_detail_pic_clickoff",CARD_MORE_TOP:"card_more_top",CARD_MORE_UNTOP:"card_more_untop",TIMER_VISIT:"timer_visit",TIMER_ICON:"timer_icon",TIMER_SET:"timer_set",TIMER_EDIT:"timer_edit",TIMER_PUBLISH:"timer_publish",TIMER_DELETE:"timer_delete",FOLD_SHOW:"fold_show",FOLD_CLICK:"fold_click",MORETOPIC:"moretopic",NOLOGIN_TOPIC:"nologin_topic",NOLOGIN_LOGIN:"nologin_login",NOLOGIN_REGISTER:"nologin_register",LOGIN_SUCCESS:"login_success",ITEM_CLICK:"item_click",SHOP_CARD_SHOW:"itemcard_show",SHOP_CARD_CLICK:"itemcard_click",TOP_PROFILE_PICTURE:"top_profile_picture",TOP_PROFILE_PICTURE_CLICK:"top_profile_picture_click",TOP_PROFILE_PICTURE_PAGE_CLICK:"top_profile_picture_page_click"},s=(n(58),[{title:"全部",type:i.ALL},{title:"投稿视频",type:i.VIDEO},{title:"追番追剧",type:[i.BANGUMI,i.PGC_BANGUMI,i.FILM,i.TV,i.GUOCHUANG,i.DOCUMENTARY].join(",")},{title:"专栏",type:i.ARTICLE}]);n.d(e,"a",function(){return i}),n.d(e,"b",function(){return o}),n.d(e,"c",function(){return r}),n.d(e,"d",function(){return a}),n.d(e,"e",function(){return s})},,,,function(t,e,n){"use strict";n(13),n(32),n(28),n(24),n(58),n(151),n(237),n(49),n(12),n(31),n(21),n(30);var i=n(6),o={generateAtUsers:function(t,e,n){var o=[];if(n&&o.push(n),!e||""===e)return o;var r=Object(i.e)(e);return Array.isArray(r)||(r=[]),r.forEach(function(e){var n={uid:~~e.data,uname:t.substr(e.location+1,e.length-1)};0===o.filter(function(t){return t.uid===n.uid}).length&&o.push(n)}),o},generateAtParams:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i={};n.forEach(function(e){t.indexOf("@".concat(e.uname))>=0&&(i[e.uid]=e.uid)});var o=[],r=n.concat(e),a={};r.forEach(function(t){a[t.uid]=t}),r=Object.values(a);var s=t;r.sort(function(t,e){return e.uname.length-t.uname.length}).forEach(function(t){var e=new RegExp("@".concat(t.uname.replace(/[.*?+$^[\](){}|\\]/g,"\\$&")),"g");s=s.replace(e,function(e,n){var i={data:"".concat(t.uid),location:n,length:e.length,type:1};o.push(i);for(var r="",a=0;a<e.length;a++)r+="*";return r})}),o.sort(function(t,e){return t.location-e.location});var c=Object.values(i).join(","),u=JSON.stringify(o);return{atUids:c,ctrl:u}}},r=n(9),a=new(n.n(r).a)({}),s=function(t,e){var n={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(var i in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?n[i]:("00"+n[i]).substr((""+n[i]).length)));return e},c=function t(e){var n=e.offsetTop;return null!==e.offsetParent&&(n+=t(e.offsetParent)),n},u=(n(15),n(19),n(20),n(14),n(41),n(34),n(48),n(10),n(17),n(56),n(16),n(5),n(8),n(26));var l=function(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;")},d=n(38),f={set:function(t,e){localStorage.setItem(t,JSON.stringify(e)||"")},get:function(t){return localStorage.getItem(t)||""},add:function(t,e){var n=localStorage.getItem(t),o=[];n&&(o=Object(i.e)(n),Array.isArray(o)||(o=[])),o.unshift(e),localStorage.setItem(t,JSON.stringify(o))},addList:function(t,e){var n=localStorage.getItem(t),o=[];n&&(o=Object(i.e)(n),Array.isArray(o)||(o=[])),o=e.concat(o),localStorage.setItem(t,JSON.stringify(o))},delete:function(t,e){var n=localStorage.getItem(t);if(n){var o=Object(i.e)(n);Array.isArray(o)&&(o=o.filter(function(t){return t.desc.dynamic_id!==e.desc.dynamic_id}),localStorage.setItem(t,JSON.stringify(o)))}},replace:function(t,e){var n=localStorage.getItem(t);if(n){var o=Object(i.e)(n);if(Array.isArray(o)){for(var r=0;r<o.length;r++){o[r].desc.dynamic_id===e.desc.dynamic_id&&(o[r]=e)}localStorage.setItem(t,JSON.stringify(o))}}}},p=(n(59),{mid:0,uname:"",isLogin:!1}),h={card:{attention:0,face:"//static.hdslb.com/images/member/noface.gif",fans:0,mid:"0",name:"",sex:"",vip:{vipType:0,vipStatus:0}},space:{s_img:"//i2.hdslb.com/bfs/space/768cc4fd97618cf589d23c2711a1d1a729f42235.png"}},m=[],g=p,v=h,b=!1,y=!1,_=!1,w={setMyLoginInfo:function(t){g=t,b=!0},getMyLoginInfo:function(){return g},resetMyLoginInfo:function(){g=p,b=!1},setMyUserInfo:function(t){v=t,y=!0},getMyUserInfo:function(){return v},resetMyUserInfo:function(){v=h,y=!1},setMyAttentionList:function(t){m=t,_=!0},getMyAttentionList:function(){return m},insertToMyAttentionList:function(t){-1===m.indexOf(t)&&m.push(t)},deleteFromMyAttentionList:function(t){var e=m.indexOf(t);-1!==e&&m.splice(e,1)},resetMyAttentionList:function(){m=[],_=!1},getUid:function(){return g.mid},isInitMyLoginInfo:b,isInitMyUserInfo:y,isInitMyAttentionList:_};function C(t){if(!t)return"";var e=t.childNodes,n=e.length;e.length&&"BR"===e[e.length-1].nodeName&&(n-=1);for(var i="",o=0;o<n;o++)"#text"===e[o].nodeName?i+=e[o].nodeValue:"BR"===e[o].nodeName?i+="\n":"INPUT"===e[o].nodeName?i+=e[o].defaultValue:"DIV"===e[o].nodeName?i+="\n"+C(e[o]):"BUTTON"===e[o].nodeName?i+=C(e[o]):"IMG"===e[o].nodeName?i+=e[o].alt:(e[o].nodeName,i+=C(e[o]));return i}function x(t){var e,n;if(window.getSelection){if((e=window.getSelection()).getRangeAt&&e.rangeCount){(n=e.getRangeAt(0)).deleteContents();var i=document.createElement("div");i.innerHTML=t;for(var o,r,a=document.createDocumentFragment();o=i.firstChild;)r=a.appendChild(o);if(n.insertNode(a),r){n=n.cloneRange();try{n.setStartAfter(r)}catch(t){console.warn(t)}n.collapse(!0),e.removeAllRanges(),e.addRange(n)}}}else document.selection&&"Control"!==document.selection.type&&document.selection.createRange().pasteHTML(t)}function I(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=0,i=t.ownerDocument||t.document,o=i.defaultView||i.parentWindow;if("DIV"===t.tagName){if(o.getSelection().rangeCount>0){var r=o.getSelection().getRangeAt(0),a=r.cloneRange();a.selectNodeContents(t),a.setEnd(r.endContainer,r.endOffset);var s=C(a.cloneContents());n=s.length,e&&(n=s.replace(/\n/g,"").length)}}else n=t.selectionEnd;return n}function k(t,e){var n,o,r=-1!==Object(i.d)().indexOf("Safari");"DIV"===t.tagName||r?((n=document.createRange()).selectNodeContents(t),t.innerHTML&&t.innerHTML.length>0&&n.collapse(t,e),n.collapse(!0),(o=window.getSelection()).removeAllRanges(),o.addRange(n)):t.setSelectionRange(e,e)}function S(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("string"!=typeof t)return 0;var e=t.length;if(/[\u0000-\u00ff]/.test(t)){var n=t.replace(/[\u0000-\u00ff]/g,"").length;e=Math.ceil((e-n)/2)+n}return e}n(57);function O(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("string"!=typeof t)return"";if(e<1)return t;if(S(t)<=e)return t;for(var n="",i=0,o=t.split(""),r=0;r<o.length&&(/[\u0000-\u00ff]/.test(o[r])?i+=.5:i+=1,!(i>e));r++)n+=o[r];return n+"..."}n(36);function P(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("string"!=typeof t)return"";if(e<1)return"";var n=new RegExp("^([^\\n\\r↵]*[\\n\\r↵]){".concat(e,"}")),i=t.match(n);return i?i[0].replace(/[\n\r↵]+$/,"")+"...":t+"..."}n.d(e,"a",function(){return o}),n.d(e,"b",function(){return a}),n.d(e,"f",function(){return s}),n.d(e,"j",function(){return c}),n.d(e,"k",function(){return u.b}),n.d(e,"o",function(){return u.d}),n.d(e,"q",function(){return d.d}),n.d(e,"p",function(){return d.e}),n.d(e,"m",function(){return d.b}),n.d(e,"n",function(){return d.c}),n.d(e,"e",function(){return l}),n.d(e,"s",function(){return f}),n.d(e,"t",function(){return w}),n.d(e,"l",function(){return x}),n.d(e,"h",function(){return C}),n.d(e,"g",function(){return I}),n.d(e,"r",function(){return k}),n.d(e,"i",function(){return S}),n.d(e,"c",function(){return O}),n.d(e,"d",function(){return P})},function(t,e,n){"use strict";var i={API_LIVE:"//api.live.bilibili.com",API_VC:"//api.vc.bilibili.com",API_MAIN:"//api.bilibili.com",API_VC_CO:"//api.vc.bilibili.co",API_MAIN_CO:"//api.bilibili.co",MAIN:"//www.bilibili.com",SPACE:"//space.bilibili.com",PASSPORT:"//passport.bilibili.com",BANGUMI:"//bangumi.bilibili.com",DATA:"//data.bilibili.com",T:"//t.bilibili.com",H:"//h.bilibili.com",VC:"//vc.bilibili.com",APP:"//app.bilibili.com",MESSAGE:"//message.bilibili.com",LINK:"//link.bilibili.com",M:"//m.bilibili.com",LIVE:"//live.bilibili.com"};n.d(e,"a",function(){return i})},function(t,e,n){"use strict";n(27),n(18),n(49),n(12),n(31),n(21),n(57);var i={getItem:function(t){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(t,e,n,i,o,r){if(!t||/^(?:expires|max\-age|path|domain|secure)$/i.test(t))return!1;var a="";if(n)switch(n.constructor){case Number:a=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:a="; expires="+n;break;case Date:a="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(t)+"="+encodeURIComponent(e)+a+(o?"; domain="+o:"")+(i?"; path="+i:"")+(r?"; secure":""),!0},removeItem:function(t,e,n){return!(!t||!this.hasItem(t))&&(document.cookie=encodeURIComponent(t)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(e?"; path="+e:""),!0)},hasItem:function(t){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var t=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),e=0;e<t.length;e++)t[e]=decodeURIComponent(t[e]);return t}},o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n={},i="debounce-key";return function(){for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];n[i]&&clearTimeout(n[i]),n[i]=setTimeout(function(){n[i]=null,t.apply(void 0,r)},e)}};n(24),n(36);var r=function(){try{if("undefined"!=typeof navigator&&/Firefox\/(\d+)/i.test(navigator.userAgent))return navigator.userAgent.match(/Firefox\/(\d+)/i)[1]>=65;var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))&&0===t.toDataURL("image/webp").indexOf("data:image/webp")}catch(t){return!1}}(),a=(n(47),"undefined"!=typeof window?window.navigator.userAgent:""),s={myBrowser:"unknown",behaviors:[function(){return!!a.match(/Maxthon\/[4]/)&&"Maxthon 4"},function(){return!!a.match(/TheWorld/)&&"TheWorld"},function(){return!!a.match(/Firefox\/\d.*/)&&"Firefox"},function(){return!(!a.match(/AppleWebKit\/\d.*.Chrome\/\d.*.Safari\/\d/)||"Google Inc."!==window.navigator.vendor||!window.chrome)&&"Chrome"},function(){return!!a.match(/Opera.\d.*.Presto\/\d/)&&"Opera Presto"},function(){return!!a.match(/OPR\/\d{2}/)&&"Opera Modern"},function(){return!!a.match(/MSIE [6-8].+/)&&"IE Legacy"},function(){return!(!a.match(/MSIE [9].+/)||"function"!=typeof window.ScriptEngine||"JScript"!==window.ScriptEngine())&&"IE 9"},function(){return!(!a.match(/MSIE [10].+/)||"function"!=typeof window.ScriptEngine||"JScript"!==window.ScriptEngine())&&"IE 10"},function(){return!(!a.match(/Trident\/[7].*.rv:11/)||"function"!=typeof window.ScriptEngine||"JScript"!==window.ScriptEngine())&&"IE 11"},function(){return!(!a.match(/Edge\/\d+\.\d+/)||"function"!=typeof window.StyleMedia)&&"Edge"},function(){return!(!a.match(/AppleWebKit\/\d.*.Mobile.*Safari\/\d+/)||"Apple Computer, Inc."!==window.navigator.vendor)&&"SafariMobile"},function(){return!(!a.match(/AppleWebKit\/\d.*.Safari\/\d+/)||"Apple Computer, Inc."!==window.navigator.vendor)&&"Safari"}]};var c=function(){return"undefined"==typeof window?"":(s.behaviors.some(function(t){var e=t();return s.myBrowser=e||"unknown",e}),s.myBrowser)},u=function(t){if("string"!=typeof t)return"";var e;try{e=JSON.parse(t)}catch(t){e=""}return e},l=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,i=!0;return function(){if(!i)return e;i=!1,setTimeout(function(){i=!0},n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.apply(void 0,r)}},d=function(t){return"string"==typeof t?t.replace(/^https?:/g,""):""},f=(n(32),n(28),n(142),n(30),function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return{};var n={},i="";if(e){var o=t.href||"",r=o.match(/\?[^#\/]*/g);r&&(i=r[r.length-1])}else i=t.search;if(~i.indexOf("?")){var a=i.split("?")[1]||"",s=a.split("&");s.forEach(function(t){if(t){var e=t.indexOf("=");if(e>0){var i=t.substring(0,e),o=t.substring(e+1);n[i]=o}}})}var c=t.pathname.split(/\//g).filter(function(t){return""!==t});return{params:n,path:c}});n.d(e,"a",function(){return i}),n.d(e,"b",function(){return o}),n.d(e,"c",function(){return r}),n.d(e,"d",function(){return c}),n.d(e,"e",function(){return u}),n.d(e,"f",function(){return l}),n.d(e,"g",function(){return d}),n.d(e,"h",function(){return f})},function(t,e,n){"use strict";n(13);var i=n(6),o=n(0),r=function(t){var e,n,r=Object(i.e)(t.card);if(!r)return{card_type:"",card_id:"",dynamic_id:""};var a=t.desc.dynamic_id,s={};switch(t.desc.type){case o.a.ALL:n="sum";break;case o.a.REPOST:e=a,n="share";break;case o.a.PIC:e=r.item.id,n="ywh";break;case o.a.WORD:e=a,n="text";break;case o.a.VIDEO:e=r.aid,n="video";break;case o.a.CLIP:e=r.item.id,n="vc";break;case o.a.ARTICLE:e=r.id,n="article";break;case o.a.MUSIC:e=r.id,n="music";break;case o.a.BANGUMI:e="".concat(r.apiSeasonInfo.season_id,",").concat(r.episode_id),n="bangumi";break;case o.a.H5_SHARE:e=a,n="h5share";break;case o.a.FILM:e="".concat(r.apiSeasonInfo.season_id,",").concat(r.episode_id),n="movie";break;case o.a.TV:e="".concat(r.apiSeasonInfo.season_id,",").concat(r.episode_id),n="tv";break;case o.a.DOCUMENTARY:s=r.apiSeasonInfo||r.season||{},e="".concat(s.season_id,",").concat(r.episode_id),n="documentary";break;case o.a.LIVE:case o.a.LIVE_ROOM:e=r.roomid,n="live";break;case o.a.MEDIA_LIST:e=r.id,n="playlist";break;case o.a.CHEESE_SERIES:e=r.id,n="cheese";break;case o.a.CHEESE_UPDATE:e=r.id,n="cheese_update";break;default:e="",n=""}return{card_type:n,card_id:e,dynamic_id:a}},a=function(t){var e,n,r=Object(i.e)(t.card),a=t.desc.type===o.a.REPOST,s=a?t.desc.orig_type:t.desc.type,c=a?Object(i.e)(r.origin):r,u=a?t.desc.orig_dy_id:t.desc.dynamic_id;if(!c)return{card_type:"",card_id:"",dynamic_id:""};var l={};switch(s){case o.a.ALL:n="sum";break;case o.a.PIC:e=c.item.id,n="ywh";break;case o.a.WORD:e=u,n="text";break;case o.a.VIDEO:e=c.aid,n="video";break;case o.a.CLIP:e=c.item.id,n="vc";break;case o.a.ARTICLE:e=c.id,n="article";break;case o.a.MUSIC:e=c.id,n="music";break;case o.a.BANGUMI:e="".concat(c.apiSeasonInfo.season_id,",").concat(c.episode_id),n="bangumi";break;case o.a.H5_SHARE:e=u,n="h5share";break;case o.a.FILM:e="".concat(c.apiSeasonInfo.season_id,",").concat(c.episode_id),n="movie";break;case o.a.TV:e="".concat(c.apiSeasonInfo.season_id,",").concat(c.episode_id),n="tv";break;case o.a.DOCUMENTARY:l=c.apiSeasonInfo||c.season||{},e="".concat(l.season_id,",").concat(c.episode_id),n="documentary";break;case o.a.LIVE:case o.a.LIVE_ROOM:e=c.roomid,n="live";break;case o.a.MEDIA_LIST:e=c.id,n="playlist";break;case o.a.CHEESE_SERIES:case o.a.CHEESE_UPDATE:e=c.id,n="cheese";break;default:e="",n=""}return{card_type:n,card_id:e,dynamic_id:u}},s=(n(34),"//s1.hdslb.com/bfs/seed/bplus-common/statistics-js/log-reporter.js"),c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(window.__bp_statisObserverConfig=Object.assign({spmId:t,baseURL:"//data.bilibili.com/log/web",selfDefMsgs:"",clickConfig:{isDoubleWrite:!0,logId:n,msgAttrName:"data-report"},pvConfig:{isDoubleWrite:!0,logId:e,selfDefMsg:i},selfConfig:{isDoubleWrite:!0,logId:n}},window.__bp_statisObserverConfig),void 0===window.__bp_statisObserver){var o=document.createElement("script");o.onload=function(){setTimeout(function(){if(window.__bp_preDefaultMsgObj&&window.__bp_defaultMsgObj&&window.__bp_statisObserver)for(var t=window.__bp_preDefaultMsgObj.length;t>0;){var e=window.__bp_preDefaultMsgObj[t-1];window.__bp_defaultMsgObj[e.key]=e.value,window.__bp_statisObserver.forceCommit(),t--}},1e3)},o.src=s,document.getElementsByTagName("body")[0].appendChild(o)}},u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(window.__bp_defaultMsgObj&&window.__bp_statisObserver){window.__bp_defaultMsgObj[t]=e;try{window.__bp_statisObserver.forceCommit()}catch(t){console.log(t)}}else window.__bp_preDefaultMsgObj?window.__bp_preDefaultMsgObj.push({key:t,value:e}):window.__bp_preDefaultMsgObj=[{key:t,value:e}]};n.d(e,"a",function(){return r}),n.d(e,"b",function(){return a}),n.d(e,"c",function(){return c}),n.d(e,"d",function(){return u})},function(t,e,n){"use strict";n(13);var i=function(t){var e="请先绑定手机",i="你还没有绑定手机哦~",o="去绑定",r="//passport.bilibili.com/site/site.html";t.bpPopup({title:e,html:'\n      <div style="margin: 20px 0; text-align: center; color: #999">\n        <img src="'.concat(n(236),'" style="margin-bottom: 10px">\n        <p>').concat(i,"</p>\n      </div>\n    "),button:{confirm:o,cancel:"以后再说"}}).onConfirm(function(t){window.open(r,"_blank"),t.close()})},o=(n(32),n(58),n(44),n(12),n(36),n(21),n(6)),r=/\/bfs\//,a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=t;if(!o.c&&/\.webp$/.test(t)&&(/@/.test(t)?a=t.replace(/\.webp$/,".jpg"):a+="@.jpg"),"undefined"!=typeof window&&window&&window._bp_audit_mode||!t||"string"!=typeof t||!/\.(jpg|png|gif)(@\w*)?$/.test(t)||!r.test(t))return encodeURI(a);var c=(t=t.replace(/(\.\w+)@\w*$/,function(t,e){return e})).match(/\.(jpg|png|gif)$/)[0],u=!1===i.autoDpr||"undefined"==typeof window?1:parseInt(window.devicePixelRatio)||1,l=Math.ceil(e),d=Math.ceil(n),f=l?"".concat(l*u,"w"):"",p=d?"".concat(d*u,"h"):"",h=s(i.p,"p"),m=s(i.e,"e"),g=s(i.c,"c"),v=i.others?i.others:"",b=[f,p,h,m,g,v],y=b.filter(function(t){return""!==t}).join("_"),_=o.c&&!1!==i.useWebp,w=_?".webp":c,C=f||p||g||v||_;return encodeURI(C?"".concat(t,"@").concat(y).concat(w):"".concat(a))};function s(t,e){return"string"==typeof t?t:"number"==typeof t?"".concat(t).concat(e):""}var c,u=function(t,e,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"center",r={};return i?r={}:"center"===o?(r.c=1,r.e=1):r.others="!header",a(t,e,i?0:n,r)},l=function(t){return/\.gif$/.test(t)},d=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o={url:"",width:0,height:0,gifTop:!1};if(!t)return o;var r=e/n,a=r<1/3?"top":"center",s=104,c=104,d=180,f=180,p=240,h=240,m=320,g=320;switch(i){case 0:switch(!0){case e<=360:switch(!0){case r>=1:o.width=d,o.height=Math.min(o.width/r,f);break;case r<1&&r>=.75:o.width=d,o.height=Math.min(o.width/r,h);break;case r<.75:o.height=p,o.width=Math.min(o.height*r,d)}break;case e>360&&e<=960:switch(!0){case r>=1:o.width=p,o.height=Math.min(o.width/r,h);break;case r<1&&r>=.75:o.width=p,o.height=Math.min(o.width/r,g);break;case r<.75:o.width=p,o.height=g,o.gifTop=l(t)}break;case e>960:switch(!0){case r>=1:o.width=m,o.height=Math.min(o.width/r,g);break;case r<1&&r>=.75:o.width=p,o.height=Math.min(o.width/r,g);break;case r<.75:o.width=p,o.height=g,o.gifTop=l(t)}}break;case 1:o.width=s,o.height=c}return o.width=Math.ceil(o.width),o.height=Math.ceil(o.height),o.url=u(t,o.width,o.height,o.gifTop,a),o},f=n(9),p=new(n.n(f).a)({}),h=(n(10),n(29),n(11)),m=n.n(h),g=(n(40),n(22)),v=n(5);function b(t,e,n,i,o,r,a){try{var s=t[r](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}var y=function(){var t,e=(t=m.a.mark(function t(e){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e||!c){t.next=2;break}return t.abrupt("return",c);case 2:return t.next=4,Object(g.a)({method:"get",url:"".concat(v.a.API_MAIN,"/x/web-interface/nav")}).then(function(t){c=t.data},function(t){c=t.data});case 4:return t.abrupt("return",c);case 5:case"end":return t.stop()}},t)}),function(){var e=this,n=arguments;return new Promise(function(i,o){var r=t.apply(e,n);function a(t){b(r,i,o,a,s,"next",t)}function s(t){b(r,i,o,a,s,"throw",t)}a(void 0)})});return function(t){return e.apply(this,arguments)}}();function _(t,e,n,i,o,r,a){try{var s=t[r](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}var w=function(){var t,e=(t=m.a.mark(function t(){var e;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y();case 2:return e=t.sent,t.abrupt("return",e.isLogin);case 4:case"end":return t.stop()}},t)}),function(){var e=this,n=arguments;return new Promise(function(i,o){var r=t.apply(e,n);function a(t){_(r,i,o,a,s,"next",t)}function s(t){_(r,i,o,a,s,"throw",t)}a(void 0)})});return function(){return e.apply(this,arguments)}}();var C=Object(o.d)(),x="IE 9"===C||"IE Legacy"===C,I=(n(56),n(47),n(18),n(319),n(34),[{unit:"亿",val:1e8},{unit:"万",val:1e4}]),k={autoParse:function(t){return function(t,e){if(!Array.isArray(t))return console.warn("[NumberFormat] 无法获取格式化列表.");var n;return t.some(function(t){if(e>=t.val)return n=O(t.val,{fixing:1,unit:t.unit})(e),!0}),n||"".concat(e)}(I,t)},create:O},S={fixing:1,unit:"",base:null};function O(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,e=arguments.length>1?arguments[1]:void 0;return function(n){var i=parseInt(n,10);if(t=parseInt(t,10),isNaN(i)||isNaN(t))return"undefined"!=typeof console&&console.warn("[NumberFormat] 创建格式化函数时 threshold 与 传入数字必须为数字类型."),n;var o=Object.assign({},S,e);return i<t?i:Number((i/(o.base||t)).toFixed(o.fixing))+"".concat(o.unit)}}var P=n(70),T=n.n(P);function E(t,e,n,i,o,r,a){try{var s=t[r](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}var j=function(t){if(!window.biliQuickLogin)throw new Error("快速登录脚本未正确载入.");window.biliQuickLogin(function(){"function"==typeof t?t():window.location.reload()})},L=function(){var t,e=(t=m.a.mark(function t(e){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"!=typeof window){t.next=2;break}return t.abrupt("return",!1);case 2:return t.next=4,w();case 4:if(t.sent){t.next=9;break}return setTimeout(function(){window.biliQuickLogin?j(e):T()("https://static.hdslb.com/account/bili_quick_login.js").then(function(){j(e)}).catch(function(){j(e)})},1),t.abrupt("return",!1);case 9:return t.abrupt("return",!0);case 10:case"end":return t.stop()}},t)}),function(){var e=this,n=arguments;return new Promise(function(i,o){var r=t.apply(e,n);function a(t){E(r,i,o,a,s,"next",t)}function s(t){E(r,i,o,a,s,"throw",t)}a(void 0)})});return function(t){return e.apply(this,arguments)}}(),A={angry:[",,Ծ‸Ծ,,","(╯‵□′)╯︵┻━┻"],happy:["=‿=✧","●ω●","(/ ▽ \\)","(=・ω・=)","(●'◡'●)ﾉ♥","<(▰˘◡˘▰)>","(⁄ ⁄•⁄ω⁄•⁄ ⁄)","(ง,,• ᴗ •,,)ง ✧",">ㅂ<ﾉ ☆"],shock:["Σ( ° △ °|||)︴","┌( ಠ_ಠ)┘","(ﾟДﾟ≡ﾟдﾟ)!?","∑(っ °Д °;)っ"],sad:["＞︿＜","＞△＜","●︿●","(´；ω；`)"],helpless:["◐▽◑","ʅ（´◔౪◔）ʃ","_(:3 」∠)_","_(┐「ε:)_","(°▽°)ﾉ","←◡←","_(•̀ᴗ•́ 」∠ ❀)_","_φ(･ω･` )"]},D={};for(var M in A)!function(t){D[t]=function(){return N(t)}}(M);var N=function(t){return A[t][Math.floor(Math.random()*A[t].length)]},R=D;n(15),n(19),n(20),n(14),n(17),n(16);function B(t){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var U=function(){return Object(g.a)({method:"get",url:"//api.vc.bilibili.com/dynamic_mix/v1/dynamic_mix/bvid_onoff",cache_key:"bpShowBvConfig",ttl:4e3,localCache:!0,throttleInterval:4e3,timeout:5e3}).then(function(t){var e=!0===t.data.show_bv||"true"===t.data.show_bv;F()!==e&&("object"===("undefined"==typeof window?"undefined":B(window))&&(window.__BILI_CONFIG__||(window.__BILI_CONFIG__={show_bv:e}),window.__BILI_CONFIG__.show_bv=e,localStorage.setItem("bili_config_show_bv",e)),p.$emit("ShowBvConfigUpdated"))})},H=function(){var t=!1;return"object"!==("undefined"==typeof window?"undefined":B(window))?t:(window.__BILI_CONFIG__&&void 0!==window.__BILI_CONFIG__.show_bv?(t=window.__BILI_CONFIG__.show_bv,localStorage.setItem("bili_config_show_bv",t)):t="true"===localStorage.getItem("bili_config_show_bv"),t)},$=!0,F=function(){return"undefined"!=typeof window&&($?($=!1,t=H(),U()):t=H(),t);var t},V=function(t,e){return F()&&e?"//www.bilibili.com/video/".concat(e):"//www.bilibili.com/video/av".concat(t)};n.d(e,"k",function(){return i}),n.d(e,"a",function(){return a}),n.d(e,"b",function(){return d}),n.d(e,"c",function(){return p}),n.d(e,"d",function(){return y}),n.d(e,"g",function(){return x}),n.d(e,"h",function(){return k}),n.d(e,"i",function(){return L}),n.d(e,"j",function(){return R}),n.d(e,"e",function(){return F}),n.d(e,"f",function(){return V})},,,,,,,,,,,,,,function(t,e,n){"use strict";n(10),n(29);var i=n(60),o=n(216),r=n.n(o).a.create({timeout:"undefined"==typeof window?1e3:0});n(15),n(19),n(20),n(13),n(14),n(17),n(16);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var c=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"对不起，服务器开小差了~ (ಥ﹏ಥ)",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"error",c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-8888,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};if(s(this,t),"object"===a(o)){var l="对不起，服务器开小差了~ (ಥ﹏ಥ)";o.response?l="".concat(o.response.statusText," ").concat(o.response.status):"ECONNABORTED"===o.code&&(l="接口超时，稍后再试试吧~ (ಥ﹏ಥ)"),this.msg=l}else this.msg=o;this.type=r,this.code=c,this.data=u,this.url=n,this.payload=i,this.cost=e},u=n(6),l=Object(u.d)(),d="IE 9"===l||"IE Legacy"===l,f=d||"IE 10"===l||"IE 11"===l;n(12),n(36),n(21);var p={};n(27);var h={},m=function(){var t=Math.random();return h[t]=Date.now(),t},g=function(t){if(!t)return 0;if(h[t]){var e=Date.now()-h[t];return delete h[t],e}return 0};n(49),n(31);var v=function(t,e){var n=new RegExp("[?&]".concat(e,"=([^&#]+)"));return(t.match(n)||[])[1]||""},b=(n(24),n(34),n(5)),y=n(66),_=n.n(y);function w(t){if(!t)return t;var e=t;if(!("undefined"!=typeof FormData&&e instanceof FormData)){var n={};if("undefined"!=typeof window){var i=v(window.location.href,"lang");if(i){var o="iphone";(/Android/i.test(navigator.userAgent)||/Linux/i.test(navigator.userAgent))&&(o="android"),n.lang=i,n.mobi_app="".concat(o,"_i")}}t=e=Object.assign(n,e),f&&(t._=(new Date).getTime())}return t}n(56);var C=function(t){return t.replace(/("\w*":)\s*(\d{16}\d*)/g,'$1"$2"').replace(/(\\"\w*\\":)\s*(\d{16}\d*)/g,'$1\\"$2\\"').replace(/("\w*":)\s*(\[\s*(\d{16}\d*)\s*(,\s*(\d{16}\d*)\s*)*])/g,function(t,e,n){return"".concat(e).concat(n.trim().replace(/\[\s*/,'["').replace(/\s*]\s*/,'"]').replace(/\s*,\s*/g,'","'))}).replace(/(\\"\w*\\":)\s*(\[\s*(\d{16}\d*)\s*(,\s*(\d{16}\d*)\s*)*])/g,function(t,e,n){return"".concat(e).concat(n.trim().replace(/\[\s*/,'[\\"').replace(/\s*]/,'\\"]').replace(/\s*,\s*/g,'\\",\\"'))})};function x(t,e){if("string"==typeof t){var n=C(t);if(e)try{t=JSON.parse(n)}catch(t){}else t=n}return t}var I=function(t){return x(t,!0)},k=n(217),S=n.n(k);function O(t,e,n,i,o,r){var a=r?t:t.data;return new Promise(function(t,r){var s,u,l=function(){return 0===a[s]};e.indexOf(b.a.SPACE)>=0?(s="status",u="result",l=function(){return!0===a[s]}):e.indexOf(b.a.BANGUMI)>=0?(s="code",u="result"):e.indexOf(b.a.PASSPORT)>=0?(s="code",u="access_info"):(s="code",u="data"),void 0===a||void 0===a[s]?r(new c(o,e,n)):l()?t(new c(o,e,n,"请求成功","success",0,i?a:a[u])):r(new c(o,e,n,a.message||a.msg||"电波无法到达~ ".concat(a.message||a.msg||a.code),"caution",a[s],a[u]))})}n(23),n(143);function P(t,e,n){return(P=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&T(o,n.prototype),o}).apply(null,arguments)}function T(t,e){return(T=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function E(t,e,n){for(var i=arguments.length,o=new Array(i>3?i-3:0),r=3;r<i;r++)o[r-3]=arguments[r];return Promise.reject(P(c,[t,e,n].concat(o)))}n(28),n(48),n(30);function j(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var L=36e4,A=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.store={};var e={},n={};if("undefined"!=typeof window&&window.localStorage)try{e=JSON.parse(window.localStorage.getItem("bpapi_cache"))||e}catch(t){}var i=(new Date).getTime();Object.keys(e).forEach(function(t){var o=e[t];o&&i-o.ts<o.ttl&&i-o.ts<L&&(n[t]=o)}),n.uniqueKey=e.uniqueKey,this.store=n,this.setLocalCache()}var e,n,i;return e=t,(n=[{key:"set",value:function(t,e,n,i,o){var r=this;return(!o||this.store.uniqueKey!==o||"0"===o)&&n>0&&(this.clearCache(),this.store={}),o&&(this.uniqueKey=o,this.store.uniqueKey=o),new Promise(function(a,s){try{var c={};c.response=e,c.ttl=n>0?n:0,c.ts=(new Date).getTime(),r.store[t]=c,i&&n>0&&o&&"0"!==o&&r.setLocalCache(),a({status:"success"})}catch(t){s({status:"failed",data:t})}})}},{key:"get",value:function(t,e,n){var i=this;return(!n||this.store.uniqueKey!==n||"0"===n)&&e>0&&(this.clearCache(),this.store={}),n&&(this.uniqueKey=n,this.store.uniqueKey=n),new Promise(function(n,o){try{var r=i.store[t],a=(new Date).getTime();r&&a-r.ts<(e>0?e:0)&&a-r.ts<L?n({status:"success",data:r.response}):o({status:"failed",data:r})}catch(t){o({status:"failed",data:t})}})}},{key:"clearCache",value:function(){"undefined"!=typeof window&&window.localStorage&&window.localStorage.removeItem("bpapi_cache")}},{key:"setLocalCache",value:function(){this.uniqueKey&&(this.store.uniqueKey=this.uniqueKey),"undefined"!=typeof window&&window.localStorage&&this.uniqueKey&&window.localStorage.setItem("bpapi_cache",JSON.stringify(this.store))}}])&&j(e.prototype,n),i&&j(e,i),t}(),D=function(){return new A}(),M=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("undefined"!=typeof FormData&&t instanceof FormData){for(var n in e)e.hasOwnProperty(n)&&(FormData.prototype.set?t.set(n,e[n]):t.append(n,e[n]));return t}return Object.assign(t,e)},N=function(t){return new Promise(function(e){t.addPlatInfo?i.inBiliApp?i.biliBridge.callNative({method:"global.getContainerInfo",callback:function(n){t.data=M(t.data,{build:n.build,mobi_app:"h5_".concat(n.mobi_app)}),e(t)}}):(t.data=M(t.data,{build:0,mobi_app:"web"}),e(t)):e(t)})},R=new S.a({transformResponse:function(t){return x(t,!1)},oldAppUseAxios:!0}),B=function(t){if("undefined"!=typeof FormData&&t.data instanceof FormData)return r(w(t));var e=Object.assign({},t);switch(delete e.data,delete e.url,t.method.toLowerCase()){case"get":return R.get(t.url,w(t.data),e);case"post":return R.post(t.url,w(t.data),e);default:return r(w(t))}};function U(t){var e=t.useBridgeProxy,n=m(),i=0,o=t.url+JSON.stringify(t.data||"");return D.get(o,t.ttl,String(t.cache_key||"")).then(function(o){return i=g(n),O(o.data,t.url,t.data,t.needOriginal,i,e)}).catch(function(){return N(t).then(function(t){return function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return function(){if(p[t]&&i>0)return p[t];setTimeout(function(){p[t]=null},i);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return p[t]=e.apply(n,r),p[t]}}(o,e?B:r,t.throttleInterval)(t)}).then(function(r){return D.set(o,r,t.ttl,t.localCache,String(t.cache_key||"")).then(function(){return i=g(n),O(r,t.url,t.data,t.needOriginal,i,e)})},function(){i=g(n);for(var e=arguments.length,o=new Array(e),r=0;r<e;r++)o[r]=arguments[r];return E.apply(void 0,[i,t.url,t.data].concat(o))})})}var H=n(218),$=n.n(H);n.d(e,"a",function(){return F}),n.d(e,"b",function(){return V}),i.inBiliApp&&(Object(i.initEnv)(),i.biliBridge.callNative({method:"global.import",data:{namespace:"net"}})),r.interceptors.request.use(function(t){if(!t)return t;var e=t.method,n=t.url,i=t.data;t.withCredentials=!0;var o=i||{},r="string"==typeof e&&"post"===e.toLowerCase();if(r){var a=u.a.getItem("bili_jct")||"";o[n.indexOf(b.a.API_VC)>=0||n.indexOf(b.a.API_LIVE)>=0?"csrf_token":"csrf"]=a}if(!("undefined"!=typeof FormData&&o instanceof FormData)){var s={};if("undefined"!=typeof window){var c=v(window.location.href,"lang");if(c){var l="iphone";(/Android/i.test(navigator.userAgent)||/Linux/i.test(navigator.userAgent))&&(l="android"),s.lang=c,s.mobi_app="".concat(l,"_i")}}o=Object.assign(s,o),r?t.data=Object(y.stringify)(o):(t.params=o,f&&(t.params._=(new Date).getTime()),delete t.data),"undefined"==typeof window&&/^\/\//.test(n)&&(t.url="http:".concat(n))}return t});var F=function(t){"undefined"==typeof window||window.Promise||console.warn("No window.Promise. @bplus-common/components.bpapi need a promise polyfill.");var e=(t.method||"get").toLowerCase(),n=d&&!function(t){if("undefined"==typeof window)return!1;var e=t.replace(/^(https?:)?(\/\/)?/,"").match(window.location.hostname);return e&&0===e.index}(t.url),i="jsonp"===e;return!i&&n?E(t.url,t.data,"少年啊，你的浏览器太老了辣","caution",-8889):(t.method=e,t.transformResponse=t.transformResponse||[I],i?function(t){var e=m("jsonp"),n=0,i=t.url,o=/^(http:|https:)?\/\/api\.(live)|(vc)/.test(i),r=t.data&&"[object Object]"===t.data.toString();t.jsonpCallback||!r||"type"in t.data||"jsonp"in t.data?t.jsonpCallback||r||(t.data={type:"jsonp",jsonp:"jsonp"}):(t.data.type="jsonp",t.data.jsonp="jsonp");var a=t.data||{},s={},c="zh_CN";if("undefined"!=typeof window&&(c=v(window.location.href,"lang"))){s.lang=c;var u="iphone";(/Android/i.test(navigator.userAgent)||/Linux/i.test(navigator.userAgent))&&(u="android"),"zh_CN"!==c&&(s.mobi_app="".concat(u,"_i"))}a=Object.assign(s,a);var l=t.data&&t.jsonpCallback||(o?"_cb":"callback"),d=_.a.stringify(a),f=d.length>0?"".concat(i,"?").concat(d):"".concat(i),p=i+JSON.stringify(t.data||"");return D.get(p,t.ttl,String(t.cache_key||"")).then(function(o){return n=g(e),O({data:o.data},i,t.data,t.needOriginal,n)}).catch(function(){return $()(f,{jsonpCallback:l}).then(function(o){return o.ok?o.json().then(function(o){return D.set(p,o,t.ttl,t.localCache,String(t.cache_key||"")).then(function(){return n=g(e),O({data:o},i,t.data,t.needOriginal,n)})},function(){n=g(e);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return E.apply(void 0,[n,t.url,t.data].concat(o))}):E(n=g(e),t.url,t.data)},function(){n=g(e);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return E.apply(void 0,[n,t.url,t.data].concat(o))})})}(t):U(t))},V={install:function(t){t.prototype.bpapi||(t.prototype.bpapi=F)}}},,,,function(t,e,n){"use strict";var i=n(193),o=(n(15),n(13),n(32),n(28),n(35),n(41),n(33),n(34),n(73),n(74),n(48),n(49),n(12),n(31),n(21),n(30),n(45));function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={},n=[];return(n=n.concat(t.free||[]).concat(t.vip||[])).forEach(function(t){t.emojis.forEach(function(t){e[t.name]=t.url.replace(/^http:\/\//,"//")})}),e}var a={"哼":"嫌弃","色":"喜欢","泪":"大哭","黑线":"无语","怒":"生气","哈哈":"大笑","吃惊":"惊讶","允悲":"捂脸","骷髅":"灵魂出窍","挖鼻":"抠鼻",good:"点赞"},s={"色":"喜欢","流泪":"大哭","发怒":"生气","骷髅":"灵魂出窍","傲慢":"傲娇","惊恐":"吓","强":"点赞","便便":"屎"};var c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=new RegExp(/\[([^([.*?\])]+)\]/g),n=window.bp_emoji_data_v3&&window.bp_emoji_data_v3.mapping?window.bp_emoji_data_v3.mapping:{};return t.replace(e,function(t){var e=t.slice(1,t.length-1);return e=n[e]||a[e]||s[e]||e,"[".concat(e,"]")})};function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d={};o.a.allEmojiDataNew.map(function(t){t.purl&&""!==t.purl&&t.emojis&&t.emojis.length&&t.emojis&&t.emojis.length>0&&t.emojis.forEach(function(t){d[t.name]=t.url})});var f=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};d=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(n,!0).forEach(function(e){l(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},d,{},r(window.bp_emoji_data_v3||{})),e=Object.assign({width:20,height:20},e),t=c(t);var n=new RegExp(/\[([^([.*?\])]+)\]/g);return t.replace(n,function(t){var n=t.slice(1,t.length-1);return d["[".concat(n,"]")]?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;return'<img src="'.concat(e.replace(/^http:\/\//,"//"),'" alt="').concat(t,'" style="margin: 0 1px;width: ').concat(n.width,"px; height: ").concat(n.height,'px;vertical-align:-4px; display: inline-block">')}("[".concat(n,"]"),d["[".concat(n,"]")],e):"[".concat(n,"]")})},p=n(194);n.d(e,"d",function(){return i.a}),n.d(e,"e",function(){return f}),n.d(e,"c",function(){return c}),n.d(e,"b",function(){return p.a}),n.d(e,"a",function(){return r})},,,,,,,,,,,function(t,e,n){"use strict";n(13),n(27),n(235);var i="[Bplus Message]",o={},r=null,a=null;function s(t,e,n,s,u){t!==a&&(r=null);var l=String((new Date).getTime());"boolean"==typeof n&&(n="info");var d=document.createDocumentFragment(),f=document.createElement("div");if("success"!==(n=n||"info")&&"caution"!==n&&"error"!==n&&"info"!==n)throw new Error("".concat(i," 在使用 Link Toast 时必须指定正确的类型: success || caution || error || info"));if(f.innerHTML='<span class="toast-text">'.concat(e,"</span>"),f.className="link-toast ".concat(n," ").concat(s?"fixed":""," ").concat(u?"mobile":""),!u){if(!t||!t.className&&!t.attributes)throw new Error("".concat(i," 传入 element 不是有效节点."));var p=t.getBoundingClientRect(),h=p.left,m=p.top,g=p.width,v=p.height,b=document.documentElement&&document.documentElement.scrollLeft||document.body.scrollLeft;f.style.left=h+g+b+"px";var y=document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop;f.style.top=m+v+y+"px"}setTimeout(function(){c(l,f)},u?2e3:4e3),f.addEventListener("click",function(){c(l,f)}),function t(e,n){if(!e||!o[e])return;var i=o[e];var r=i.top-50;n&&(r=0,c(e,i.instance));i.instance.style.transform="translateY("+r+"px)";i.top=i.top-50;t(i.lastHash,n)}(r,u),d.appendChild(f),document.body.appendChild(d);var _=document.body.offsetWidth,w=f.getBoundingClientRect().left,C=f.offsetWidth;_-C-w<0&&(f.style.left=_-C-10+b+"px"),o[l]={instance:f,lastHash:r,top:0},r=l,a=t}function c(t,e){e.className+=" out-fade",setTimeout(function(){e&&e.parentNode&&e.parentNode.removeChild(e),o[t]=null},350)}e.a=function(){return{install:function(t){t.prototype.linkMsg||(t.prototype.linkMsg=s)}}}},function(t,e,n){"use strict";n.d(e,"d",function(){return g}),n.d(e,"e",function(){return y}),n.d(e,"b",function(){return b}),n.d(e,"c",function(){return _}),n.d(e,"a",function(){return m});n(15),n(19),n(20),n(13),n(32),n(28),n(24),n(14),n(41),n(151),n(48),n(10),n(44),n(29),n(12),n(17),n(36),n(21),n(57),n(56),n(212),n(30),n(16);var i=n(5),o=n(26),r=n(6),a=n(8);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var c=function(t){return!(!t||"object"!==s(t)||"string"!=typeof t.data||"number"!=typeof t.length||"number"!=typeof t.location||"number"!=typeof t.type)},u="#00a1d6",l=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace('"',"&quot;")},d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n=t;return n=(n=e<0?n.replace(/^\s+(.+?)$/,"$1"):e>0?n.replace(/(.+?)\s+$/,"$1 "):t).replace(/\r/g,"").replace(/\s/g,"&nbsp")},f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.replace(/\n/g,"<br>")},p=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n="";return n=t.replace(/\n{2,}/g,"\n\n"),n=e<0?n.replace(/^\n+(.+?)$/,"$1"):e>0?n.replace(/(.+?)\n+$/,"$1"):t},h=0,m={TYPE_STRING:++h,TYPE_LOTTERY:++h,TYPE_VOTE:++h,TYPE_AT:++h,TYPE_COMMIC_REMARK:++h,TYPE_LINK_HTTP:++h,TYPE_LINK_AV:++h,TYPE_LINK_BV:++h,TYPE_LINK_CV:++h,TYPE_LINK_VC:++h,TYPE_TOPIC:++h,TYPE_LINK_SHOP:++h},g=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[];if("string"!=typeof t||""===t)return n;var i=e.ctrlJson,o=void 0===i?"":i,s=e.extendCtrlJson,u=void 0===s?"":s,l=e.display,d=void 0===l?{}:l,f=e.dynamicId,p=void 0===f?"":f,h=e.isRemark,g=void 0!==h&&h,v=e.isClip,b=void 0!==v&&v,y=Object(a.e)(),_=0;if(g){var w=t.replace(/\r\n/g,"\n").indexOf("\n"),C=t.slice(0,w),x=C.match(/(\[星])+(\[空星])*|(\[星])*(\[空星])+/g);x&&x[0]&&(n.push({type:m.TYPE_COMMIC_REMARK,text:x[0]}),_=w+1)}var I=Object(r.e)(u),k=o?Object(r.e)(o):[],S=I.ctrl||[],O={};[].concat(k,S).forEach(function(t){c(t)&&(O[t.location]||(O[t.location]=t))});var P=function(t){var e=!1,i=t.text.split("#");i.length>1?i.forEach(function(t,o){if(""===t)e&&n.push({type:m.TYPE_STRING,text:"#"}),e=!0;else if(e)if(function(t){var e=t.replace(/(^ +)|( +$)/g,"");return!/[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(e)&&/^[^\n\r#@↵]{1,32}$/.test(e)}(t)&&o+1!==i.length){var r=t.trim().replace(/\xa0/g," ");n.push({type:m.TYPE_TOPIC,text:"#".concat(t,"#"),id:r}),e=!1}else n.push({type:m.TYPE_STRING,text:"#".concat(t)});else n.push({type:m.TYPE_STRING,text:t}),e=!0}):n.push({type:m.TYPE_STRING,text:t.text})},T=function(t,e,i){return function(o){var r=!0,a=0;do{var s=t.exec(o.text);s?(s.index===a?n.push(e(s)):(i({type:m.TYPE_STRING,text:o.text.substring(a,s.index)}),n.push(e(s))),a=t.lastIndex):(i({type:m.TYPE_STRING,text:o.text.substring(a)}),r=!1)}while(r)}},E=T(/vc(\d+)/gi,function(t){return{type:m.TYPE_LINK_VC,text:t[0],id:t[1]}},P),j=T(/cv\d+/gi,function(t){return{type:m.TYPE_LINK_CV,text:t[0],id:"cv"+t[0].slice(2)}},E),L=T(/av\d+/gi,function(t){return{type:m.TYPE_LINK_AV,text:t[0],id:"av"+t[0].slice(2)}},j),A=T(/(bv1[\d\w]{9})/gi,function(t){return{type:m.TYPE_LINK_BV,text:t[0],id:t[0]}},L),D=T(/(((http:\/\/|https:\/\/)([a-zA-Z0-9_.-]+\.)*(bilibili|biligame)\.com(\.\.\.|(\/[\/.$*?~=#!%@&\-\w]*)?))|((http:\/\/|https:\/\/)([a-zA-Z0-9_.-]+\.)*(acg|b23)\.tv(\.\.\.|(\/[\/.$*?~=#!%@&\-\w]*)?))|((http:\/\/|https:\/\/)dl\.(hdslb)\.com(\.\.\.|(\/[\/.$*?~=#!%@&\-\w]*)?))|((http:\/\/|https:\/\/)sugs\.(suning)\.com(\.\.\.|(\/[\/.$*?~=#!%@&\-\w]*)?)))/g,function(t){var e=t.filter(function(t){return!!t});return b&&e.length>0&&/\.\.\.$/.test(e[0])?{type:m.TYPE_STRING,text:"..."}:{type:m.TYPE_LINK_HTTP,text:"网页链接",url:t[0]}},y?A:L);return Object.keys(O).sort(function(t,e){return parseInt(t)>parseInt(e)?1:-1}).forEach(function(e){var i=O[e],o=i.data,r=i.length,a=i.location,s=i.type,c=i.type_id,u=i.prefix_icon,l=I.vote||I.vote_cfg,f=d.highlight,h=0,g=function(e){a<_||(a+h>t.length?(a<t.length?(a>_&&D({type:m.TYPE_STRING,text:t.substring(_,a)}),n.push(e)):D({type:m.TYPE_STRING,text:t.substring(_,t.length)}),_=t.length):a===_?(n.push(e),_=a+h):a>_&&(D({type:m.TYPE_STRING,text:t.substring(_,a)}),n.push(e),_=a+h))};switch(s){case 1:h=r,g({type:m.TYPE_AT,text:t.substring(a,a+h),id:o,dynamicId:p});break;case 2:h=parseInt(o),g({type:m.TYPE_LOTTERY,text:t.substring(a,a+h),id:p,dynamicId:p});break;case 3:h=parseInt(o),l&&l.vote_id?g({type:m.TYPE_VOTE,text:t.substring(a,a+h),id:l.vote_id,dynamicId:p}):g({type:m.TYPE_STRING,text:t.substring(a,a+h)});break;case 4:if(h=parseInt(o),f&&Array.isArray(f.items)){for(var v={item_id:"",jump_url:"",source_type:void 0},b=0;b<f.items.length;b++)if(f.items[b].type_id===c){v=f.items[b];break}g({type:m.TYPE_LINK_SHOP,text:t.substring(a,a+h),id:v.item_id,dynamicId:p,url:v?v.jump_url:"",shopIcon:u,sourceType:v?v.source_type:0})}else g({type:m.TYPE_STRING,text:t.substring(a,a+h)})}}),_<t.length&&D({type:m.TYPE_STRING,text:t.substring(_,t.length)}),n},v=function(t,e,n,i,o,r){var a="";return t?(a="".concat(n,"&isWeb=1"),'<span click-href="'.concat(l(a),'" click-title="').concat(l(e),'" class="dynamic-link-hover-bg" style="cursor:pointer;color:').concat(i,';">').concat(r).concat(o,"</span>")):'<a href="'.concat(l(a=n),'" class="dynamic-link-hover-bg" style="color:').concat(i,';">').concat(r).concat(o,"</a>")},b=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,a="";if(n)return t.forEach(function(t){a+=t.text||t.url||t.id}),a;var s=e.isWeb,c=void 0===s||s,h=e.verticalAlign,g=void 0===h?"text-bottom":h,b=e.width,y=void 0===b?20:b,_=e.height,w=void 0===_?20:_,C=e.extendCtrlJson,x=void 0===C?"":C,I=e.cardType,k=void 0===I?"":I,S=e.cardId,O=void 0===S?"":S,P=e.display,T=void 0===P?{}:P,E=T.emoji_info&&T.emoji_info.emoji_details||[],j=[];E.forEach(function(t){j.push({id:t.id,name:t.text,url:t.url,type:t.type})});var L={free:[{emojis:j,pid:-1,pname:"当前卡片",type:1}],mapping:[],vip:[]},A=0,D=Object(r.e)(x).from;D&&(A=D.emoji_type);var M={};return T.topic_info&&T.topic_info.topic_details&&T.topic_info.topic_details&&T.topic_info.topic_details.length>0&&T.topic_info.topic_details.forEach(function(t){M[t.topic_name.trim()]=t.topic_link}),t.forEach(function(e,n){var r="",s="",h="",b="",_=0;0===n?_=-1:n===t.length-1&&(_=1);var C=e.text?d(f(p(l(e.text),_)),_):"";switch(e.type){case m.TYPE_STRING:r=Object(o.d)(C,{width:y,height:w,verticalAlign:g,emojiType:A},L);break;case m.TYPE_LOTTERY:b="抽奖详情",s="".concat(i.a.T,"/lottery/h5/index/#/result?business_id=").concat(e.dynamicId,"&business_type=1"),r=v(c,b,s,u,C,c?'<i class="bp-svg-icon lottery-btn" click-href="'.concat(l(h),'" click-title="').concat(l(b),'" style="position:relative;top:-2px;margin-left:2px;margin-right:2px;"></i>'):'<i class="bp-svg-icon lottery-btn" style="position:relative;top:-2px;margin-left:2px;margin-right:2px;"></i>');break;case m.TYPE_VOTE:b="投票",s="".concat(i.a.T,"/vote/h5/index/#/result?vote_id=").concat(e.id,"&dynamic_id=").concat(e.dynamicId),r=v(c,b,s,u,C,c?'<i class="bp-svg-icon vote-btn" click-href="'.concat(l(h),'" click-title="').concat(l(b),'" style="position:relative;top:-1px;margin-left:2px;margin-right:2px;"></i>'):'<i class="bp-svg-icon vote-btn" style="position:relative;top:-1px;margin-left:2px;margin-right:2px;"></i>');break;case m.TYPE_AT:c?(h="".concat(i.a.SPACE,"/").concat(e.id,"/dynamic"),r='<a href="'.concat(l(h),'" target="_blank" class="dynamic-link-hover-bg" style="cursor:pointer;color:').concat(u,';">').concat(C,"</a>")):(h="".concat(i.a.M,"/space/").concat(e.id),r='<span click-href="'.concat(l(h),'" spm-type="at" card-type="').concat(k,'" card-id="').concat(O,'" class="dynamic-link-hover-bg" style="color:').concat(u,';">').concat(C,"</span>"));break;case m.TYPE_COMMIC_REMARK:r=(e.text||"").replace(/\[星]/g,'<i title="[星]" class="bp-svg-icon star" style="position:relative;top:-4px;margin-right:6px;"></i>').replace(/\[空星]/g,'<i title="[空星]" class="bp-svg-icon star-empty" style="position:relative;top:-4px;margin-right:6px;"></i>'),r="".concat(r,"<br>");break;case m.TYPE_LINK_HTTP:r=c?'<a href="'.concat(e.url,'" target="_blank" class="dynamic-link-hover-bg" style="cursor:pointer;color:').concat(u,';"><i class="bp-svg-icon link" style="position:relative;top:-1px;margin-left:2px;"></i>网页链接</a>'):'<span click-href="'.concat(e.url,'" spm-type="link" card-type="').concat(k,'" card-id="').concat(O,'" click-target="_blank" class="dynamic-link-hover-bg" style="color:').concat(u,';"><i class="bp-svg-icon link" style="position:relative;top:-1px;margin-left:2px;margin-right:2px;"></i>网页链接</span>');break;case m.TYPE_LINK_AV:case m.TYPE_LINK_BV:r='<a href="'.concat(i.a.MAIN,"/video/").concat(e.id,'" target="_blank" class="dynamic-link-hover-bg" style="cursor:pointer;color:').concat(u,';">').concat(C,"</a>");break;case m.TYPE_LINK_CV:r='<a href="'.concat(i.a.MAIN,"/read/").concat(e.id,'" target="_blank" class="dynamic-link-hover-bg" style="cursor:pointer;color:').concat(u,';">').concat(C,"</a>");break;case m.TYPE_LINK_VC:r='<a href="'.concat(i.a.VC,"/video/").concat(e.id,'" target="_blank" class="dynamic-link-hover-bg" style="cursor:pointer;color:').concat(u,';">').concat(C,"</a>");break;case m.TYPE_TOPIC:var x=M[e.id.trim()]||"".concat(i.a.T,"/topic/name/").concat(encodeURIComponent(e.id),"/feed");r='<a href="'.concat(x,'" target="_blank" class="dynamic-link-hover-bg" style="cursor:pointer;color:').concat(u,';">').concat(C,"</a>");break;case m.TYPE_LINK_SHOP:var I='<i class="bp-svg-icon link" style="position:relative;top:-1px;margin-left:2px;margin-right:2px;"></i>';1===e.sourceType&&(I='<i class="bp-svg-icon taobao-link" style="position:relative;top:-2px;margin-left:3px;margin-right: 3px;font-size: 38px;"></i>'),r=c?'<a href="'.concat(e.url,'" shop-item-id="').concat(e.id,'" target="_blank" class="dynamic-link-hover-bg" style="cursor:pointer;color:').concat(u,';">').concat(I).concat(e.text,"</a>"):'<span click-href="'.concat(e.url,'" shop-item-id="').concat(e.id,'" spm-type="link" card-type="').concat(k,'" card-id="').concat(O,'" click-target="_blank" class="dynamic-link-hover-bg" style="color:').concat(u,';">').concat(I).concat(e.text,"</span>")}a+=r}),a},y=function(t,e){return new Promise(function(n){try{n(g(t,e))}catch(e){n([{type:m.TYPE_STRING,text:t}])}})},_=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n){n(b(t,e))})}},,,,function(t,e,n){"use strict";n(53),n(32),n(24),n(28),n(59),n(48),n(10),n(29),n(12),n(36),n(30);var i=n(9),o=n.n(i),r=[];n(27),n(31);function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var s=[],c=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.keys(e).forEach(function(t){n[t]=e[t]}),this.$id=e.$id?e.$id:"popup-".concat(Math.floor(1e4*Math.random()*Date.now()).toString(16)),this.$disabled=!1,this.$out=!1,this.type=e.type||"normal",this.lockWhenConfirm=e.lockWhenConfirm||!1,this.$keep=e.keep||!1}var e,n,i;return e=t,(n=[{key:"unlock",value:function(){this.$disabled=!1}},{key:"lock",value:function(){this.$disabled=!0}},{key:"close",value:function(){return this.removePopup()}},{key:"keep",value:function(){this.$keep=!0}},{key:"cancelKeep",value:function(){this.$keep=!1}},{key:"restore",value:function(){this.$out=!1}},{key:"removePopup",value:function(){var t=this;return new Promise(function(e){t.$out=!0,setTimeout(function(){if(r.splice(t.$index,1),t.$keep){var n=s.filter(function(e){return e.$id===t.$id});n.length?s[s.indexOf(n[0])]=t:s.push(t)}else delete s[s.indexOf(t)];var i;(i=r).forEach(function(t,e){i[e].$index=e}),o.a.nextTick(function(){e(),window.navigator.userAgent.match(/Maxthon\/4.[0-4]/)&&(window.document.body.style.backgroundColor="#fefefe",setTimeout(function(){window.document.body.style.backgroundColor="#fff"},1))})},200)})}}])&&a(e.prototype,n),i&&a(e,i),t}();function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var l=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.param=e;var n=this.init();this.popup=n}var e,n,i;return e=t,(n=[{key:"onInited",value:function(t){return this.popup.onInitedCallback=t,this}},{key:"onConfirm",value:function(t){return this.popup.onConfirmCallback=t,this}},{key:"onCancel",value:function(t){return this.popup.onCancelCallback=t,this}},{key:"init",value:function(){var t=new c(this.param),e=t.$id;if(!r.filter(function(t){return t.$id===e}).length){if(s.length)for(var n=0,i=s.length;n<i;n++){var o=s[n];if(o){o.restore(),r.push(o);var a=r.indexOf(o);r[a].$index=a}}var u=r.push(t)-1;return r[u].$index=u,t.onInitedCallback=null,t.onInitedCallbackExeced=!1,t}console.caution('检测到 $id 相同 livePopup "'.concat(this.param.$id,'}", 请解决冲突.'))}}])&&u(e.prototype,n),i&&u(e,i),t}(),d=(n(15),n(19),n(20),n(14),n(33),n(17),n(16),n(63)),f=n(135);function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var h=[],m={data:function(){return{popups:r}},computed:{currentPopup:function(){var t=this.popups[this.popups.length-1];if(!t)return{};var e=t.component;if("object"===p(e)){if(void 0===t.content&&void 0===t.html||("server"!==Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_ENV&&window.console&&console.warn("[BpPopup] 当使用 Component 方式构建弹窗时，传入的 html 与 content 属性无效."),t.html=null,t.content=null),"object"===p(e._Ctor)){var n=e.name;if("string"!=typeof n)throw new Error("[Error] 在使用 Component 创建弹窗时必须指定 name.");o.a.component(n,e),h.push(n),t.component.name=n}else{if("string"!=typeof e.name)throw new Error("[Error] 在使用 Component 创建弹窗时必须指定 name.");o.a.component(e.name,e),h.push(e.name)}t.$usingComponent=!0}return t}},components:{LinkBtn:d.a,Shell:f.a},methods:{init:function(t){this.$nextTick(function(){t.onInitedCallback&&!t.onInitedCallbackExeced&&setTimeout(function(){t.onInitedCallback(t),t.onInitedCallbackExeced=!0},10)})},confirm:function(t,e){var n=this.currentPopup;n.$disabled||(n.lockWhenConfirm&&n.lock(),n.confirmBtn||(n.confirmBtn=e.confirmBtn),n.cancelBtn||(n.cancelBtn=e.cancelBtn),n.closeBtn||(n.closeBtn=e.closeBtn),n.onConfirmCallback?n.onConfirmCallback(n):n.removePopup&&n.removePopup())},cancel:function(t,e){var n=this.currentPopup;n.$disabled||(n.confirmBtn||(n.confirmBtn=e.confirmBtn),n.cancelBtn||(n.cancelBtn=e.cancelBtn),n.closeBtn||(n.closeBtn=e.closeBtn),n.onCancelCallback&&n.onCancelCallback(n),n.removePopup&&n.removePopup())},close:function(t){t.removePopup&&t.removePopup()}},provide:function(){var t=this,e={};return Object.defineProperty(e,"popup",{get:function(){return t.currentPopup}}),e}},g=(n(234),n(2)),v=Object(g.a)(m,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"fade-out"}},[t.popups.length?n("div",{staticClass:"bp-popup-ctnr dp-table w-100 h-100 p-fixed p-zero f-family",attrs:{role:"alertdialog"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.currentPopup.hideMask,expression:"!currentPopup.hideMask"}],staticClass:"body-merge w-100 h-100 p-absolute p-zero"}),n("div",{staticClass:"dp-table-cell bp-v-middle"},[n("shell",{attrs:{show:!t.currentPopup.$out,width:t.currentPopup.width,title:t.currentPopup.title,"title-center":t.currentPopup.titleCenter,button:t.currentPopup.button,disabled:t.currentPopup.$disabled,"on-confirm":t.confirm,"on-cancel":t.cancel,init:t.init(t.currentPopup)}},[t.currentPopup.$usingComponent?[n(t.currentPopup.component.name,{tag:"component"})]:["string"==typeof t.currentPopup.html?n("div",{staticClass:"popup-content-ctnr",attrs:{id:t.currentPopup.$id},domProps:{innerHTML:t._s(t.currentPopup.html)}}):n("div",{staticClass:"popup-content-ctnr",staticStyle:{"font-size":"13px"},attrs:{id:t.currentPopup.$id},domProps:{textContent:t._s(t.currentPopup.content)}})]],2)],1)]):t._e()])},[],!1,null,"b38bf146",null).exports,b=!1,y={install:function(t){if(!b){if(t.prototype.bpPopup=function(t){return new l(t,r)},"undefined"!=typeof window){var e=document.createElement("div");document.body.appendChild(e),t.nextTick(function(){new t({template:'<div class="bp-popup-ctnr"><bp-popup></bp-popup></div>',components:{BpPopup:v}}).$mount(e)})}b=!0}}};e.a=y},function(t,e,n){"use strict";n(27),n(23),n(10),n(143),n(31);var i=n(9),o=n.n(i),r=n(37),a=(n(13),n(18),n(6)),s=n(8),c=n(5),u=n(22),l=(n(12),n(21),{"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" ","&quot;":'"',"&copy;":"","&ldquo;":"“","&rdquo;":"”","&lsquo;":"‘","&rsquo;":"’","&hellip;":"…","&mdash;":"—"}),d=n(4),f={props:{mid:{type:Number,required:!0}},data:function(){return{loadingFail:!1,isLoading:!1,isLoaded:!1,isfollowed:!1,followIn:!1,cardRichInfo:{card:{mid:"",sex:"",face:"",sign:"",attention:0,fans:0}},following:!1,HOST:c.a}},computed:{followWord:function(){return this.followIn?"取消关注":"已关注"},encodeSign:function(){return function(t){return"string"!=typeof(t=void 0!==t?t:this.toString())?t:t.replace(/&\w+;|&#(\d+);/g,function(t,e){var n=l[t];return void 0===n&&(n=isNaN(e)?t:String.fromCharCode(160===e?32:e)),n})}(this.cardRichInfo.card.sign)},verifyType:function(){return this.cardRichInfo.card.official_verify.type},isBig:function(){return this.cardRichInfo.card.vip.vipType>0&&1===this.cardRichInfo.card.vip.vipStatus}},methods:{numberFormat:s.h.autoParse,followCut:function(){this.followIn=!this.followIn},getCardRichInfo:function(){var t=this;this.isLoading=!0;var e={url:c.a.API_MAIN+"/x/web-interface/card",method:"get",data:{mid:this.mid,photo:!0}};Object(u.a)(e).then(function(e){t.cardRichInfo=e.data,t.isLoading=!1,t.isLoaded=!0,t.$emit("update-position")},function(){t.loadingFail=!0})},toBfsImg:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{c:1};return Object(a.g)(Object(s.a)(t,e,n,i))},follow:function(){var t=this,e={url:c.a.API_MAIN+"/x/relation/modify?cross_domain=true",method:"post",data:{fid:this.mid,act:1,re_src:15}};Object(u.a)(e).then(function(){t.linkMsg(t.$refs.follow,"关注成功","success"),t.cardRichInfo.following=!0,d.t.insertToMyAttentionList(t.mid)},function(e){-665===e.code?t.linkMsg(t.$refs.follow,"已达到关注上限","error"):t.linkMsg(t.$refs.follow,e.msg,e.type)})},unFollow:function(){var t=this,e={url:c.a.API_MAIN+"/x/relation/modify?cross_domain=true",method:"post",data:{fid:this.mid,act:2,re_src:15}};Object(u.a)(e).then(function(){t.linkMsg(t.$refs.follow,"取消关注成功！","success"),t.isfollowed=!0,t.cardRichInfo.following=!1,d.t.deleteFromMyAttentionList(t.mid)},function(e){t.linkMsg(t.$refs.follow,e.msg,e.type)})}},mounted:function(){this.getCardRichInfo()}},p=(n(238),n(2)),h=Object(p.a)(f,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"userinfo-content"},[t.loadingFail?n("div",{staticClass:"loadfail"},[t._v("加载失败")]):[t.isLoading?n("div",{staticClass:"loading"},[t._v("正在加载中...请稍后。")]):t._e(),t.isLoaded?[n("div",{staticClass:"bg",style:{backgroundImage:"url("+t.toBfsImg(t.cardRichInfo.space.s_img,null,120,{autoDpr:!1})+")"}}),n("a",{staticClass:"face",attrs:{href:t.HOST.SPACE+"/"+t.cardRichInfo.card.mid+"/dynamic",target:"_blank"}},[n("img",{attrs:{src:t.toBfsImg(t.cardRichInfo.card.face,50,50)}}),t.verifyType>-1||t.isBig?n("div",{staticClass:"verify-box",class:"type-"+t.verifyType+" type-"+(t.isBig?"big":"")}):t._e()]),n("div",{staticClass:"info"},[n("p",{staticClass:"user"},[n("a",{staticClass:"name",class:{vip:t.cardRichInfo.card.vip.vipStatus},attrs:{target:"_blank",href:t.HOST.SPACE+"/"+t.cardRichInfo.card.mid+"/dynamic"}},[t._v(t._s(t.cardRichInfo.card.name))]),"男"===t.cardRichInfo.card.sex||"女"===t.cardRichInfo.card.sex?n("i",{staticClass:"sex",class:{men:"男"===t.cardRichInfo.card.sex,women:"女"===t.cardRichInfo.card.sex}}):t._e(),n("a",{attrs:{target:"_blank",href:t.HOST.MAIN+"/html/help.html#k_5"}},[n("i",{staticClass:"level",class:"lv"+t.cardRichInfo.card.level_info.current_level})])]),n("p",{staticClass:"social"},[n("a",{attrs:{href:t.HOST.SPACE+"/"+t.cardRichInfo.card.mid+"/fans/follow",target:"_blank"}},[t._v("关注："),n("span",{staticClass:"like"},[t._v(t._s(t.cardRichInfo.card.attention))])]),n("a",{attrs:{href:t.HOST.SPACE+"/"+t.cardRichInfo.card.mid+"/fans/fans",target:"_blank"}},[t._v("粉丝："),n("span",{staticClass:"fans"},[t._v(t._s(t.numberFormat(t.cardRichInfo.card.fans)))])])]),t.cardRichInfo.card.sign?n("p",{staticClass:"sign"},[t._v(t._s(t.encodeSign))]):t._e()]),n("div",{staticClass:"btn-box"},[n("a",{ref:"follow",staticClass:"like",class:{liked:t.cardRichInfo.following}},[t.cardRichInfo.following?[n("span",{on:{click:t.unFollow,mouseenter:t.followCut,mouseleave:t.followCut}},[t._v(t._s(t.followWord))])]:[n("span",{on:{click:t.follow}},[t._v("+关注")])]],2),n("a",{staticClass:"message",attrs:{href:t.HOST.MESSAGE+"/#whisper/mid"+t.cardRichInfo.card.mid,target:"_blank"}},[t._v("发消息")])])]:t._e()]],2)},[],!1,null,"1b25913d",null).exports,m={props:{mid:[Number,String],attachDomInstance:null,eventDom:null,top:Number,left:Number},data:function(){return{styleTop:0,styleLeft:0,parentStyle:{},targetStyle:{},cardStyle:{}}},computed:{positionStyle:function(){return"top: ".concat(this.styleTop,"px; left: ").concat(this.styleLeft,"px;")}},components:{UserinfoContent:h},mounted:function(){this.updatePosition(!0)},methods:{onmouseenter:function(t){this.$emit("mouseenter",t)},onmouseleave:function(t){this.$emit("mouseleave",t)},updatePosition:function(t){var e=this;this.$nextTick(function(){e.targetStyle=e.eventDom.getBoundingClientRect(),e.cardStyle=e.$refs.card.getBoundingClientRect(),t&&(e.parentStyle=e.attachDomInstance.$el.getBoundingClientRect()),e.styleLeft=e.targetStyle.left-e.parentStyle.left+e.targetStyle.width/2,e.targetStyle.top-40<300?e.styleTop=e.targetStyle.top-e.parentStyle.top+e.targetStyle.height:e.styleTop=e.targetStyle.top-e.parentStyle.top-e.cardStyle.height,void 0!==e.top&&(e.styleTop=e.top),void 0!==e.left&&(e.styleLeft=e.left)})}}},g=(n(239),Object(p.a)(m,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{ref:"card",staticClass:"userinfo-wrapper",style:this.positionStyle,on:{mouseenter:this.onmouseenter,mouseleave:this.onmouseleave}},[e("userinfo-content",{attrs:{mid:Number(this.mid)},on:{"update-position":this.updatePosition}})],1)},[],!1,null,"5e6ddf5c",null).exports);function v(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var b=function(){function t(e,n,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!(n instanceof HTMLElement))return console.error("attachDom is not a HTMLElement");this.eventDom=i;var r=o||{};(i instanceof HTMLElement||(r=i||r,this.eventDom=n),"true"!==this.eventDom.getAttribute("data-userinfo-popup-inited"))&&(this.delay="delay"in r?r.delay:400,this.options=r,this.mid=e,this.timer=null,this.vueInstance=null,this.mountedDom=document.createElement("div"),this.mountedDom.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault()},!0),this.attachDom=n,"relative"!==window.getComputedStyle(this.attachDom).position&&this.attachDom.setAttribute("style","position: relative;"),this.init())}var e,n,i;return e=t,(n=[{key:"init",value:function(){this.vueInstance=new o.a({template:'<userinfo-wrapper v-if="show" @mouseenter="onmouseenter" @mouseleave="onmouseleave" :mid="mid" :attach-dom-instance="attachDomInstance" :event-dom="eventDom" :top="top" :left="left"></userinfo-wrapper>',components:{UserinfoWrapper:g},data:function(){return{show:!1,mid:0,attachDomInstance:null,eventDom:null,top:void 0,left:void 0}},methods:{onmouseenter:function(t){this.$emit("mouseenter",t)},onmouseleave:function(t){this.$emit("mouseleave",t)}}}),this.vueInstance.$mount(this.mountedDom),this.mountedDom=this.vueInstance.$el,this.vueInstance.mid=this.mid,this.vueInstance.attachDomInstance=this.vueInstance,this.vueInstance.eventDom=this.eventDom,this.vueInstance.top=this.options.top,this.vueInstance.left=this.options.left,this.vueInstance.$on("mouseenter",this.mouseenter.bind(this)),this.vueInstance.$on("mouseleave",this.mouseleave.bind(this)),this.eventDom.addEventListener("mouseenter",this.mouseenter.bind(this),!1),this.eventDom.addEventListener("mouseleave",this.mouseleave.bind(this),!1);var t=this;this.destroy=function(){t.vueInstance.$destroy(),t.eventDom.removeEventListener("mouseenter",t.mouseenter),t.eventDom.removeEventListener("mouseleave",t.mouseleave)},this.eventDom.setAttribute("data-userinfo-popup-inited","true")}},{key:"mouseenter",value:function(){var t=this;this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout(function(){t.show()},this.delay)}},{key:"mouseleave",value:function(){var t=this;this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout(function(){t.hide()},200)}},{key:"show",value:function(){this.append(),this.vueInstance.show=!0}},{key:"hide",value:function(){this.vueInstance.show=!1}},{key:"append",value:function(){this.appended||(this.attachDom.appendChild(this.mountedDom),this.appended=!0)}}])&&v(e.prototype,n),i&&v(e,i),t}();function y(t,e,n){return(y=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&_(o,n.prototype),o}).apply(null,arguments)}function _(t,e){return(_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function w(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return y(b,e)}o.a.use(Object(r.a)()),n.d(e,"a",function(){return w})},,function(t,e,n){"use strict";n.d(e,"b",function(){return o}),n.d(e,"a",function(){return r});n(28),n(30);var i={kaomojis:[],dynamicEmojis:[],mainEmojis:[]};function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];i.mainEmojis=window.bp_emoji_data_v3?window.bp_emoji_data_v3.vip:[],i.dynamicEmojis=window.bp_emoji_data_v3?window.bp_emoji_data_v3.free:[];var e=[];return t.forEach(function(t){i[t].forEach(function(t){e.push(t)})}),e}var r={allEmojiDataNew:[],allEmojiDataOld:[]}},,,,,function(t,e,n){"use strict";n(240)},function(t,e,n){"use strict";var i=n(135).a;e.a=i},,,function(t,e){t.exports=function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=119)}([function(t,e,n){(function(e){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||Function("return this")()}).call(this,n(71))},function(t,e,n){var i=n(0),o=n(14),r=n(35),a=n(54),s=i.Symbol,c=o("wks");t.exports=function(t){return c[t]||(c[t]=a&&s[t]||(a?s:r)("Symbol."+t))}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var i=n(4);t.exports=function(t){if(!i(t))throw TypeError(String(t)+" is not an object");return t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var i=n(8),o=n(9),r=n(13);t.exports=i?function(t,e,n){return o.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var i=n(0),o=n(21).f,r=n(6),a=n(10),s=n(34),c=n(46),u=n(50);t.exports=function(t,e){var n,l,d,f,p,h=t.target,m=t.global,g=t.stat;if(n=m?i:g?i[h]||s(h,{}):(i[h]||{}).prototype)for(l in e){if(f=e[l],d=t.noTargetGet?(p=o(n,l))&&p.value:n[l],!u(m?l:h+(g?".":"#")+l,t.forced)&&void 0!==d){if(typeof f==typeof d)continue;c(f,d)}(t.sham||d&&d.sham)&&r(f,"sham",!0),a(n,l,f,t)}}},function(t,e,n){var i=n(2);t.exports=!i(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(8),o=n(44),r=n(3),a=n(23),s=Object.defineProperty;e.f=i?s:function(t,e,n){if(r(t),e=a(e,!0),r(n),o)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var i=n(0),o=n(14),r=n(6),a=n(5),s=n(34),c=n(45),u=n(16),l=u.get,d=u.enforce,f=String(c).split("toString");o("inspectSource",function(t){return c.call(t)}),(t.exports=function(t,e,n,o){var c=!!o&&!!o.unsafe,u=!!o&&!!o.enumerable,l=!!o&&!!o.noTargetGet;"function"==typeof n&&("string"!=typeof e||a(n,"name")||r(n,"name",e),d(n).source=f.join("string"==typeof e?e:"")),t!==i?(c?!l&&t[e]&&(u=!0):delete t[e],u?t[e]=n:r(t,e,n)):u?t[e]=n:s(e,n)})(Function.prototype,"toString",function(){return"function"==typeof this&&l(this).source||c.call(this)})},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var i=n(32),o=n(22);t.exports=function(t){return i(o(t))}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var i=n(15),o=n(72);(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.3.5",mode:i?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e){t.exports=!1},function(t,e,n){var i,o,r,a=n(73),s=n(0),c=n(4),u=n(6),l=n(5),d=n(24),f=n(25),p=s.WeakMap;if(a){var h=new p,m=h.get,g=h.has,v=h.set;i=function(t,e){return v.call(h,t,e),e},o=function(t){return m.call(h,t)||{}},r=function(t){return g.call(h,t)}}else{var b=d("state");f[b]=!0,i=function(t,e){return u(t,b,e),e},o=function(t){return l(t,b)?t[b]:{}},r=function(t){return l(t,b)}}t.exports={set:i,get:o,has:r,enforce:function(t){return r(t)?o(t):i(t,{})},getterFor:function(t){return function(e){var n;if(!c(e)||(n=o(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},function(t,e,n){var i=n(47),o=n(0),r=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?r(i[t])||r(o[t]):i[t]&&i[t][e]||o[t]&&o[t][e]}},function(t,e,n){var i=n(37),o=Math.min;t.exports=function(t){return t>0?o(i(t),9007199254740991):0}},function(t,e,n){var i=n(22);t.exports=function(t){return Object(i(t))}},function(t,e){t.exports={}},function(t,e,n){var i=n(8),o=n(31),r=n(13),a=n(12),s=n(23),c=n(5),u=n(44),l=Object.getOwnPropertyDescriptor;e.f=i?l:function(t,e){if(t=a(t),e=s(e,!0),u)try{return l(t,e)}catch(t){}if(c(t,e))return r(!o.f.call(t,e),t[e])}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},function(t,e,n){var i=n(4);t.exports=function(t,e){if(!i(t))return t;var n,o;if(e&&"function"==typeof(n=t.toString)&&!i(o=n.call(t)))return o;if("function"==typeof(n=t.valueOf)&&!i(o=n.call(t)))return o;if(!e&&"function"==typeof(n=t.toString)&&!i(o=n.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var i=n(14),o=n(35),r=i("keys");t.exports=function(t){return r[t]||(r[t]=o(t))}},function(t,e){t.exports={}},function(t,e,n){var i=n(48),o=n(38);t.exports=Object.keys||function(t){return i(t,o)}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},function(t,e,n){var i=n(9).f,o=n(5),r=n(1)("toStringTag");t.exports=function(t,e,n){t&&!o(t=n?t:t.prototype,r)&&i(t,r,{configurable:!0,value:e})}},function(t,e,n){"use strict";var i,o,r=n(69),a=RegExp.prototype.exec,s=String.prototype.replace,c=a,u=(i=/a/,o=/b*/g,a.call(i,"a"),a.call(o,"a"),0!==i.lastIndex||0!==o.lastIndex),l=void 0!==/()??/.exec("")[1];(u||l)&&(c=function(t){var e,n,i,o,c=this;return l&&(n=new RegExp("^"+c.source+"$(?!\\s)",r.call(c))),u&&(e=c.lastIndex),i=a.call(c,t),u&&i&&(c.lastIndex=c.global?i.index+i[0].length:e),l&&i&&i.length>1&&s.call(i[0],n,function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)}),i}),t.exports=c},function(t,e,n){var i=n(7),o=n(76);i({target:"Object",stat:!0,forced:Object.assign!==o},{assign:o})},function(t,e,n){"use strict";var i={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,r=o&&!i.call({1:2},1);e.f=r?function(t){var e=o(this,t);return!!e&&e.enumerable}:i},function(t,e,n){var i=n(2),o=n(11),r="".split;t.exports=i(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==o(t)?r.call(t,""):Object(t)}:Object},function(t,e,n){var i=n(0),o=n(4),r=i.document,a=o(r)&&o(r.createElement);t.exports=function(t){return a?r.createElement(t):{}}},function(t,e,n){var i=n(0),o=n(6);t.exports=function(t,e){try{o(i,t,e)}catch(n){i[t]=e}return e}},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+i).toString(36)}},function(t,e,n){var i=n(48),o=n(38).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,o)}},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var i=n(27);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,o){return t.call(e,n,i,o)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){var i=n(11);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){var i=n(17);t.exports=i("navigator","userAgent")||""},function(t,e,n){var i=n(3),o=n(97),r=n(38),a=n(25),s=n(59),c=n(33),u=n(24)("IE_PROTO"),l=function(){},d=function(){var t,e=c("iframe"),n=r.length;for(e.style.display="none",s.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),d=t.F;n--;)delete d.prototype[r[n]];return d()};t.exports=Object.create||function(t,e){var n;return null!==t?(l.prototype=i(t),n=new l,l.prototype=null,n[u]=t):n=d(),void 0===e?n:o(n,e)},a[u]=!0},function(t,e,n){var i=n(8),o=n(2),r=n(33);t.exports=!i&&!o(function(){return 7!=Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(14);t.exports=i("native-function-to-string",Function.toString)},function(t,e,n){var i=n(5),o=n(74),r=n(21),a=n(9);t.exports=function(t,e){for(var n=o(e),s=a.f,c=r.f,u=0;u<n.length;u++){var l=n[u];i(t,l)||s(t,l,c(e,l))}}},function(t,e,n){t.exports=n(0)},function(t,e,n){var i=n(5),o=n(12),r=n(75).indexOf,a=n(25);t.exports=function(t,e){var n,s=o(t),c=0,u=[];for(n in s)!i(a,n)&&i(s,n)&&u.push(n);for(;e.length>c;)i(s,n=e[c++])&&(~r(u,n)||u.push(n));return u}},function(t,e,n){var i=n(37),o=Math.max,r=Math.min;t.exports=function(t,e){var n=i(t);return n<0?o(n+e,0):r(n,e)}},function(t,e,n){var i=n(2),o=/#|\.prototype\./,r=function(t,e){var n=s[a(t)];return n==u||n!=c&&("function"==typeof e?i(e):!!e)},a=r.normalize=function(t){return String(t).replace(o,".").toLowerCase()},s=r.data={},c=r.NATIVE="N",u=r.POLYFILL="P";t.exports=r},function(t,e,n){"use strict";var i=n(7),o=n(52);i({target:"Array",proto:!0,forced:[].forEach!=o},{forEach:o})},function(t,e,n){"use strict";var i=n(53).forEach,o=n(78);t.exports=o("forEach")?function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}:[].forEach},function(t,e,n){var i=n(40),o=n(32),r=n(19),a=n(18),s=n(77),c=[].push,u=function(t){var e=1==t,n=2==t,u=3==t,l=4==t,d=6==t,f=5==t||d;return function(p,h,m,g){for(var v,b,y=r(p),_=o(y),w=i(h,m,3),C=a(_.length),x=0,I=g||s,k=e?I(p,C):n?I(p,0):void 0;C>x;x++)if((f||x in _)&&(b=w(v=_[x],x,y),t))if(e)k[x]=b;else if(b)switch(t){case 3:return!0;case 5:return v;case 6:return x;case 2:c.call(k,v)}else if(l)return!1;return d?-1:u||l?l:k}};t.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6)}},function(t,e,n){var i=n(2);t.exports=!!Object.getOwnPropertySymbols&&!i(function(){return!String(Symbol())})},function(t,e,n){var i=n(10),o=n(80),r=Object.prototype;o!==r.toString&&i(r,"toString",o,{unsafe:!0})},function(t,e,n){var i=n(11),o=n(1)("toStringTag"),r="Arguments"==i(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),o))?n:r?i(e):"Object"==(a=i(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,n){var i=n(3),o=n(27),r=n(1)("species");t.exports=function(t,e){var n,a=i(t).constructor;return void 0===a||null==(n=i(a)[r])?e:o(n)}},function(t,e,n){var i,o,r,a=n(0),s=n(2),c=n(11),u=n(40),l=n(59),d=n(33),f=n(42),p=a.location,h=a.setImmediate,m=a.clearImmediate,g=a.process,v=a.MessageChannel,b=a.Dispatch,y=0,_={},w=function(t){if(_.hasOwnProperty(t)){var e=_[t];delete _[t],e()}},C=function(t){return function(){w(t)}},x=function(t){w(t.data)},I=function(t){a.postMessage(t+"",p.protocol+"//"+p.host)};h&&m||(h=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return _[++y]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},i(y),y},m=function(t){delete _[t]},"process"==c(g)?i=function(t){g.nextTick(C(t))}:b&&b.now?i=function(t){b.now(C(t))}:v&&!/(iphone|ipod|ipad).*applewebkit/i.test(f)?(r=(o=new v).port2,o.port1.onmessage=x,i=u(r.postMessage,r,1)):!a.addEventListener||"function"!=typeof postMessage||a.importScripts||s(I)?i="onreadystatechange"in d("script")?function(t){l.appendChild(d("script")).onreadystatechange=function(){l.removeChild(this),w(t)}}:function(t){setTimeout(C(t),0)}:(i=I,a.addEventListener("message",x,!1))),t.exports={set:h,clear:m}},function(t,e,n){var i=n(17);t.exports=i("document","documentElement")},function(t,e,n){"use strict";var i=n(27),o=function(t){var e,n;this.promise=new t(function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i}),this.resolve=i(e),this.reject=i(n)};t.exports.f=function(t){return new o(t)}},function(t,e,n){var i,o,r=n(0),a=n(42),s=r.process,c=s&&s.versions,u=c&&c.v8;u?o=(i=u.split("."))[0]+i[1]:a&&(i=a.match(/Chrome\/(\d+)/))&&(o=i[1]),t.exports=o&&+o},function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,e,n){e.f=n(1)},function(t,e,n){var i=n(47),o=n(5),r=n(63),a=n(9).f;t.exports=function(t){var e=i.Symbol||(i.Symbol={});o(e,t)||a(e,t,{value:r.f(t)})}},function(t,e,n){"use strict";var i=n(12),o=n(101),r=n(20),a=n(16),s=n(66),c=a.set,u=a.getterFor("Array Iterator");t.exports=s(Array,"Array",function(t,e){c(this,{type:"Array Iterator",target:i(t),index:0,kind:e})},function(){var t=u(this),e=t.target,n=t.kind,i=t.index++;return!e||i>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:i,done:!1}:"values"==n?{value:e[i],done:!1}:{value:[i,e[i]],done:!1}},"values"),r.Arguments=r.Array,o("keys"),o("values"),o("entries")},function(t,e,n){"use strict";var i=n(7),o=n(102),r=n(68),a=n(104),s=n(28),c=n(6),u=n(10),l=n(1),d=n(15),f=n(20),p=n(67),h=p.IteratorPrototype,m=p.BUGGY_SAFARI_ITERATORS,g=l("iterator"),v=function(){return this};t.exports=function(t,e,n,l,p,b,y){o(n,e,l);var _,w,C,x=function(t){if(t===p&&P)return P;if(!m&&t in S)return S[t];switch(t){case"keys":case"values":case"entries":return function(){return new n(this,t)}}return function(){return new n(this)}},I=e+" Iterator",k=!1,S=t.prototype,O=S[g]||S["@@iterator"]||p&&S[p],P=!m&&O||x(p),T="Array"==e&&S.entries||O;if(T&&(_=r(T.call(new t)),h!==Object.prototype&&_.next&&(d||r(_)===h||(a?a(_,h):"function"!=typeof _[g]&&c(_,g,v)),s(_,I,!0,!0),d&&(f[I]=v))),"values"==p&&O&&"values"!==O.name&&(k=!0,P=function(){return O.call(this)}),d&&!y||S[g]===P||c(S,g,P),f[e]=P,p)if(w={values:x("values"),keys:b?P:x("keys"),entries:x("entries")},y)for(C in w)!m&&!k&&C in S||u(S,C,w[C]);else i({target:e,proto:!0,forced:m||k},w);return w}},function(t,e,n){"use strict";var i,o,r,a=n(68),s=n(6),c=n(5),u=n(1),l=n(15),d=u("iterator"),f=!1;[].keys&&("next"in(r=[].keys())?(o=a(a(r)))!==Object.prototype&&(i=o):f=!0),null==i&&(i={}),l||c(i,d)||s(i,d,function(){return this}),t.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:f}},function(t,e,n){var i=n(5),o=n(19),r=n(24),a=n(103),s=r("IE_PROTO"),c=Object.prototype;t.exports=a?Object.getPrototypeOf:function(t){return t=o(t),i(t,s)?t[s]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?c:null}},function(t,e,n){"use strict";var i=n(3);t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){var i=n(37),o=n(22),r=function(t){return function(e,n){var r,a,s=String(o(e)),c=i(n),u=s.length;return c<0||c>=u?t?"":void 0:(r=s.charCodeAt(c))<55296||r>56319||c+1===u||(a=s.charCodeAt(c+1))<56320||a>57343?t?s.charAt(c):r:t?s.slice(c,c+2):a-56320+(r-55296<<10)+65536}};t.exports={codeAt:r(!1),charAt:r(!0)}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var i=n(0),o=n(34),r=i["__core-js_shared__"]||o("__core-js_shared__",{});t.exports=r},function(t,e,n){var i=n(0),o=n(45),r=i.WeakMap;t.exports="function"==typeof r&&/native code/.test(o.call(r))},function(t,e,n){var i=n(17),o=n(36),r=n(39),a=n(3);t.exports=i("Reflect","ownKeys")||function(t){var e=o.f(a(t)),n=r.f;return n?e.concat(n(t)):e}},function(t,e,n){var i=n(12),o=n(18),r=n(49),a=function(t){return function(e,n,a){var s,c=i(e),u=o(c.length),l=r(a,u);if(t&&n!=n){for(;u>l;)if((s=c[l++])!=s)return!0}else for(;u>l;l++)if((t||l in c)&&c[l]===n)return t||l||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},function(t,e,n){"use strict";var i=n(8),o=n(2),r=n(26),a=n(39),s=n(31),c=n(19),u=n(32),l=Object.assign;t.exports=!l||o(function(){var t={},e={},n=Symbol();return t[n]=7,"abcdefghijklmnopqrst".split("").forEach(function(t){e[t]=t}),7!=l({},t)[n]||"abcdefghijklmnopqrst"!=r(l({},e)).join("")})?function(t,e){for(var n=c(t),o=arguments.length,l=1,d=a.f,f=s.f;o>l;)for(var p,h=u(arguments[l++]),m=d?r(h).concat(d(h)):r(h),g=m.length,v=0;g>v;)p=m[v++],i&&!f.call(h,p)||(n[p]=h[p]);return n}:l},function(t,e,n){var i=n(4),o=n(41),r=n(1)("species");t.exports=function(t,e){var n;return o(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!o(n.prototype)?i(n)&&null===(n=n[r])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===e?0:e)}},function(t,e,n){"use strict";var i=n(2);t.exports=function(t,e){var n=[][t];return!n||!i(function(){n.call(null,e||function(){throw 1},1)})}},function(t,e,n){var i=n(7),o=n(19),r=n(26);i({target:"Object",stat:!0,forced:n(2)(function(){r(1)})},{keys:function(t){return r(o(t))}})},function(t,e,n){"use strict";var i=n(56),o={};o[n(1)("toStringTag")]="z",t.exports="[object z]"!==String(o)?function(){return"[object "+i(this)+"]"}:o.toString},function(t,e,n){"use strict";var i,o,r,a,s=n(7),c=n(15),u=n(0),l=n(17),d=n(82),f=n(10),p=n(83),h=n(28),m=n(84),g=n(4),v=n(27),b=n(85),y=n(11),_=n(86),w=n(90),C=n(57),x=n(58).set,I=n(91),k=n(92),S=n(93),O=n(60),P=n(94),T=n(16),E=n(50),j=n(1),L=n(61),A=j("species"),D="Promise",M=T.get,N=T.set,R=T.getterFor(D),B=d,U=u.TypeError,H=u.document,$=u.process,F=l("fetch"),V=O.f,z=V,G="process"==y($),J=!!(H&&H.createEvent&&u.dispatchEvent),W=E(D,function(){if(66===L)return!0;if(!G&&"function"!=typeof PromiseRejectionEvent)return!0;if(c&&!B.prototype.finally)return!0;if(L>=51&&/native code/.test(B))return!1;var t=B.resolve(1),e=function(t){t(function(){},function(){})};return(t.constructor={})[A]=e,!(t.then(function(){})instanceof e)}),K=W||!w(function(t){B.all(t).catch(function(){})}),Y=function(t){var e;return!(!g(t)||"function"!=typeof(e=t.then))&&e},q=function(t,e,n){if(!e.notified){e.notified=!0;var i=e.reactions;I(function(){for(var o=e.value,r=1==e.state,a=0;i.length>a;){var s,c,u,l=i[a++],d=r?l.ok:l.fail,f=l.resolve,p=l.reject,h=l.domain;try{d?(r||(2===e.rejection&&tt(t,e),e.rejection=1),!0===d?s=o:(h&&h.enter(),s=d(o),h&&(h.exit(),u=!0)),s===l.promise?p(U("Promise-chain cycle")):(c=Y(s))?c.call(s,f,p):f(s)):p(o)}catch(t){h&&!u&&h.exit(),p(t)}}e.reactions=[],e.notified=!1,n&&!e.rejection&&X(t,e)})}},Q=function(t,e,n){var i,o;J?((i=H.createEvent("Event")).promise=e,i.reason=n,i.initEvent(t,!1,!0),u.dispatchEvent(i)):i={promise:e,reason:n},(o=u["on"+t])?o(i):"unhandledrejection"===t&&S("Unhandled promise rejection",n)},X=function(t,e){x.call(u,function(){var n,i=e.value;if(Z(e)&&(n=P(function(){G?$.emit("unhandledRejection",i,t):Q("unhandledrejection",t,i)}),e.rejection=G||Z(e)?2:1,n.error))throw n.value})},Z=function(t){return 1!==t.rejection&&!t.parent},tt=function(t,e){x.call(u,function(){G?$.emit("rejectionHandled",t):Q("rejectionhandled",t,e.value)})},et=function(t,e,n,i){return function(o){t(e,n,o,i)}},nt=function(t,e,n,i){e.done||(e.done=!0,i&&(e=i),e.value=n,e.state=2,q(t,e,!0))},it=function(t,e,n,i){if(!e.done){e.done=!0,i&&(e=i);try{if(t===n)throw U("Promise can't be resolved itself");var o=Y(n);o?I(function(){var i={done:!1};try{o.call(n,et(it,t,i,e),et(nt,t,i,e))}catch(n){nt(t,i,n,e)}}):(e.value=n,e.state=1,q(t,e,!1))}catch(n){nt(t,{done:!1},n,e)}}};W&&(B=function(t){b(this,B,D),v(t),i.call(this);var e=M(this);try{t(et(it,this,e),et(nt,this,e))}catch(t){nt(this,e,t)}},(i=function(t){N(this,{type:D,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=p(B.prototype,{then:function(t,e){var n=R(this),i=V(C(this,B));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=G?$.domain:void 0,n.parent=!0,n.reactions.push(i),0!=n.state&&q(this,n,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new i,e=M(t);this.promise=t,this.resolve=et(it,t,e),this.reject=et(nt,t,e)},O.f=V=function(t){return t===B||t===r?new o(t):z(t)},c||"function"!=typeof d||(a=d.prototype.then,f(d.prototype,"then",function(t,e){var n=this;return new B(function(t,e){a.call(n,t,e)}).then(t,e)},{unsafe:!0}),"function"==typeof F&&s({global:!0,enumerable:!0,forced:!0},{fetch:function(t){return k(B,F.apply(u,arguments))}}))),s({global:!0,wrap:!0,forced:W},{Promise:B}),h(B,D,!1,!0),m(D),r=l(D),s({target:D,stat:!0,forced:W},{reject:function(t){var e=V(this);return e.reject.call(void 0,t),e.promise}}),s({target:D,stat:!0,forced:c||W},{resolve:function(t){return k(c&&this===r?B:this,t)}}),s({target:D,stat:!0,forced:K},{all:function(t){var e=this,n=V(e),i=n.resolve,o=n.reject,r=P(function(){var n=v(e.resolve),r=[],a=0,s=1;_(t,function(t){var c=a++,u=!1;r.push(void 0),s++,n.call(e,t).then(function(t){u||(u=!0,r[c]=t,--s||i(r))},o)}),--s||i(r)});return r.error&&o(r.value),n.promise},race:function(t){var e=this,n=V(e),i=n.reject,o=P(function(){var o=v(e.resolve);_(t,function(t){o.call(e,t).then(n.resolve,i)})});return o.error&&i(o.value),n.promise}})},function(t,e,n){var i=n(0);t.exports=i.Promise},function(t,e,n){var i=n(10);t.exports=function(t,e,n){for(var o in e)i(t,o,e[o],n);return t}},function(t,e,n){"use strict";var i=n(17),o=n(9),r=n(1),a=n(8),s=r("species");t.exports=function(t){var e=i(t),n=o.f;a&&e&&!e[s]&&n(e,s,{configurable:!0,get:function(){return this}})}},function(t,e){t.exports=function(t,e,n){if(!(t instanceof e))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return t}},function(t,e,n){var i=n(3),o=n(87),r=n(18),a=n(40),s=n(88),c=n(89),u=function(t,e){this.stopped=t,this.result=e};(t.exports=function(t,e,n,l,d){var f,p,h,m,g,v,b,y=a(e,n,l?2:1);if(d)f=t;else{if("function"!=typeof(p=s(t)))throw TypeError("Target is not iterable");if(o(p)){for(h=0,m=r(t.length);m>h;h++)if((g=l?y(i(b=t[h])[0],b[1]):y(t[h]))&&g instanceof u)return g;return new u(!1)}f=p.call(t)}for(v=f.next;!(b=v.call(f)).done;)if("object"==typeof(g=c(f,y,b.value,l))&&g&&g instanceof u)return g;return new u(!1)}).stop=function(t){return new u(!0,t)}},function(t,e,n){var i=n(1),o=n(20),r=i("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(o.Array===t||a[r]===t)}},function(t,e,n){var i=n(56),o=n(20),r=n(1)("iterator");t.exports=function(t){if(null!=t)return t[r]||t["@@iterator"]||o[i(t)]}},function(t,e,n){var i=n(3);t.exports=function(t,e,n,o){try{return o?e(i(n)[0],n[1]):e(n)}catch(e){var r=t.return;throw void 0!==r&&i(r.call(t)),e}}},function(t,e,n){var i=n(1)("iterator"),o=!1;try{var r=0,a={next:function(){return{done:!!r++}},return:function(){o=!0}};a[i]=function(){return this},Array.from(a,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!o)return!1;var n=!1;try{var r={};r[i]=function(){return{next:function(){return{done:n=!0}}}},t(r)}catch(t){}return n}},function(t,e,n){var i,o,r,a,s,c,u,l,d=n(0),f=n(21).f,p=n(11),h=n(58).set,m=n(42),g=d.MutationObserver||d.WebKitMutationObserver,v=d.process,b=d.Promise,y="process"==p(v),_=f(d,"queueMicrotask"),w=_&&_.value;w||(i=function(){var t,e;for(y&&(t=v.domain)&&t.exit();o;){e=o.fn,o=o.next;try{e()}catch(t){throw o?a():r=void 0,t}}r=void 0,t&&t.enter()},y?a=function(){v.nextTick(i)}:g&&!/(iphone|ipod|ipad).*applewebkit/i.test(m)?(s=!0,c=document.createTextNode(""),new g(i).observe(c,{characterData:!0}),a=function(){c.data=s=!s}):b&&b.resolve?(u=b.resolve(void 0),l=u.then,a=function(){l.call(u,i)}):a=function(){h.call(d,i)}),t.exports=w||function(t){var e={fn:t,next:void 0};r&&(r.next=e),o||(o=e,a()),r=e}},function(t,e,n){var i=n(3),o=n(4),r=n(60);t.exports=function(t,e){if(i(t),o(e)&&e.constructor===t)return e;var n=r.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){var i=n(0);t.exports=function(t,e){var n=i.console;n&&n.error&&(1===arguments.length?n.error(t):n.error(t,e))}},function(t,e){t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},function(t,e,n){var i=n(0),o=n(62),r=n(52),a=n(6);for(var s in o){var c=i[s],u=c&&c.prototype;if(u&&u.forEach!==r)try{a(u,"forEach",r)}catch(t){u.forEach=r}}},function(t,e,n){"use strict";var i=n(7),o=n(0),r=n(15),a=n(8),s=n(54),c=n(2),u=n(5),l=n(41),d=n(4),f=n(3),p=n(19),h=n(12),m=n(23),g=n(13),v=n(43),b=n(26),y=n(36),_=n(98),w=n(39),C=n(21),x=n(9),I=n(31),k=n(6),S=n(10),O=n(14),P=n(24),T=n(25),E=n(35),j=n(1),L=n(63),A=n(64),D=n(28),M=n(16),N=n(53).forEach,R=P("hidden"),B=j("toPrimitive"),U=M.set,H=M.getterFor("Symbol"),$=Object.prototype,F=o.Symbol,V=o.JSON,z=V&&V.stringify,G=C.f,J=x.f,W=_.f,K=I.f,Y=O("symbols"),q=O("op-symbols"),Q=O("string-to-symbol-registry"),X=O("symbol-to-string-registry"),Z=O("wks"),tt=o.QObject,et=!tt||!tt.prototype||!tt.prototype.findChild,nt=a&&c(function(){return 7!=v(J({},"a",{get:function(){return J(this,"a",{value:7}).a}})).a})?function(t,e,n){var i=G($,e);i&&delete $[e],J(t,e,n),i&&t!==$&&J($,e,i)}:J,it=function(t,e){var n=Y[t]=v(F.prototype);return U(n,{type:"Symbol",tag:t,description:e}),a||(n.description=e),n},ot=s&&"symbol"==typeof F.iterator?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof F},rt=function(t,e,n){t===$&&rt(q,e,n),f(t);var i=m(e,!0);return f(n),u(Y,i)?(n.enumerable?(u(t,R)&&t[R][i]&&(t[R][i]=!1),n=v(n,{enumerable:g(0,!1)})):(u(t,R)||J(t,R,g(1,{})),t[R][i]=!0),nt(t,i,n)):J(t,i,n)},at=function(t,e){f(t);var n=h(e),i=b(n).concat(lt(n));return N(i,function(e){a&&!st.call(n,e)||rt(t,e,n[e])}),t},st=function(t){var e=m(t,!0),n=K.call(this,e);return!(this===$&&u(Y,e)&&!u(q,e))&&(!(n||!u(this,e)||!u(Y,e)||u(this,R)&&this[R][e])||n)},ct=function(t,e){var n=h(t),i=m(e,!0);if(n!==$||!u(Y,i)||u(q,i)){var o=G(n,i);return!o||!u(Y,i)||u(n,R)&&n[R][i]||(o.enumerable=!0),o}},ut=function(t){var e=W(h(t)),n=[];return N(e,function(t){u(Y,t)||u(T,t)||n.push(t)}),n},lt=function(t){var e=t===$,n=W(e?q:h(t)),i=[];return N(n,function(t){!u(Y,t)||e&&!u($,t)||i.push(Y[t])}),i};s||(S((F=function(){if(this instanceof F)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=E(t),n=function(t){this===$&&n.call(q,t),u(this,R)&&u(this[R],e)&&(this[R][e]=!1),nt(this,e,g(1,t))};return a&&et&&nt($,e,{configurable:!0,set:n}),it(e,t)}).prototype,"toString",function(){return H(this).tag}),I.f=st,x.f=rt,C.f=ct,y.f=_.f=ut,w.f=lt,a&&(J(F.prototype,"description",{configurable:!0,get:function(){return H(this).description}}),r||S($,"propertyIsEnumerable",st,{unsafe:!0})),L.f=function(t){return it(j(t),t)}),i({global:!0,wrap:!0,forced:!s,sham:!s},{Symbol:F}),N(b(Z),function(t){A(t)}),i({target:"Symbol",stat:!0,forced:!s},{for:function(t){var e=String(t);if(u(Q,e))return Q[e];var n=F(e);return Q[e]=n,X[n]=e,n},keyFor:function(t){if(!ot(t))throw TypeError(t+" is not a symbol");if(u(X,t))return X[t]},useSetter:function(){et=!0},useSimple:function(){et=!1}}),i({target:"Object",stat:!0,forced:!s,sham:!a},{create:function(t,e){return void 0===e?v(t):at(v(t),e)},defineProperty:rt,defineProperties:at,getOwnPropertyDescriptor:ct}),i({target:"Object",stat:!0,forced:!s},{getOwnPropertyNames:ut,getOwnPropertySymbols:lt}),i({target:"Object",stat:!0,forced:c(function(){w.f(1)})},{getOwnPropertySymbols:function(t){return w.f(p(t))}}),V&&i({target:"JSON",stat:!0,forced:!s||c(function(){var t=F();return"[null]"!=z([t])||"{}"!=z({a:t})||"{}"!=z(Object(t))})},{stringify:function(t){for(var e,n,i=[t],o=1;arguments.length>o;)i.push(arguments[o++]);if(n=e=i[1],(d(e)||void 0!==t)&&!ot(t))return l(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!ot(e))return e}),i[1]=e,z.apply(V,i)}}),F.prototype[B]||k(F.prototype,B,F.prototype.valueOf),D(F,"Symbol"),T[R]=!0},function(t,e,n){var i=n(8),o=n(9),r=n(3),a=n(26);t.exports=i?Object.defineProperties:function(t,e){r(t);for(var n,i=a(e),s=i.length,c=0;s>c;)o.f(t,n=i[c++],e[n]);return t}},function(t,e,n){var i=n(12),o=n(36).f,r={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==r.call(t)?function(t){try{return o(t)}catch(t){return a.slice()}}(t):o(i(t))}},function(t,e,n){"use strict";var i=n(7),o=n(8),r=n(0),a=n(5),s=n(4),c=n(9).f,u=n(46),l=r.Symbol;if(o&&"function"==typeof l&&(!("description"in l.prototype)||void 0!==l().description)){var d={},f=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof f?new l(t):void 0===t?l():l(t);return""===t&&(d[e]=!0),e};u(f,l);var p=f.prototype=l.prototype;p.constructor=f;var h=p.toString,m="Symbol(test)"==String(l("test")),g=/^Symbol\((.*)\)[^)]+$/;c(p,"description",{configurable:!0,get:function(){var t=s(this)?this.valueOf():this,e=h.call(t);if(a(d,t))return"";var n=m?e.slice(7,-1):e.replace(g,"$1");return""===n?void 0:n}}),i({global:!0,forced:!0},{Symbol:f})}},function(t,e,n){n(64)("iterator")},function(t,e,n){var i=n(1),o=n(43),r=n(6),a=i("unscopables"),s=Array.prototype;null==s[a]&&r(s,a,o(null)),t.exports=function(t){s[a][t]=!0}},function(t,e,n){"use strict";var i=n(67).IteratorPrototype,o=n(43),r=n(13),a=n(28),s=n(20),c=function(){return this};t.exports=function(t,e,n){var u=e+" Iterator";return t.prototype=o(i,{next:r(1,n)}),a(t,u,!1,!0),s[u]=c,t}},function(t,e,n){var i=n(2);t.exports=!i(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})},function(t,e,n){var i=n(3),o=n(105);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return i(n),o(r),e?t.call(n,r):n.__proto__=r,n}}():void 0)},function(t,e,n){var i=n(4);t.exports=function(t){if(!i(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},function(t,e,n){"use strict";var i=n(7),o=n(4),r=n(41),a=n(49),s=n(18),c=n(12),u=n(107),l=n(108),d=n(1)("species"),f=[].slice,p=Math.max;i({target:"Array",proto:!0,forced:!l("slice")},{slice:function(t,e){var n,i,l,h=c(this),m=s(h.length),g=a(t,m),v=a(void 0===e?m:e,m);if(r(h)&&("function"!=typeof(n=h.constructor)||n!==Array&&!r(n.prototype)?o(n)&&null===(n=n[d])&&(n=void 0):n=void 0,n===Array||void 0===n))return f.call(h,g,v);for(i=new(void 0===n?Array:n)(p(v-g,0)),l=0;g<v;g++,l++)g in h&&u(i,l,h[g]);return i.length=l,i}})},function(t,e,n){"use strict";var i=n(23),o=n(9),r=n(13);t.exports=function(t,e,n){var a=i(e);a in t?o.f(t,a,r(0,n)):t[a]=n}},function(t,e,n){var i=n(2),o=n(1),r=n(61),a=o("species");t.exports=function(t){return r>=51||!i(function(){var e=[];return(e.constructor={})[a]=function(){return{foo:1}},1!==e[t](Boolean).foo})}},function(t,e,n){var i=n(10),o=Date.prototype,r=o.toString,a=o.getTime;new Date(NaN)+""!="Invalid Date"&&i(o,"toString",function(){var t=a.call(this);return t==t?r.call(this):"Invalid Date"})},function(t,e,n){"use strict";var i=n(7),o=n(29);i({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},function(t,e,n){"use strict";var i=n(10),o=n(3),r=n(2),a=n(69),s=RegExp.prototype,c=s.toString,u=r(function(){return"/a/b"!=c.call({source:"a",flags:"b"})}),l="toString"!=c.name;(u||l)&&i(RegExp.prototype,"toString",function(){var t=o(this),e=String(t.source),n=t.flags;return"/"+e+"/"+String(void 0===n&&t instanceof RegExp&&!("flags"in s)?a.call(t):n)},{unsafe:!0})},function(t,e,n){"use strict";var i=n(70).charAt,o=n(16),r=n(66),a=o.set,s=o.getterFor("String Iterator");r(String,"String",function(t){a(this,{type:"String Iterator",string:String(t),index:0})},function(){var t,e=s(this),n=e.string,o=e.index;return o>=n.length?{value:void 0,done:!0}:(t=i(n,o),e.index+=t.length,{value:t,done:!1})})},function(t,e,n){"use strict";var i=n(114),o=n(115),r=n(3),a=n(22),s=n(57),c=n(116),u=n(18),l=n(117),d=n(29),f=n(2),p=[].push,h=Math.min,m=!f(function(){return!RegExp(4294967295,"y")});i("split",2,function(t,e,n){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,n){var i=String(a(this)),r=void 0===n?4294967295:n>>>0;if(0===r)return[];if(void 0===t)return[i];if(!o(t))return e.call(i,t,r);for(var s,c,u,l=[],f=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,m=new RegExp(t.source,f+"g");(s=d.call(m,i))&&!((c=m.lastIndex)>h&&(l.push(i.slice(h,s.index)),s.length>1&&s.index<i.length&&p.apply(l,s.slice(1)),u=s[0].length,h=c,l.length>=r));)m.lastIndex===s.index&&m.lastIndex++;return h===i.length?!u&&m.test("")||l.push(""):l.push(i.slice(h)),l.length>r?l.slice(0,r):l}:"0".split(void 0,0).length?function(t,n){return void 0===t&&0===n?[]:e.call(this,t,n)}:e,[function(e,n){var o=a(this),r=null==e?void 0:e[t];return void 0!==r?r.call(e,o,n):i.call(String(o),e,n)},function(t,o){var a=n(i,t,this,o,i!==e);if(a.done)return a.value;var d=r(t),f=String(this),p=s(d,RegExp),g=d.unicode,v=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(m?"y":"g"),b=new p(m?d:"^(?:"+d.source+")",v),y=void 0===o?4294967295:o>>>0;if(0===y)return[];if(0===f.length)return null===l(b,f)?[f]:[];for(var _=0,w=0,C=[];w<f.length;){b.lastIndex=m?w:0;var x,I=l(b,m?f:f.slice(w));if(null===I||(x=h(u(b.lastIndex+(m?0:w)),f.length))===_)w=c(f,w,g);else{if(C.push(f.slice(_,w)),C.length===y)return C;for(var k=1;k<=I.length-1;k++)if(C.push(I[k]),C.length===y)return C;w=_=x}}return C.push(f.slice(_)),C}]},!m)},function(t,e,n){"use strict";var i=n(6),o=n(10),r=n(2),a=n(1),s=n(29),c=a("species"),u=!r(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),l=!r(function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]});t.exports=function(t,e,n,d){var f=a(t),p=!r(function(){var e={};return e[f]=function(){return 7},7!=""[t](e)}),h=p&&!r(function(){var e=!1,n=/a/;return"split"===t&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[f]=/./[f]),n.exec=function(){return e=!0,null},n[f](""),!e});if(!p||!h||"replace"===t&&!u||"split"===t&&!l){var m=/./[f],g=n(f,""[t],function(t,e,n,i,o){return e.exec===s?p&&!o?{done:!0,value:m.call(e,n,i)}:{done:!0,value:t.call(n,e,i)}:{done:!1}}),v=g[0],b=g[1];o(String.prototype,t,v),o(RegExp.prototype,f,2==e?function(t,e){return b.call(t,this,e)}:function(t){return b.call(t,this)}),d&&i(RegExp.prototype[f],"sham",!0)}}},function(t,e,n){var i=n(4),o=n(11),r=n(1)("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[r])?!!e:"RegExp"==o(t))}},function(t,e,n){"use strict";var i=n(70).charAt;t.exports=function(t,e,n){return e+(n?i(t,e).length:1)}},function(t,e,n){var i=n(11),o=n(29);t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var r=n.call(t,e);if("object"!=typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==i(t))throw TypeError("RegExp#exec called on incompatible receiver");return o.call(t,e)}},function(t,e,n){var i=n(0),o=n(62),r=n(65),a=n(6),s=n(1),c=s("iterator"),u=s("toStringTag"),l=r.values;for(var d in o){var f=i[d],p=f&&f.prototype;if(p){if(p[c]!==l)try{a(p,c,l)}catch(t){p[c]=l}if(p[u]||a(p,u,d),o[d])for(var h in r)if(p[h]!==r[h])try{a(p,h,r[h])}catch(t){p[h]=r[h]}}}},function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.r(e),n(30),n(51),n(79),n(55),n(81),n(95),n(96),n(99),n(100),n(65),n(106),n(109),n(110),n(111),n(112),n(113),n(118);var o={pv:{},click:{},default:{}};function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(o).forEach(function(e){o[e]=Object.assign({},t[e])})}function a(t){!function t(e,n,r){var a=!!n&&(n instanceof Promise?"promise":"function"==typeof n?"function":"string"==typeof n?"string":"[object Object]"===String(n)?"object":void 0);if(a)if("object"!==a){if("string"===a){var s={};return s.event=n,void t(e,s,r)}if("function"!==a)"promise"!==a||n.then(function(n){t(e,n,r)});else{var c=n();t(e,c,r)}}else{var u=Object.assign({},o.default,o[e],{e:r},n);!function(t,e){var n={logId:e.logId,sendStatus:e.sendStatus||"double",spmId:e.spmId,sendUrl:e.sendUrl};if(void 0!==e.data&&null!==e.data&&"{}"!==JSON.stringify(e.data)&&(n.msg={value:e.data,_rdm:Math.random().toString().split(".")[1].slice(0,5)}),e.event){var o=e.spmId+".selfDef."+e.event;n.spm_id=o,"object"===i(n.msg)?n.msg.event=e.event:n.msg={event:e.event,_rdm:Math.random().toString().split(".")[1].slice(0,5)}}"click"===t?window.__bp_statisObserver.sendClickEvent(n,e.e):"pv"===t&&window.__bp_statisObserver.sendPV(n)}(e,u)}}(t.type,t.data,t.e)}var s=[];function c(){if(Object.assign)return!!(window.__bp_statisObserver&&window.__bp_statisObserver.sendClickEvent&&window.__bp_statisObserver.sendPV);console.error("No Object.assign. component.statistics needs Object.assign polyfill.")}function u(){c()&&s.forEach(function(){a(s.shift())})}function l(t){s.push(t),setTimeout(function(){u()},1e3)}function d(t){if(void 0===window.__bp_statisObserver){window.__bp_statisObserverConfig=Object.assign({loadPV:!0,loadEvent:!0,loadPerform:!1,loadSpecial:!1,loadBaidu:!1},window.__bp_statisObserverConfig);var e=document.createElement("script");e.onload=function(){u(),t&&t()},e.src="//s1.hdslb.com/bfs/seed/bplus-common/statistics-js/log-reporter.js",document.getElementsByTagName("body")[0].appendChild(e)}else t&&t()}function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=Object.assign({},{data:t},{type:"click"},{e:e});if(!c())return l(n),void d();a(n)}function p(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},{data:t},{type:"pv"});if(!c())return l(e),void d();a(e)}n.d(e,"bpreport",function(){return h}),n.d(e,"bpreportPlugin",function(){return m});var h={click:f,event:f,pv:p,setDefault:r},m={install:function(t,e){r(e),t.prototype.$bpreport=h,t.directive("bpreport",{bind:function(t,e){"click"===e.arg&&t.addEventListener("click",function(t){f(e.value,t)})},inserted:function(t,e){"pv"===e.arg&&p(e.value)}})}}}])},,,,,,,,,function(t,e,n){"use strict";var i={name:"bl-button",props:{disabled:Boolean,type:{type:String,default:"primary"},size:{type:String,default:"size"}},methods:{handleClick:function(t){this.$emit("click",t)}}},o=(n(232),n(2)),r=Object(o.a)(i,function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"bl-button",class:[this.type?"bl-button--"+this.type:"",this.size?"bl-button--"+this.size:""],attrs:{disabled:this.disabled},on:{click:this.handleClick}},[e("span",{staticClass:"txt"},[this._t("default")],2)])},[],!1,null,"65bda702",null).exports;e.a=r},,,,function(t,e,n){"use strict";var i=n(9),o=n.n(i),r=n(54),a=(n(53),n(213),n(13),n(32),n(28),n(27),n(10),n(44),n(31),n(30),n(18),{props:{arrow:{type:Boolean,default:!1},width:{type:Number,default:300}},data:function(){return{}},methods:{onClose:function(t){this.$emit("close"),t.stopPropagation()}}}),s=(n(241),n(2)),c=Object(s.a)(a,function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"move-in"}},[e("div",{staticClass:"static-popup",class:{"bp-arrow":this.arrow},style:{width:this.width+"px"}},[e("div",{staticClass:"bp-icon-font icon-group-dynamic close-btn",on:{click:this.onClose}}),e("div",{staticClass:"title"},[this._t("title")],2),e("div",{staticClass:"content-ctnr"},[this._t("default")],2)])])},[],!1,null,"b3d54e6c",null).exports,u=n(8),l=n(219),d={name:"emoji-item",props:{url:{type:String},title:{}},data:function(){return{imgStyle:"background-color: #e7e7e7;width:100%;height:100%;"}},mounted:function(){this.img=new Image,this.img.src=this.url,this.img.addEventListener("load",this.success),this.img.addEventListener("error",this.error)},destroyed:function(){this.img.removeEventListener("load",this.success),this.img.removeEventListener("error",this.error)},watch:{url:function(){this.img.src=this.url}},methods:{success:function(){this.img.complete&&(this.imgStyle="background-image: url(".concat(this.url,");background-size: cover;width:100%;height:100%;"))},error:function(){this.imgStyle="background-color: #e7e7e7;width:100%;height:100%;"}}},f=Object(s.a)(d,function(){var t=this.$createElement;return(this._self._c||t)("div",{style:this.imgStyle,attrs:{title:this.title}})},[],!1,null,null,null).exports,p={props:{emojiList:{type:Array,default:function(){return[]}}},components:{emojiItem:f},data:function(){return{perfectScrollbar:null,isOldBrowser:u.g}},watch:{emojiList:function(){this.isOldBrowser||this.updateScrollbar()}},mounted:function(){this.initScrollbar()},methods:{initScrollbar:function(){if(!this.isOldBrowser){var t=this.$el;this.perfectScrollbar=new l.a(t,{wheelSpeed:2,wheelPropagation:!0,minScrollbarLength:20,theme:"playlist-editor"}),this.updateScrollbar()}},updateScrollbar:function(){var t=this;this.$nextTick(function(){var e=t.$el;e.scrollTop=1,t.perfectScrollbar.update(e)})}}},h=(n(242),n(243),Object(s.a)(p,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"emoji-page",class:{ie:t.isOldBrowser},on:{mousedown:function(t){t.stopPropagation(),t.preventDefault()}}},[n("ul",{staticClass:"emoji-list f-clear"},t._l(t.emojiList,function(e){return n("li",{key:e.url,staticClass:"emoji",class:{kaomoji:4===e.type},on:{click:function(n){return t.$emit("select",e.name)}}},[4!==e.type?n("emoji-item",{attrs:{title:e.name,url:e.url.replace(/^http:\/\//,"//")}}):t._e(),4===e.type?n("span",{staticClass:"dp-i-block"},[t._v(t._s(e.name))]):t._e()],1)}),0)])},[],!1,null,"3e242f19",null).exports),m={props:{emojiLists:{type:Array,default:function(){return[]}},curPid:{type:Number,default:0}},components:{emojiItem:f},data:function(){return{lineHeight:36,curPage:1,totalPages:1}},computed:{marginTop:function(){return-(this.curPage-1)*this.lineHeight}},watch:{emojiLists:function(){this.update()}},mounted:function(){this.init(),this.update()},methods:{init:function(){this.lineHeight=this.$el.offsetHeight},update:function(){var t=this;this.$nextTick(function(){var e=t.$refs.list.offsetHeight;t.totalPages=Math.ceil(e/t.lineHeight)})},select:function(t){this.$emit("select",t)},showPrev:function(){this.curPage>1&&this.curPage--},showNext:function(){this.curPage<this.totalPages&&this.curPage++}}},g=(n(244),Object(s.a)(m,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pagination",style:{height:t.lineHeight+"px"}},[n("ul",{ref:"list",staticClass:"emoji-cover-list f-clear",style:{marginTop:t.marginTop+"px"}},t._l(t.emojiLists,function(e){return n("li",{staticClass:"emoji-cover f-left",class:{selected:e.pid===t.curPid},style:{height:t.lineHeight+"px"},on:{click:function(n){return t.select(e.pid)}}},[n("emoji-item",{attrs:{url:e.purl.replace(/^http:\/\//,"//")}})],1)}),0),t.totalPages>1?n("div",{staticClass:"page-controller",style:{height:t.lineHeight+"px",lineHeight:t.lineHeight+"px"}},[n("span",{staticClass:"prev bp-icon-font icon-btn-triangle-left",class:{disabled:t.curPage<=1},on:{click:t.showPrev}}),n("span",{staticClass:"next bp-icon-font icon-btn-triangle-right",class:{disabled:t.curPage>=t.totalPages},on:{click:t.showNext}})]):t._e()])},[],!1,null,"68831bbc",null).exports),v=n(45),b=n(26),y={MAIN:"444.41",TAG:"333.169",SPACE:"333.49",DETAIL:"444.42"},_={1:"emoji",1e3:"emotion",1001:"tv",1002:"cat"},w={props:{field:{required:!0},frozenElements:{type:Array,default:function(){return[]}},emojiType:{type:Array,default:function(){return[]}},spmType:{type:String},pubType:{type:String,default:""},selectHandler:{type:Function,default:function(){}},revert:null},data:function(){return{curPid:0,emojiLists:Object(v.b)(this.emojiType)}},computed:{curEmojiList:function(){var t=this,e=this.emojiLists.filter(function(e){return e.pid===t.curPid});return e.length>0&&e[0].emojis?e[0].emojis:[]}},created:function(){Object(b.b)()},mounted:function(){this.init(),this.bindEvents(),this.dataReport()},beforeDestroy:function(){this.removeEvents()},methods:{getCursortPosition:function(t){var e=0,n=t.ownerDocument||t.document,i=n.defaultView||n.parentWindow;if("DIV"===t.tagName){if(i.getSelection().rangeCount>0){var o=i.getSelection().getRangeAt(0),r=o.cloneRange();r.selectNodeContents(t),r.setEnd(o.endContainer,o.endOffset),e=r.toString().length}}else e=t.selectionEnd;return e},setCaretPosition:function(t,e){var n,i;"DIV"===t.tagName?((n=document.createRange()).selectNodeContents(t),t.innerHTML.length>0&&n.collapse(t,e),n.collapse(!0),(i=window.getSelection()).removeAllRanges(),i.addRange(n)):t.setSelectionRange(e,e)},mousewheelFix:function(t){t.preventDefault()},init:function(){var t=this.emojiLists[0];this.curPid=t.pid,this.focusField()},dataReport:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;y.hasOwnProperty(this.spmType)&&this.$bpreport.click({logId:"000502",spmId:y[this.spmType],event:"".concat(this.pubType?"publish":"card_rt","_emoji").concat(t).concat("MAIN"===this.spmType?this.pubType:""),data:e?{emoji_name:1e3===this.curPid?"emotion":e}:""})},bindEvents:function(){var t=this;this.$el.addEventListener("mousewheel",this.mousewheelFix,!1),this.$el.addEventListener("DOMMouseScroll",this.mousewheelFix,!1),setTimeout(function(){document.body.addEventListener("click",t.close,!1),t.$el.addEventListener("click",t.stopPropagation),t.frozenElements.forEach(function(e){e.addEventListener("click",t.stopPropagation)})},100)},removeEvents:function(){var t=this;this.$el.removeEventListener("mousewheel",this.mousewheelFix),this.$el.removeEventListener("DOMMouseScroll",this.mousewheelFix),document.body.removeEventListener("click",this.close),this.$el.removeEventListener("click",this.stopPropagation),this.frozenElements.forEach(function(e){e.removeEventListener("click",t.stopPropagation)})},stopPropagation:function(t){t.stopPropagation()},focusField:function(){this.field&&this.field.focus&&this.field.focus()},close:function(){this.$emit("close")},switchEmojiPage:function(t){this.curPid=t,this.dataReport("_tab",_[t])},insertText:function(t){if(this.dataReport("_icon",t),this.field&&"TEXTAREA"===this.field.tagName){if(this.$emit("update",t),!this.field)return;if(document.selection)this.field.focus(),document.selection.createRange().text=t;else if(this.field.selectionStart||0===parseInt(this.field.selectionStart)){var e=parseInt(this.field.selectionStart),n=this.field.selectionEnd;this.field.value=this.field.value.substring(0,e)+t+this.field.value.substring(n,this.field.value.length),this.field.setSelectionRange(e+t.length,e+t.length)}else this.field.value+=t;this.triggerTextareaInput(),this.focusField()}else this.selectHandler(t)},triggerTextareaInput:function(){var t=document.createEvent("HTMLEvents");t.initEvent("input",!1,!0),this.field.dispatchEvent(t)}},components:{StaticBox:c,EmojiPage:h,EmojiPagination:g}},C=(n(245),Object(s.a)(w,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"move-in"}},[n("div",{class:{revert:t.revert},on:{mousedown:function(t){t.stopPropagation(),t.preventDefault()}}},[n("static-box",{staticClass:"common-font",attrs:{arrow:!t.revert,width:380},on:{close:t.close}},[n("span",{attrs:{slot:"title"},slot:"title"},[t._v("表情")]),n("emoji-page",{attrs:{"emoji-list":t.curEmojiList},on:{select:t.insertText}}),n("emoji-pagination",{attrs:{"emoji-lists":t.emojiLists,"cur-pid":t.curPid},on:{select:t.switchEmojiPage}})],1)],1)])},[],!1,null,"02a80f24",null).exports);o.a.use(r.bpreportPlugin);var x=C;e.a=x},function(t,e,n){"use strict";var i,o,r,a=n(22),s=n(9),c=n.n(s),u=(n(24),n(146),n(35),n(152),n(12),n(36),n(21),n(142),n(56),n(6)),l=(n(28),n(44),["boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing"]),d=function(t,e){(i=document.getElementById(t.nodeName+"--mirror-div"))||((i=document.createElement("div")).id=t.nodeName+"--mirror-div",document.body.appendChild(i)),r=i.style,o=getComputedStyle(t),r.whiteSpace="pre-wrap","INPUT"!==t.nodeName&&(r.wordWrap="break-word"),r.position="absolute",r.top=t.offsetTop+parseInt(o.borderTopWidth)+"px",r.left=t.offsetLeft+parseInt(o.borderLeftWidth)+"px",r.visibility="hidden",l.forEach(function(t){r[t]=o[t]}),window.navigator.userAgent.indexOf("Firefox")>-1?(r.width=parseInt(o.width)-2+"px",t.scrollHeight>parseInt(o.height)&&(r.overflowY="scroll")):r.overflow="hidden",i.textContent=t.value.substring(0,e),"INPUT"===t.nodeName&&(i.textContent=i.textContent.replace(/\s/g," "));var n=document.createElement("span");return n.textContent=t.value.substring(e)||".",i.appendChild(n),{top:n.offsetTop+parseInt(o.borderTopWidth)+parseInt(o["line-height"])-t.scrollTop,left:n.offsetLeft+parseInt(o.borderLeftWidth)}},f=n(4),p=n(5),h=/[#@\s]/,m={data:function(){return{isShow:!1,top:0,left:0,selectedIndex:0,userList:[],mouseOverEnabled:!0,needHide:!1,isSafari:!1,isIE:!1}},props:{inputElm:{required:!0},buttonElm:null,validate:{type:Function,default:function(){return!0}},selectHandler:{type:Function,default:function(){}},logHandler:{type:Function,default:function(){}}},beforeMount:function(){var t=Object(u.d)();this.isIE=-1!==t.indexOf("IE"),this.isSafari=-1!==t.indexOf("Safari")},computed:{topPx:function(){return this.top+"px"},leftPx:function(){return this.left+"px"},computedHeight:function(){return this.userList.length>0?"150px":"30px"}},mounted:function(){this.initEvents(),this.throttleShowLimitToast=Object(u.f)(this.showLimitToast,300),this.debounceSearch=Object(u.b)(this.search,500),this.debounceEnableMouseOver=Object(u.b)(this.enableMouseOver,200)},methods:{onMousedown:function(t){(t||window.event).preventDefault()},onClickItem:function(t){var e=this,n=Object(f.g)(this.inputElm),i=(this.isIE?this.inputElm.value:this.inputElm.value.replace(/\n/g,"")).substring(0,n),o=i.lastIndexOf("@"),r=i.substring(o,n);this.selectHandler(t,r),this.hide(),this.userList=[],this.inputElm.focus(),"TEXTAREA"===this.inputElm.tagName&&setTimeout(function(){var n=o+t.uname.length+2;Object(f.r)(e.inputElm,n)},0)},show:function(){this.isShow?this.calculatePosition():this.validate()&&(this.inputElm.querySelectorAll(".bp-at-span").length>=10?this.throttleShowLimitToast():(this.isShow=!0,this.selectedIndex=0,this.calculatePosition()))},hide:function(){this.isShow=!1},updateView:function(){var t=Object(f.g)(this.inputElm),e=(this.isIE?this.inputElm.value:this.inputElm.value.replace(/\n/g,"")).substring(t-21,t),n=e.lastIndexOf("@");if(~n){var i=e.substring(n+1);i.match(h)?this.hide():(this.show(),""!==i&&""===String(i).trim()||i.match(h)||" "===i.substring(0,1)?this.userList=[]:this.debounceSearch(i))}else this.hide()},search:function(t){var e=this;this.bpapi({url:"".concat(p.a.API_VC,"/dynamic_repost/v1/dynamic_repost/name_search"),method:"get",data:{keyword:t}}).then(function(t){if(0===t.code){var n=Object(u.e)(t.data.content).result||[];Array.isArray(n)?e.userList=n.map(function(t){return{uname:t.uname,uid:t.mid}}):e.userList=[]}else e.userList=[]},function(){e.userList=[]})},showLimitToast:function(){this.linkMsg(this.inputElm,"最多@10人~","caution")},calculatePosition:function(){var t,e=Object(f.g)(this.inputElm),n=this.inputElm.value.substring(0,e).lastIndexOf("@");if(this.isIE||this.isSafari)t=d(this.inputElm,n),this.left=t.left,this.top=t.top;else{var i=this.inputElm.getBoundingClientRect(),o=i.top,r=i.left;t=window.getSelection().getRangeAt(0).getBoundingClientRect(),this.left=t.left-r,this.top=t.top+18-o}var a=parseFloat(getComputedStyle(this.inputElm,null).getPropertyValue("height").replace(/px/,""));(this.top>a+10||this.top<-20)&&(this.top=a+10),this.left<-20&&(this.left=0)},initEvents:function(){this.inputElm&&(this.inputElm.addEventListener("input",this.textInputHandler),this.inputElm.addEventListener("keydown",this.keyDownHandler),this.inputElm.addEventListener("keyup",this.keyUpHandler),this.inputElm.addEventListener("focus",this.focusHandler),this.inputElm.addEventListener("blur",this.blurHandler),this.inputElm.addEventListener("click",this.clickHandler),this.inputElm.addEventListener("DOMNodeInserted",this.textInputHandler)),this.buttonElm&&this.buttonElm.addEventListener("click",this.buttonClickHandler)},removeEvents:function(){this.inputElm.removeEventListener("input",this.textInputHandler),this.inputElm.removeEventListener("keydown",this.keyDownHandler),this.inputElm.removeEventListener("keyup",this.keyUpHandler),this.inputElm.removeEventListener("focus",this.focusHandler),this.inputElm.removeEventListener("blur",this.blurHandler),this.inputElm.removeEventListener("click",this.clickHandler),this.inputElm.removeEventListener("DOMNodeInserted",this.textInputHandler),this.buttonElm&&this.buttonElm.removeEventListener("click",this.buttonClickHandler)},mouseOverHandler:function(t){this.mouseOverEnabled&&(this.selectedIndex=t)},textInputHandler:function(){var t=this;setTimeout(function(){t.updateView()},0)},keyDownHandler:function(t){if(this.isShow)if(13===t.keyCode){var e=this.userList[this.selectedIndex];e&&(this.onClickItem(e),t.preventDefault())}else 38===t.keyCode?(t.preventDefault(),this.pickUp()):40===t.keyCode&&(t.preventDefault(),this.pickDown())},keyUpHandler:function(t){t.keyCode>=37&&t.keyCode<=40?this.updateView():50===t.keyCode&&!0===t.shiftKey&&this.logHandler()},blurHandler:function(){var t=this;setTimeout(function(){t.needHide&&t.hide()},300),this.needHide=!0},focusHandler:function(){setTimeout(this.updateView,0)},buttonClickHandler:function(){var t=this;this.needHide=!1,this.clickButtonHandler&&this.clickButtonHandler(),setTimeout(function(){t.clickHandler()},100)},clickHandler:function(){this.updateView()},pickUp:function(){this.selectedIndex-1>=0?this.selectedIndex--:this.selectedIndex=this.userList.length-1,this.updateListScrollTop()},pickDown:function(){this.selectedIndex+1<this.userList.length?this.selectedIndex++:this.selectedIndex=0,this.updateListScrollTop()},updateListScrollTop:function(){if(this.$refs.userList){var t=this.selectedIndex;24*t>this.$refs.userList.scrollTop+96?(this.$refs.userList.scrollTop=24*t-96,this.disableMouseOver()):24*t<this.$refs.userList.scrollTop&&(this.$refs.userList.scrollTop=24*t,this.disableMouseOver())}},disableMouseOver:function(){this.mouseOverEnabled=!1,this.debounceEnableMouseOver()},enableMouseOver:function(){this.mouseOverEnabled=!0}}},g=(n(246),n(2)),v=Object(g.a)(m,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"at-popup bg-white",style:{top:t.topPx,left:t.leftPx,height:t.computedHeight}},[n("p",{staticClass:"hint ff-yahei fs-12 tc-slate ls-0 c-default"},[t._v("选择或输入你想@的人")]),t.userList.length>0?n("div",{ref:"userList",staticClass:"user-container w-100"},t._l(t.userList,function(e,i){return n("a",{staticClass:"item ff-yahei fs-12 tc-black ls-0 d-block c-pointer",class:{"is-selected":i===t.selectedIndex},on:{mouseover:function(e){return t.mouseOverHandler(i)},click:function(n){return t.onClickItem(e)},mousedown:t.onMousedown}},[t._v(t._s(e.uname))])}),0):t._e()])},[],!1,null,"9b2294ce",null).exports;n(50);c.a.use(a.b);var b=v;e.a=b},,,,,,,,,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n(18);var i=n(63),o="undefined"!=typeof window?document.createElement("div"):null;function r(){}var a={props:{button:{default:function(){return{confirm:"确定",cancel:"取消"}}},width:{type:Number,default:500},title:{type:String,default:""},titleCenter:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},show:{type:Boolean,default:!1},onConfirm:{type:Function,default:r},onCancel:{type:Function,default:r}},components:{BpBtn:i.a},computed:{buttons:function(){return{confirmBtn:this.$refs.confirmBtn?this.$refs.confirmBtn.$el:o,cancelBtn:this.$refs.cancelBtn?this.$refs.cancelBtn.$el:o,closeBtn:this.$refs.closeBtn}}},methods:{onConfirmFunc:function(t){this.onConfirm(t,this.buttons)},onCancelFunc:function(t){this.onCancel(t,this.buttons)}}},s=(n(233),n(2)),c=Object(s.a)(a,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"scale-out","leave-active-class":"a-scale-out"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"bp-popup-panel p-relative a-move-in-top a-forwards",style:{width:t.width+"px"||!1}},[n("div",{staticClass:"title-ctnr p-relative",class:{"t-center":t.titleCenter}},[n("h2",{staticClass:"popup-title",domProps:{textContent:t._s(t.title)}})]),n("div",{staticClass:"popup-content-ctnr"},[t._t("default"),!1!==t.button?n("div",{staticClass:"popup-btn-ctnr t-center"},[!1!==t.button.confirm?n("bp-btn",{ref:"confirmBtn",staticClass:"panel-btn",attrs:{disabled:t.disabled},nativeOn:{click:function(e){return t.onConfirmFunc(e)}}},[t._v(t._s(t.button.confirm||"确定"))]):t._e(),!1!==t.button.cancel?n("bp-btn",{ref:"cancelBtn",staticClass:"panel-btn",attrs:{type:"ghost"},nativeOn:{click:function(e){return t.onCancelFunc(e)}}},[t._v(t._s(t.button.cancel||"取消"))]):t._e()],1):t._e()],2),n("div",{ref:"closeBtn",staticClass:"close-btn p-absolute bg-center bg-no-repeat pointer t-center",attrs:{role:"button",title:"关闭面板"},on:{click:t.onCancelFunc}},[n("i",{staticClass:"bp-icon-font icon-close"})])])])},[],!1,null,"3c863400",null);e.a=c.exports},,,,,,,,,,,,,,,function(t,e,n){"use strict";var i=n(6),o={name:"BackTop",data:function(){return{isShowBtn:!1,right:0,timerPid:0}},methods:{getScrollTop:function(){return document.body.scrollTop||document.documentElement.scrollTop},backtop:function(){var t=window.requestAnimationFrame||function(t){setTimeout(t,17)},e=window.cancelAnimationFrame||clearTimeout,n=document.body.scrollTop?document.body:document.documentElement,i=n.scrollTop,o=this;!function r(){o.timerPid&&e(o.timerPid),(i+=(0-i)/4)<1?n.scrollTop=0:(n.scrollTop=i,o.timerPid=t(r))}()},resize:function(){this.right=document.documentElement.clientWidth>1460?(document.documentElement.clientWidth-1460)/4:0},scroll:function(){this.isShowBtn=(document.body.scrollTop||document.documentElement.scrollTop)>(window.innerHeight||document.body.clientHeight||document.documentElement.clientHeight)}},mounted:function(){this.scrollDebounce=Object(i.b)(this.scroll,100),window.addEventListener("scroll",this.scrollDebounce,{passive:!0}),window.addEventListener("resize",this.resize),this.resize()},destroyed:function(){window.removeEventListener("scroll",this.scrollDebounce,{passive:!0}),window.removeEventListener("resize",this.resize)}},r=(n(295),n(2)),a=Object(r.a)(o,function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"rocket-fade"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:this.isShowBtn,expression:"isShowBtn"}],staticClass:"back-top",style:{right:this.right+"px"},on:{click:this.backtop}})])},[],!1,null,"37d58309",null);e.a=a.exports},,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},,,function(t,e,n){},,,function(t,e,n){"use strict";(function(t){n(15),n(13),n(32),n(28),n(35),n(33),n(34),n(73),n(74),n(48),n(49),n(12),n(31),n(21),n(30);var i=n(45),o=n(26);function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s="undefined"==typeof window?t:window,c={},u={};function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;return'<img src="'.concat(e.replace(/^http:\/\//,"//"),'" alt="').concat(t,'" style="margin: -1px 1px 0 1px;display: inline-block; width: ').concat(n.width,"px; height: ").concat(n.height,"px; vertical-align: ").concat(n.verticalAlign||"baseline",';">')}i.a.allEmojiDataNew.map(function(t){t.purl&&""!==t.purl&&t.emojis&&t.emojis.length&&t.emojis&&t.emojis.length>0&&t.emojis.forEach(function(t){u[t.name]=t.url})}),i.a.allEmojiDataOld.map(function(t){t.purl&&""!==t.purl&&t.emojis&&t.emojis.length&&t.emojis&&t.emojis.length>0&&t.emojis.forEach(function(t){c[t.name]=t.url})}),e.a=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=(arguments.length>2?arguments[2]:void 0)||s.bp_emoji_data_v3||{},u=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(n,!0).forEach(function(e){a(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},u,{},Object(o.a)(e)),n=Object.assign({width:22,height:22},n);var i,d=new RegExp(/\[[^([.*?\])]+\]/g);return i=n.emojiType&&1===n.emojiType?u:c,t.replace(d,function(t){return i[t]?l(t,i[t],n):u[t]?l(t,u[t],n):t})}}).call(this,n(136))},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return c});n(28),n(10),n(29),n(30);var i=n(22),o=n(5),r="undefined"==typeof window?t:window,a=function(t){var e={free:[],mapping:[],vip:[]};return t.forEach(function(t,n){var i=[];t.emote.forEach(function(t){i.push({id:t.id,name:t.text,url:t.url,type:t.type})}),e.free.push({emojis:i,pid:t.id,pname:t.text,purl:t.url,type:t.type})}),e};function s(t){return Object(i.a)({method:"get",url:"".concat(o.a.API_MAIN,"/x/emote/user/panel/web"),data:{business:"dynamic"},throttleInterval:5e3,localCache:!0,ttl:9e5,cache_key:"emoji_big"}).then(function(e){var n=a(e.data.packages||[]);r.localStorage&&r.localStorage.setItem("bp_emoji_data_v3",JSON.stringify(n)),r.bp_emoji_data_v3=n,t&&t(n)}).catch(function(e){r.bp_emoji_data_v3||(r.bp_emoji_data_v3={}),t&&t({})})}function c(){return new Promise(function(t){var e=r.localStorage?r.localStorage.getItem("bp_emoji_data_v3"):"{}";e?(r.bp_emoji_data_v3=JSON.parse(e),s(),t(r.bp_emoji_data_v3)):s(t)})}}).call(this,n(136))},function(t,e,n){"use strict";(function(t){n(15),n(13),n(32),n(28),n(35),n(33),n(34),n(73),n(74),n(48),n(49),n(12),n(31),n(21),n(212),n(30);var i=n(9),o=n.n(i),r=n(45),a=n(26);function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(n,!0).forEach(function(e){u(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var l="undefined"==typeof window?t:window,d={},f={};r.a.allEmojiDataNew.map(function(t){t.purl&&""!==t.purl&&t.emojis&&t.emojis.length&&t.emojis&&t.emojis.length>0&&t.emojis.forEach(function(t){f[t.name]=t.url})}),r.a.allEmojiDataOld.map(function(t){t.purl&&""!==t.purl&&t.emojis&&t.emojis.length&&t.emojis&&t.emojis.length>0&&t.emojis.forEach(function(t){d[t.name]=t.url})}),e.a=o.a.component("renderJSX",{methods:{generateImageTag:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,i=this.$createElement;return i("img",{attrs:{src:e.replace(/^http:\/\//,"//"),contenteditable:"false",alt:t},style:"margin: -1px 1px 0 1px;display: inline-block; width: ".concat(n.width,"px; height: ").concat(n.height,"px; vertical-align: ").concat(n.verticalAlign||"baseline",";")})},renderEmoji:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=[],o={};o=n||l.bp_emoji_data_v3||{},f=c({},f,{},Object(a.a)(o));var r={width:22,height:22};e=Object.assign(r,e);var s,u=new RegExp(/\[[^([.*?\])]+\]/g);s=e.emojiType&&1===e.emojiType?f:d;var p=!0,h=0;do{var m=u.exec(t);if(m){if(m.index===h)i.push(this.pushItemCb(m,i,s,e));else{var g=t.substring(h,m.index);g&&i.push(g),i.push(this.pushItemCb(m,i,s,e))}h=u.lastIndex}else{var v=t.substring(h);v&&i.push(v),p=!1}}while(p);return i},pushItemCb:function(t,e,n,i){var o=t[0]||"";e.push(n[o]?this.generateImageTag(o,n[o],i):f[o]?this.generateImageTag(o,f[o],i):o)}}})}).call(this,n(136))},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABOSURBVChTY9j65PN/mdW3/zMsvIYXg9SA1DKAGIdffv1PCIDUgA0G6SYWgG0DEcxEYrgGYgFlGqy3PwBjfGzKNBADyNNAcsSRljQ+/wcAjBTh4g09x4UAAAAASUVORK5CYII="},function(t,e,n){"use strict";var i=n(9),o=n.n(i),r=n(37),a=n(42),s=n(22),c=(n(76),n(53),n(50),n(247),n(15),n(19),n(20),n(13),n(24),n(14),n(18),n(25),n(23),n(10),n(17),n(16),n(3)),u=n(1),l=n(4),d=(n(35),n(41),n(12),n(21),n(26));function f(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var p=function(t){var e="";if(!t)return e;switch(t.nodeName){case"IMG":e=t.alt||"";break;case"INPUT":e=t.value||"";break;case"A":var n=t.getAttribute("alt");e=n||(t.textContent||"");break;default:e=t.textContent||""}return e},h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.div=e}var e,n,i;return e=t,(n=[{key:"getRange",value:function(){var t=window.getSelection();if(t&&!(t.rangeCount<1))return t.getRangeAt(t.rangeCount-1)}},{key:"getTextOffset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.getRange();if(!e)return 0;var n=t?e.startContainer:e.endContainer,i=t?e.startOffset:e.endOffset,o=0;if(n===this.div){var r=0,a=!0,s=!1,c=void 0;try{for(var u,l=this.div.childNodes[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var d=u.value,f=p(d).length;if(!(r<i))return o>0?o-1:0;o+=f,r+=1}}catch(t){s=!0,c=t}finally{try{a||null==l.return||l.return()}finally{if(s)throw c}}return o>0?o-1:0}var h=!0,m=!1,g=void 0;try{for(var v,b=this.div.childNodes[Symbol.iterator]();!(h=(v=b.next()).done);h=!0){var y=v.value;if(y===n||y.firstChild===n)return(o+=i)>0?o-1:0;o+=p(y).length}}catch(t){m=!0,g=t}finally{try{h||null==b.return||b.return()}finally{if(m)throw g}}return o>0?o-1:0}},{key:"setCaret",value:function(t){var e=t+1;try{var n=window.getSelection();if(!n)return;for(var i=0,o=0;o<this.div.childNodes.length;o++){var r=this.div.childNodes[o],a=p(r).length;if(!(a<e-i)){if(a===e-i){n.collapse(this.div,o+1);break}1===r.nodeType?r.firstChild&&r.firstChild.getAttribute&&"false"!==r.firstChild.getAttribute("contenteditable")?n.collapse(r.firstChild,e-i):e-i==0?n.collapse(this.div,o):n.collapse(this.div,o+1):n.collapse(r,e-i);break}i+=a}}catch(t){}}}])&&f(e.prototype,n),i&&f(e,i),t}(),m=(n(28),n(29),n(30),n(6)),g=n(38),v=n(195),b=n(5),y=o.a.component("renderHTML",{mixins:[v.a],props:{bus:{type:Object}},methods:{onVoteClick:function(){this.bus.$emit("vote-item-click")},onLotteryClick:function(){this.bus.$emit("lottery-item-click")},renderHTML:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(i){Object(d.b)().then(function(o){i(t.renderHTMLSync(e,n,o))}).catch(function(n){console.error(n),i(t.renderHTMLSync(e,void 0,null,!0))})})},renderHTMLSync:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,r=this.$createElement,a=[];if(o)return e.forEach(function(t){a.push(t.url||t.text||t.id)}),a;var s=n.verticalAlign,c=void 0===s?"text-bottom":s,u=n.width,l=void 0===u?20:u,d=n.height,f=void 0===d?20:d,p=n.extendCtrlJson,h=void 0===p?"":p,v=0,y=Object(m.e)(h).from;return y&&(v=y.emoji_type),e.forEach(function(e){var n="",o="",s=e.url||e.text||e.id||"";switch(e.type){case g.a.TYPE_STRING:a.push(t.renderEmoji(s,{width:l,height:f,verticalAlign:c,emojiType:v},i));break;case g.a.TYPE_LOTTERY:o=e.text,a.push(r("span",{class:"dynamic-link-hover-bg",on:{click:t.onLotteryClick},attrs:{contenteditable:"false"},style:"cursor:pointer;color:#00a1d6;"},[r("i",{class:"bp-svg-icon lottery-btn",attrs:{contenteditable:"false"},style:"position:relative;top:-2px;margin-left:2px;margin-right:2px;"}),o]));break;case g.a.TYPE_VOTE:o=e.text,a.push(r("span",{class:"dynamic-link-hover-bg",on:{click:t.onVoteClick},attrs:{contenteditable:"false"},style:"cursor:pointer;color:#00a1d6;"},[r("i",{class:"bp-svg-icon vote-btn",attrs:{contenteditable:"false"},style:"position:relative;top:-1px;margin-left:2px;margin-right:2px;"}),o]));break;case g.a.TYPE_AT:n="".concat(b.a.SPACE,"/").concat(e.id,"/dynamic"),a.push(r("a",{attrs:{href:n,target:"_blank",contenteditable:"false"},class:"dynamic-link-hover-bg",style:"cursor:pointer;color:#00a1d6;"},[s]));break;case g.a.TYPE_LINK_AV:case g.a.TYPE_LINK_BV:a.push(r("a",{attrs:{href:"".concat(b.a.MAIN,"/video/").concat(e.id),target:"_blank",contenteditable:"false"},class:"dynamic-link-hover-bg",style:"cursor:pointer;color:#00a1d6;"},[s]));break;case g.a.TYPE_LINK_CV:a.push(r("a",{attrs:{href:"".concat(b.a.MAIN,"/read/").concat(e.id),target:"_blank",contenteditable:"false"},class:"dynamic-link-hover-bg",style:"cursor:pointer;color:#00a1d6;"},[s]));break;case g.a.TYPE_LINK_VC:a.push(r("a",{attrs:{href:"".concat(b.a.VC,"/video/").concat(e.id),target:"_blank",contenteditable:"false"},class:"dynamic-link-hover-bg",style:"cursor:pointer;color:#00a1d6;"},[s]));break;default:a.push(s)}}),a}}}),_=o.a.component("CoreEditor",{props:{value:{type:String,default:function(){return""}},bus:{type:Object},pasteHandler:{type:Function},extendCtrlJson:{type:String,default:function(){return"{}"}}},mixins:[y],data:function(){return{textContent:this.value,domText:this.value,caretStart:0,caretPos:0,cm:void 0,recordStack:[],recordLen:0,ris:[],componsionSelection:{start:0,end:0,ok:!1}}},computed:{text:{get:function(){return this.textContent.replace(/\r\n|\r/g,"\n").replace(/\n{2,}/g,"\n\n").replace(/^\n+/,"").replace(/^ +/,"")},set:function(t){this.textContent=t}}},watch:{text:function(t,e){t!==e&&(this.record(),this.emitTextUpdate(),this.emitDomTextUpdate(),this.updateRis())},extendCtrlJson:function(t,e){t!==e&&this.updateRis()},value:function(t){this.text!==t&&(this.text=t)},caretPos:function(t){this.bus.$emit("caret-change",t)}},render:function(){var t=arguments[0];return t("div",{ref:"editor",attrs:{id:"editor"}},["‍",this.ris.map(function(t){return t||""}),"\n"])},created:function(){this.initBus()},mounted:function(){var t=this.$refs.editor;t.contentEditable="true",/MSIE |Trident/.test(window.navigator.userAgent)&&document.execCommand("AutoUrlDetect",!1,!1),this.cm=new h(t),this.cm.setCaret(this.text.length),this.recordStack=[],this.recordLen=0,this.record(),t.addEventListener("keypress",this.onKeypress),t.addEventListener("keydown",this.onKeydown),t.addEventListener("cut",this.onCut),t.addEventListener("paste",this.onPaste),t.addEventListener("compositionstart",this.onCompositionstart),t.addEventListener("compositionupdate",function(t){return t.preventDefault()}),t.addEventListener("compositionend",this.onCompositionend),t.addEventListener("input",this.onInput),t.addEventListener("dragstart",function(t){return t.preventDefault()}),t.addEventListener("drop",function(t){return t.preventDefault()}),t.value="",this.bus.$emit("editor-dom-change",t),this.updateRis()},updated:function(){this.cm.setCaret(this.caretPos),this.fixSafariShadowText(),this.scrollIntoView()},methods:{initBus:function(){this.bus.$on("delete",this.deleteText),this.bus.$on("insert",this.insertText),this.bus.$on("replace",this.replaceText),this.bus.$on("reset",this.onReset),this.bus.$on("text-update",this.onTextUpdate)},updateRis:function(){var t=this,e={extendCtrlJson:this.extendCtrlJson};Object(l.p)(this.text,e).then(function(n){t.renderHTML(n,e).then(function(e){t.ris=e,t.$nextTick(t.emitDomTextUpdate)})})},emitTextUpdate:function(){this.bus.$emit("text-update",this.text);var t=this.$refs.editor;t.value="‍".concat(this.text),t.dispatchEvent(new CustomEvent("input"))},emitDomTextUpdate:function(){this.$emit("dom-update",{text:p(this.$refs.editor).replace(/\n+$/g,"").replace("‍","")})},onReset:function(){this.text="",this.recordStack=[],this.recordLen=0},onTextUpdate:function(t){this.text=t},record:function(){this.recordLen<this.recordStack.length+1&&this.recordStack.push({text:this.text,textOffset:this.caretPos}),this.recordLen=this.recordStack.length},onKeypress:function(t){if(!(t.ctrlKey||t.altKey||t.metaKey||t.isComposing||0===t.charCode)){var e=t.key;switch(e){case"Spacebar":e=" ";break;case"Esc":e="Escape"}t.preventDefault(),t.stopPropagation();var n,i=this.cm.getTextOffset(!0),o=this.cm.getTextOffset();if("Enter"===e)n=this.text.slice(0,i)+"\n"+this.text.slice(o);else{var r=t.keyCode?String.fromCharCode(t.keyCode):e;n=this.text.slice(0,i)+r+this.text.slice(o)}this.caretPos=i+1,this.text=n}},onKeydown:function(t){if((t.ctrlKey||t.metaKey)&&"z"===t.key){if(t.preventDefault(),this.recordStack.length<=1)return;this.recordStack.pop();var e=this.recordStack[this.recordStack.length-1];this.caretPos=e.textOffset||e.text.length,this.text=e.text}t.isComposing||"Delete"!==t.key||(t.preventDefault(),this.backspaceDelete(!0)),t.isComposing||"Backspace"!==t.key||(t.preventDefault(),this.backspaceDelete(!1))},backspaceDelete:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.cm.getTextOffset(!0),i=this.cm.getTextOffset(),o=this.cm.getRange();if(o){n>this.text.length&&(n=this.text.length),i>this.text.length&&(i=this.text.length);var r=function(n,i){var o=p(n).length;if(e){if(i+o>t.text.length)return;var r=t.text.slice(0,i)+t.text.slice(i+o);t.caretPos=i,t.text=r}else{if(i-o<0)return;var a=t.text.slice(0,i-o)+t.text.slice(i);t.caretPos=i-o,t.text=a}},a=function(){if(e){if(i>=t.text.length)return;var o=t.text.slice(0,i)+t.text.slice(i+1);t.caretPos=n,t.text=o}else{if(i<1)return;var r=t.text.slice(0,i-1)+t.text.slice(i);t.caretPos=i-1,t.text=r}};if(n!==i){var s=this.text.slice(0,n)+this.text.slice(i);this.caretPos=n,this.text=s}else if(i>0)if(o.endContainer===this.$refs.editor){var c=this.$refs.editor.childNodes[e?0:o.endOffset-1];1===c.nodeType?r(c,i):a()}else{var u=o.endContainer,l=u.previousSibling,d=u.nextSibling;u.parentNode!==this.$refs.editor&&(!e&&o.endOffset===p(u).length||e&&o.startOffset===p(u).length)?r(u.parentNode,e?n:i):!e&&l&&1===l.nodeType&&0===o.endOffset?r(l,i):e&&d&&1===d.nodeType&&0===o.startOffset?r(d,n):a()}else a()}},deleteText:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=this.cm.getTextOffset(!0),i=this.cm.getTextOffset();n>this.text.length&&(n=this.text.length),i>this.text.length&&(i=this.text.length),t=e>0?this.text.slice(0,n-e)+this.text.slice(i):this.text.slice(0,n)+this.text.slice(i-e),this.caretPos=n-e,this.text=t},onInput:function(t){if(t.preventDefault(),"insertText"===t.inputType&&!t.isComposing){var e=this.cm.getTextOffset(!0)-t.data.length,n=this.cm.getTextOffset()-t.data.length,i=this.text.slice(0,e)+t.data+this.text.slice(n);this.caretPos=e+t.data.length,this.text=i}this.emitDomTextUpdate()},onCompositionstart:function(){var t=this.cm.getTextOffset(!0),e=this.cm.getTextOffset();this.componsionSelection.start=t,this.componsionSelection.end=e,this.componsionSelection.ok=!0},onCompositionend:function(t){t.preventDefault();var e=this.componsionSelection.ok?this.componsionSelection.start:this.cm.getTextOffset(!0)-t.data.length,n=this.componsionSelection.ok?this.componsionSelection.end:this.cm.getTextOffset()-t.data.length;this.componsionSelection.ok=!1;var i=this.text.slice(0,e)+t.data+this.text.slice(n);this.caretPos=e+t.data.length,this.text=i},onCut:function(t){t.stopPropagation(),t.preventDefault();var e=t.clipboardData||window.clipboardData,n=this.cm.getTextOffset(!0),i=this.cm.getTextOffset();e.setData("text/plain",this.text.slice(n,i));var o=this.text.slice(0,n)+this.text.slice(i);this.caretPos=n,this.text=o},onPaste:function(t){if(this.pasteHandler&&"function"==typeof this.pasteHandler)this.pasteHandler(t,this.insertText);else{t.stopPropagation(),t.preventDefault();var e=t.clipboardData||window.clipboardData,n="".concat(e.getData("Text")," ").replace(/ +$/," ");this.insertText(Object(d.c)(n))}},insertText:function(t){var e=this.cm.getTextOffset(!0),n=this.cm.getTextOffset(),i=this.text.slice(0,e)+t+this.text.slice(n);this.caretPos=e+t.length,this.text=i},replaceText:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{oldStr:"",newStr:""},e=t.oldStr,n=t.newStr,i=this.text.replace(e,n);this.caretPos=0,this.text=i},fixSafariShadowText:function(){var t=this.$refs.editor.childNodes;if(!(t.length<2)){var e=t[t.length-1],n=t[t.length-2];3===e.nodeType&&3===n.nodeType&&e.nodeValue&&n.nodeValue&&e.parentNode.removeChild(e)}},scrollIntoView:function(){var t=this.cm.getRange();if(t){var e=t.getBoundingClientRect().top,n=this.$refs.editor,i=n.getBoundingClientRect().top,o=n.getBoundingClientRect().bottom;(e<i||e>o)&&(n.scrollTop=e-i)}}}});function w(t){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function C(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function x(t,e){return!e||"object"!==w(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function I(t){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function k(t,e){return(k=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var S=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=x(this,I(e).apply(this,arguments))).text="",t.domText="",t.extendCtrlJson=JSON.stringify({from:{emoji_type:1}}),t}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(e,u["c"]),n=e,(i=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.initBus()}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("text-update",function(e){t.text=e}),this.bus.$on("extend-json-changed",function(e){t.extendCtrlJson=e})}},{key:"onDomUpdate",value:function(t){var e=t.text;this.domText=e}},{key:"showPlaceholder",get:function(){return!this.domText.length&&!this.text.length}},{key:"textLength",get:function(){return Object(l.i)(this.text)}}])&&C(n.prototype,i),o&&C(n,o),e}();c.a([Object(u.b)({type:String,default:function(){return"有什么想和大家分享的？"}})],S.prototype,"placeholder",void 0),c.a([Object(u.b)()],S.prototype,"bus",void 0),c.a([Object(u.b)(Function)],S.prototype,"pasteHandler",void 0),c.a([Object(u.b)()],S.prototype,"withScheduleBar",void 0),c.a([Object(u.b)({type:Number,default:function(){return 1e3}})],S.prototype,"maxLength",void 0),c.a([Object(u.b)({type:String,default:function(){return""}})],S.prototype,"editorStyle",void 0),c.a([Object(u.b)(Boolean)],S.prototype,"isPopupPanel",void 0);var O=S=c.a([Object(u.a)({name:"editor",components:{CoreEditor:_}})],S),P=(n(248),n(2)),T=Object(P.a)(O,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor",class:{"placeholder-shown":t.showPlaceholder},attrs:{placeholder:t.placeholder}},[n("core-editor",{staticClass:"core-style",class:{"with-schedule-bar":t.withScheduleBar,"too-long":t.textLength>t.maxLength,"in-popup":t.isPopupPanel},style:t.editorStyle,attrs:{bus:t.bus,"paste-handler":t.pasteHandler,"extend-ctrl-json":t.extendCtrlJson},on:{"dom-update":t.onDomUpdate}})],1)},[],!1,null,"5cfa03f0",null).exports;n(27),n(75),n(149),n(47),n(143),n(31),n(57);function E(t){var e=t.path||t.composedPath&&t.composedPath();if(!e){e=[];for(var n=t.target;n!==document;)e.unshift(n),n=n.parentNode}return e}var j=n(196),L=n.n(j);function A(t,e,n){return(A=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&D(o,n.prototype),o}).apply(null,arguments)}function D(t,e){return(D=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function M(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var N={props:{date:{type:Date},min:{type:Date,required:!1},max:{type:Date,required:!1}},data:function(){return{weekDays:["日","一","二","三","四","五","六"],year:NaN,month:NaN,day:NaN,inputText:this.getFormatedDate(this.date),panelVisible:!1,dateIcon:L.a}},computed:{monthDays:function(){var t=new Date(this.year,this.month+1,0).getDate(),e=new Date(this.year,this.month);e.setDate(0);var n=e.getDay(),i=[];if(6!==n)for(var o=n;o>=0;o--)i.push(" ");for(var r=1;r<=t;r++)i.push(r);return i}},watch:{date:function(t){this.inputText=this.getFormatedDate(t)}},created:function(){var t=this.date;t||(t=new Date),this.year=t.getFullYear(),this.month=t.getMonth(),this.day=t.getDate()},methods:{commit:function(t){this.min&&t<this.min?this.$emit("change",new Date(this.min)):this.max&&t>this.max?this.$emit("change",new Date(this.max)):this.$emit("change",t)},setDate:function(t){if(!this.isDisabled(t)){this.day=t;var e=new Date(this.year,this.month,t);this.inputText=this.getFormatedDate(e),this.panelVisible=!1,this.$refs.dateInput.firstChild.blur(),this.commit(e)}},changeMonth:function(t){this.month+t<0?(this.year-=1,this.month=12+this.month+t):this.month+t>11?(this.year+=1,this.month=this.month+t-12):this.month+=t},isSelected:function(t){return this.date&&this.year===this.date.getFullYear()&&this.month===this.date.getMonth()&&t===this.date.getDate()},isDisabled:function(t){return!(!this.min&&!this.max)&&(!(!this.min||!(this.min.getFullYear()>this.year||this.min.getFullYear()===this.year&&this.min.getMonth()>this.month||this.min.getFullYear()===this.year&&this.min.getMonth()===this.month&&this.min.getDate()>t))||!(!this.max||!(this.max.getFullYear()<this.year||this.max.getFullYear()===this.year&&this.max.getMonth()<this.month||this.max.getFullYear()===this.year&&this.max.getMonth()===this.month&&this.max.getDate()<t)))},handleBulr:function(){var t=this.inputText.split("-").slice(0,3);t[1]-=1;var e=A(Date,M(t));Number.isNaN(e.getTime())||this.date&&e.getTime()===this.date.getTime()?this.inputText=this.getFormatedDate(this.date):this.commit(e)},handleEnter:function(t){"Enter"===t.key&&t.target.blur()},showPanel:function(t){var e=this,n=E(t);n.some(function(t){return t===e.$refs.dateInput})&&!n.some(function(t){return t===e.$refs.datePanel})&&!1===this.panelVisible&&(this.panelVisible=!0,this.closeHandler=this.handleClickOutside(this.$refs.dateInput),window.addEventListener("click",this.closeHandler))},handleClickOutside:function(t){var e=this;return function(n){E(n).some(function(e){return e===t})||(e.panelVisible=!1,window.removeEventListener("click",e.closeHandler),e.closeHandler=void 0)}},getFormatedDate:function(t){if(t&&!Number.isNaN(t.getTime())){var e=t.getFullYear(),n=t.getMonth()+1,i=t.getDate();return"".concat(e,"-").concat(n,"-").concat(i)}return""}}},R=(n(249),Object(P.a)(N,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"dateInput",staticClass:"date-input",on:{click:t.showPanel}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.inputText,expression:"inputText"}],class:{active:t.panelVisible},attrs:{placeholder:"选择日期"},domProps:{value:t.inputText},on:{blur:t.handleBulr,keyup:t.handleEnter,input:function(e){e.target.composing||(t.inputText=e.target.value)}}}),n("img",{attrs:{src:t.dateIcon}}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.panelVisible,expression:"panelVisible"}],ref:"datePanel",staticClass:"date-panel"},[n("div",{staticClass:"ym"},[n("button",{on:{click:function(e){return t.changeMonth(-1)}}},[n("span",{staticClass:"arrow left"})]),n("span",[t._v(t._s(t.year+"年 "+(t.month+1)+"月"))]),n("button",{on:{click:function(e){return t.changeMonth(1)}}},[n("span",{staticClass:"arrow right"})])]),n("div",{staticClass:"md"},[n("div",{staticClass:"week"},t._l(t.weekDays,function(e){return n("span",{key:e,domProps:{textContent:t._s(e)}})}),0),n("div",{staticClass:"days"},t._l(t.monthDays,function(e,i){return n("div",{key:i,staticClass:"day",class:{active:t.isSelected(e),disabled:t.isDisabled(e)},domProps:{textContent:t._s(e)},on:{click:function(n){return t.setDate(e)}}})}),0)])])])},[],!1,null,"c2aeee6e",null).exports),B=(n(44),{model:{prop:"value",event:"change"},props:{value:{type:Number},label:{type:String,default:"时"},min:{type:Number,default:0},max:{type:Number,default:23}},data:function(){return{currentValue:this.value,panelVisible:!1}},computed:{isActive:function(){return this.panelVisible||this.$refs.sInput&&this.$refs.sInput===document.activeElement},range:function(){for(var t=[],e=this.min;e<=this.max;e++)t.push(e);return t},scrollBarLength:function(){return"".concat(32400/(30*this.range.length),"px")}},watch:{value:function(t){t!==this.currentValue&&(this.currentValue=t)},currentValue:function(t,e){this.commit()}},methods:{showPanel:function(t){var e=this,n=E(t);n.some(function(t){return t===e.$refs.sInput})&&!n.some(function(t){return t===e.$refs.sPanel})&&!1===this.panelVisible&&(this.panelVisible=!0,this.closeHandler=this.handleClickOutside(this.$refs.sInput),window.addEventListener("click",this.closeHandler))},select:function(t){this.panelVisible=!1,this.currentValue=t,this.commit()},handleBlur:function(t){this.handleChange(t),this.commit()},handleEnter:function(t){"Enter"===t.key&&this.$refs.sInput.firstChild.blur()},handleChange:function(t){var e=parseInt(t.target.value);e!==this.currentValue&&(Number.isNaN(e)?t.target.value=void 0===this.value?null:this.value:this.currentValue=e)},commit:function(){if(this.isActive||(this.panelVisible=!1),this.currentValue<this.min)throw new Error("value ".concat(this.currentValue," lt min ").concat(this.min));if(this.currentValue>this.max)throw new Error("value ".concat(this.currentValue," gt max ").concat(this.max));this.value!==this.currentValue&&this.$emit("change",this.currentValue)},handleClickOutside:function(t){var e=this;return function(n){E(n).some(function(e){return e===t})||(e.panelVisible=!1,window.removeEventListener("click",e.closeHandler),e.closeHandler=void 0)}}}}),U=(n(250),{name:"DatePicker",components:{DateInput:R,ScrollInput:Object(P.a)(B,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"sInput",staticClass:"scroll-input",class:{active:t.isActive}},[n("input",{staticClass:"s-input",attrs:{type:"number"},domProps:{value:t.currentValue},on:{click:t.showPanel,blur:t.handleBlur,keyup:t.handleEnter,change:t.handleChange}}),n("span",{staticClass:"arrow-down",class:{active:t.panelVisible}}),n("span",{staticClass:"s-label",domProps:{textContent:t._s(t.label)}}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.panelVisible,expression:"panelVisible"}],ref:"sPanel",staticClass:"s-panel"},t._l(t.range,function(e){return n("div",{key:e,staticClass:"s-item",class:{active:e===t.value},domProps:{textContent:t._s(e)},on:{click:function(n){return t.select(e)}}})}),0)])},[],!1,null,"4ea87ec1",null).exports},props:{value:{type:[Date,String],required:!1},min:{type:Date,required:!1},max:{type:Date,required:!1},withTime:{type:Boolean,default:!0}},data:function(){return{date:void 0,hour:void 0,minute:void 0,minHour:0,maxHour:23,minMinute:0,maxMinute:59}},watch:{value:function(t){t?(this.checkLimit(t),this.date=t,this.hour=this.date.getHours(),this.minute=this.date.getMinutes()):(this.date=void 0,this.hour=void 0,this.minute=void 0),this.computeLimit()}},created:function(){this.value&&(this.checkLimit(this.value),this.date=new Date(this.value),this.hour=this.date.getHours(),this.minute=this.date.getMinutes(),this.computeLimit())},methods:{commit:function(){if(void 0!==this.date&&!Number.isNaN(this.date.getTime())){var t,e=this.date.getFullYear(),n=this.date.getMonth(),i=this.date.getDate();if(this.withTime){if(void 0===this.hour||Number.isNaN(this.hour)||void 0===this.minute||Number.isNaN(this.minute))return;t=new Date(e,n,i,this.hour,this.minute)}else t=new Date(e,n,i,0,0);this.checkLimit(t),(!this.value||Math.abs(new Date(this.value).getTime()-t.getTime())/6e4>=.1)&&this.$emit("input",new Date(t))}},computeLimit:function(){if(this.min&&this.date&&this.min.getFullYear()===this.date.getFullYear()&&this.min.getMonth()===this.date.getMonth()&&this.min.getDate()===this.date.getDate()){var t=this.min.getHours();this.hour<t&&(this.hour=t),this.minHour=t}else this.minHour=0;if(this.max&&this.date&&this.max.getFullYear()===this.date.getFullYear()&&this.max.getMonth()===this.date.getMonth()&&this.max.getDate()===this.date.getDate()){var e=this.max.getHours();this.hour>e&&(this.hour=e),this.maxHour=e}else this.maxHour=23;if(this.min&&this.min.getDate()===(this.date&&this.date.getDate())&&this.min.getHours()===this.hour){var n=this.min.getMinutes();this.minute<n&&(this.minute=n),this.minMinute=n}else this.minMinute=0;if(this.max&&this.max.getDate()===(this.date&&this.date.getDate())&&this.max.getHours()===this.hour){var i=this.max.getMinutes();this.minute>i&&(this.minute=i),this.maxMinute=i}else this.maxMinute=59},handleDateChange:function(t){this.date=t,this.computeLimit(),this.commit()},handleHourChange:function(t){this.hour=t,this.computeLimit(),this.commit()},handleMinuteChange:function(t){this.minute=t,this.computeLimit(),this.commit()},checkLimit:function(t){if(this.min&&(this.min.setSeconds(0),this.min.setMilliseconds(0),t<this.min))throw new Error("DatePicker: value ".concat(t," less then min limit ").concat(this.min));if(this.max&&(this.max.setSeconds(59),this.max.setMilliseconds(999),t>this.max))throw new Error("DatePicker: value ".concat(t," greater then max limit ").concat(this.max))}}}),H=(n(251),Object(P.a)(U,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"date-picker"},[n("DateInput",{attrs:{date:t.date,min:t.min,max:t.max},on:{change:t.handleDateChange}}),t.withTime?n("ScrollInput",{attrs:{value:t.hour,label:"时",min:t.minHour,max:t.maxHour},on:{change:t.handleHourChange}}):t._e(),t.withTime?n("ScrollInput",{attrs:{value:t.minute,label:"分",min:t.minMinute,max:t.maxMinute},on:{change:t.handleMinuteChange}}):t._e()],1)},[],!1,null,"8e11382e",null).exports),$=o.a.component("DatePicker",H);function F(t){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function V(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function z(t,e){return!e||"object"!==F(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function G(t){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function J(t,e){return(J=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var W=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=z(this,G(e).apply(this,arguments))).publishTime=new Date,t.currentTime=Date.now(),t.updateTimeInterval=0,t}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&J(t,e)}(e,u["c"]),n=e,(i=[{key:"onPublishTimeChange",value:function(t){this.bus.$emit("schedule-time-update",t)}},{key:"beforeCreate",value:function(){}},{key:"created",value:function(){var t=this;this.initBus(),this.updateTimeInterval=setInterval(function(){t.currentTime=Date.now()},6e4)}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){clearInterval(this.updateTimeInterval)}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("schedule-time-update",function(e){e&&t.publishTime&&e.getTime()!==t.publishTime.getTime()&&(t.publishTime=e)})}}])&&V(n.prototype,i),o&&V(n,o),e}();c.a([Object(u.b)()],W.prototype,"bus",void 0),c.a([Object(u.d)("publishTime")],W.prototype,"onPublishTimeChange",null);var K=W=c.a([Object(u.a)({name:"schedule-bar",components:{DatePicker:$}})],W),Y=(n(252),Object(P.a)(K,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"transition-box"},[n("div",{staticClass:"schedule-bar"},[n("span",{staticClass:"dp-label"},[t._v("发布时间：")]),n("date-picker",{attrs:{min:new Date(t.currentTime),max:new Date(t.currentTime+1296e6)},model:{value:t.publishTime,callback:function(e){t.publishTime=e},expression:"publishTime"}})],1)])},[],!1,null,"af5aaec4",null).exports),q=n(67);function Q(t){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function X(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Z(t,e){return!e||"object"!==Q(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tt(t){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function et(t,e){return(et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Z(this,tt(e).apply(this,arguments))).field=null,t.topicName="",t.emojiBoxShown=!1,t}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&et(t,e)}(e,u["c"]),n=e,(i=[{key:"onEmojiBoxShownChange",value:function(t){this.$emit("showUpdate",t)}},{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.initBus()}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("editor-dom-change",function(e){t.inputElement=e})}},{key:"triggerEmojiShow",value:function(){this.emojiBoxShown=!this.emojiBoxShown,this.emojiBoxShown&&this.inputElement.focus()}},{key:"emojiSelectHandler",value:function(t){this.bus.$emit("insert",t)}},{key:"onEmojiBoxClose",value:function(){this.emojiBoxShown=!1,this.inputElement.focus()}},{key:"frozenElements",get:function(){return[this.inputElement,this.$refs.btn]}}])&&X(n.prototype,i),o&&X(n,o),e}();c.a([Object(u.b)()],nt.prototype,"bus",void 0),c.a([Object(u.b)()],nt.prototype,"loginUid",void 0),c.a([Object(u.b)(Boolean)],nt.prototype,"isPopupPanel",void 0),c.a([Object(u.b)(Boolean)],nt.prototype,"revert",void 0),c.a([Object(u.d)("emojiBoxShown")],nt.prototype,"onEmojiBoxShownChange",null);var it=nt=c.a([Object(u.a)({name:"emoji",components:{EmojiBox:q.a}})],nt),ot=(n(253),Object(P.a)(it,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bp-emoji-box-container"},[n("button",{ref:"btn",staticClass:"emoji-btn d-i-block bp-v-middle bp-icon-font icon-emoji-btn box-toggle",class:{active:t.emojiBoxShown},attrs:{title:"表情"},on:{click:t.triggerEmojiShow}}),t.emojiBoxShown?n("emoji-box",{staticClass:"bp-emoji-box",attrs:{revert:t.revert,field:t.field,"select-handler":t.emojiSelectHandler,"frozen-elements":t.frozenElements,"emoji-type":["kaomojis","dynamicEmojis"],"spm-type":t.topicName?"TAG":"MAIN","pub-type":t.isPopupPanel?"2":"1"},on:{close:t.onEmojiBoxClose}}):t._e()],1)},[],!1,null,"24b8ccaa",null).exports),rt=(n(32),{props:{arrow:{type:Boolean,default:!1},width:{type:Number,default:300}},data:function(){return{}},methods:{onClose:function(t){this.$emit("close"),t.stopPropagation()}}}),at=(n(254),Object(P.a)(rt,function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"move-in"}},[e("div",{staticClass:"static-popup",class:{"bp-arrow":this.arrow},style:{width:this.width+"px"}},[e("div",{staticClass:"bp-icon-font icon-group-dynamic close-btn",attrs:{title:"放弃图片上传"},on:{click:this.onClose}}),e("div",{staticClass:"title"},[this._t("title")],2),e("div",{staticClass:"content-ctnr"},[this._t("default")],2)])])},[],!1,null,"268b12ee",null).exports),st=(n(59),n(65),n(8)),ct={data:function(){return{isShow:!0}},props:{status:{type:String,default:""},errorText:{type:String,default:""},imgUrl:{type:String,default:""}},computed:{bgImg:function(){var t=Object(m.g)(Object(st.a)(this.imgUrl,80,80,{e:1,c:1}));return/\.gif$/.test(t)&&(t+="@1s.jpg"),t}}},ut=(n(255),Object(P.a)(ct,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"upload-status"},["loading"===t.status?n("div",{staticClass:"loading-wrapper"},[n("span",{staticClass:"loading"})]):t._e(),"error"===t.status?n("div",{staticClass:"error-wrapper b-box"},[n("span",{staticClass:"bp-svg-icon error"}),n("span",{staticClass:"reason",domProps:{textContent:t._s(t.errorText)}})]):t._e(),t.imgUrl?n("div",{staticClass:"success-wrapper bg-center bg-cover",style:{backgroundImage:"url("+t.bgImg+")"}}):t._e(),t._t("editBtn"),t._t("close")],2)},[],!1,null,"29129d22",null).exports),lt=n(145),dt=n.n(lt),ft=(n(214),n(215),n(11)),pt=n.n(ft);n(40);function ht(t,e,n,i,o,r,a){try{var s=t[r](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}function mt(t){return new Promise(function(e){var n=new FileReader;n.onload=function(t){var n=new DataView(t.target.result);65496!==n.getUint16(0,!1)&&e(-2);for(var i=n.byteLength,o=2;o<i;){n.getUint16(o+2,!1)<=8&&e(-1);var r=n.getUint16(o,!1);if(o+=2,65505===r){1165519206!==n.getUint32(o+=2,!1)&&e(-1);var a=18761===n.getUint16(o+=6,!1);o+=n.getUint32(o+4,a);var s=n.getUint16(o,a);o+=2;for(var c=0;c<s;c++)274===n.getUint16(o+12*c,a)&&e(n.getUint16(o+12*c+8,a))}else{if(65280!=(65280&r))break;o+=n.getUint16(o,!1)}}e(-1)},n.readAsArrayBuffer(t)})}function gt(){var t;return t=pt.a.mark(function t(e){var i,o,r,a,s,c,u,l;return pt.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,mt(e);case 2:if(!((i=t.sent)<2||i>8)){t.next=5;break}return t.abrupt("return",e);case 5:return(o=new Image).src=window.URL?window.URL.createObjectURL(e):window.webkitURL.createObjectURL(e),t.next=9,new Promise(function(t){o.onload=function(){return t()}});case 9:if(s=0,c=!1,[5,6,7,8].some(function(t){return t===i})?(r=o.height,a=o.width):(r=o.width,a=o.height),[7,8].some(function(t){return t===i})&&(s=1.5*Math.PI),[3,4].some(function(t){return t===i})&&(s=Math.PI),[5,6].some(function(t){return t===i})&&(s=.5*Math.PI),[2,4,5,7].some(function(t){return t===i})&&(c=!0),u=document.createElement("canvas"),l=u.getContext("2d"),u.width=r,u.height=a,c&&(l.translate(r,0),l.scale(-1,1)),l.translate(r/2,a/2),l.rotate(s),l.drawImage(o,-o.width/2,-o.height/2),u.toBlob){t.next=27;break}return t.next=27,n.e(2).then(n.t.bind(null,523,7));case 27:return t.abrupt("return",new Promise(function(t){u.toBlob(function(e){return t(e)},"image/jpeg")}));case 28:case"end":return t.stop()}},t)}),(gt=function(){var e=this,n=arguments;return new Promise(function(i,o){var r=t.apply(e,n);function a(t){ht(r,i,o,a,s,"next",t)}function s(t){ht(r,i,o,a,s,"throw",t)}a(void 0)})}).apply(this,arguments)}var vt={data:function(){return{uid:"",localUploadList:[],gifMaxMByte:8,errorType:{common:"上传失败",mbyte:"文件大小请勿超过".concat(this.maxMByte,"M"),gifbype:"请上传小于".concat(8,"M的gif图"),size:"宽高均不得小于".concat(this.minWidth,"像素"),format:"仅支持JPG PNG GIF"},uploadBtnStyle:{}}},mounted:function(){var t=this;this.initBus(),this.setInitFiles(),new dt.a(this.$refs.uploadList,{filter:".close",draggable:".draggable",animation:500,onMove:function(t){return t.related&&t.related.className.indexOf("draggable")>=0},onEnd:function(e){t.localUploadList.splice(e.newIndex,0,t.localUploadList.splice(e.oldIndex,1)[0])}})},watch:{localUploadList:function(t){this.$emit("update",t)},draftPic:function(){this.setInitFiles()}},props:{bus:null,initFiles:{},draftPic:{type:Array,default:function(){return[]}},editStatus:{type:Boolean,default:!0},maxAmount:{type:Number,default:20},formatList:{type:Array,default:function(){return["jpg","jpeg","png","gif"]}},maxMByte:{type:Number,default:20},minWidth:{type:Number,default:10},minHeight:{type:Number,default:10}},components:{UploadStatus:ut},methods:{initBus:function(){var t=this;this.bus.$on("emit-image-upload-click",this.emitClick),this.bus.$on("image-list-clear",function(){t.localUploadList=[]})},emitClick:function(){this.$refs.uploadInput.click()},setInitFiles:function(){this.localUploadList=this.localUploadList.concat(this.draftPic),this.initFiles.length>0&&(this.checkFilesAmount(this.initFiles),this.selectImage(this.initFiles))},selectImage:function(t){var e=this,n=Array.prototype.map.call(t,function(){return{status:"loading",errorText:"",imgUrl:""}}),i=this.localUploadList.length;this.localUploadList=this.localUploadList.concat(n),this.localUploadList.length>this.maxAmount&&this.localUploadList.splice(this.maxAmount,this.localUploadList.length-this.maxAmount);for(var o=function(n,o){var r=t[n-i];e.checkFormat(r.type)||e.$set(e.localUploadList,n,{status:"error",errorText:e.errorType.format,id:e.randomNum()});var a=function(t){var i=new Image;i.src=URL.createObjectURL(t),i.onload=function(){var o=e.checkImage(r.type,r.size,i.width,i.height);o?e.$set(e.localUploadList,n,{status:"error",errorText:o,id:e.randomNum()}):e.uploadImage(t,n)}};["jpg","jpeg"].some(function(t){return r.type.indexOf(t)>-1})?function(t){return gt.apply(this,arguments)}(r).then(function(t){a(t)}):a(r)},r=i,a=this.localUploadList.length;r<a;r++)o(r)},uploadImage:function(t,e){var n=this,i=new FormData;i.append("file_up",t),i.append("biz","draw"),i.append("category","daily"),this.bpapi({url:"".concat(b.a.API_VC,"/api/v1/drawImage/upload"),method:"post",data:i,headers:{"Content-Type":"multipart/form-data"}}).then(function(i){n.$set(n.localUploadList,e,{img_src:i.data.image_url,img_width:i.data.image_width,img_height:i.data.image_height,img_size:t.size/1024,id:n.randomNum()})},function(){n.$set(n.localUploadList,e,{status:"error",errorText:"上传失败",id:n.randomNum()})})},clickSelect:function(t){var e=t.target||t.srcElement,n=e.files;this.checkFilesAmount(n),this.selectImage(n),e.value=""},dropSelect:function(t){t.stopPropagation(),t.preventDefault();var e=t.dataTransfer.files;this.checkFilesAmount(e),this.selectImage(e)},checkFilesAmount:function(t){this.localUploadList.length+t.length>this.maxAmount&&this.linkMsg(this.$refs.uploadBtn,"上传图片不得超过".concat(this.maxAmount,"张（￣∞￣）"),"caution")},dragover:function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"},checkImage:function(t,e,n,i){return this.checkFormat(t)?t.indexOf("gif")>-1&&Math.floor(e/1024/1024)>=this.gifMaxMByte?this.errorType.gifbype:Math.floor(e/1024/1024)>=this.maxMByte?this.errorType.mbyte:(n<this.minWidth||i<this.minHeight)&&this.errorType.size:this.errorType.format},checkFormat:function(t){for(var e=0,n=this.formatList.length;e<n;e++)if(t.indexOf(this.formatList[e])>-1)return!0},removeUploadItem:function(t){this.localUploadList.splice(t,1)},randomNum:function(){return Date.now()*Math.ceil(1e5*Math.random())}}},bt=(n(256),Object(P.a)(vt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"upload-image-wrapper"},[n("div",{ref:"dropZone",staticClass:"upload-image",class:{center:!t.localUploadList.length},on:{dragover:t.dragover,drop:t.dropSelect}},[n("div",{ref:"uploadList",staticClass:"f-clear upload-list"},[t._l(t.localUploadList,function(e,i){return n("upload-status",{key:e.id||e.img_src,staticClass:"draggable f-left",attrs:{status:e.status,"error-text":e.errorText,"img-url":e.img_src}},[n("span",{staticClass:"close pointer a-fade-in",attrs:{slot:"close"},on:{click:function(e){return t.removeUploadItem(i)}},slot:"close"},[n("i",{staticClass:"bp-icon-font icon-group-dynamic c-pointer"})])])}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.localUploadList.length<parseInt(t.maxAmount),expression:"localUploadList.length < parseInt(maxAmount)"}],ref:"uploadBtn",staticClass:"f-left upload-btn b-box"},[n("input",{ref:"uploadInput",staticClass:"upload pointer",attrs:{type:"file",accept:"image/png, image/jpeg, image/jpg, image/gif",multiple:""},on:{change:t.clickSelect}}),n("i",{staticClass:"bp-icon-font icon-add pointer"})])],2)])])},[],!1,null,"97be31ae",null).exports),yt={props:{bus:null,initFiles:{},draftPic:{type:Array,default:function(){return[]}}},data:function(){return{imageList:[],selectedFiles:this.initFiles}},components:{StaticBox:at,ImageUploader:bt},methods:{updateImageList:function(t){this.imageList=t,this.$emit("update",t)},close:function(){this.$emit("close"),this.imageList=[],this.selectedFiles=[]}}},_t=(n(257),Object(P.a)(yt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("static-box",{staticClass:"upload-image-box",attrs:{width:290,arrow:!0},on:{close:t.close}},[n("span",{attrs:{slot:"title"},slot:"title"},[t._v("图片上传"),n("span",{staticClass:"d-i-block hint"},[t._v(t._s(t.imageList.length)+" / 9")])]),n("image-uploader",{attrs:{bus:t.bus,"max-amount":9,"init-files":t.selectedFiles,"draft-pic":t.draftPic},on:{update:t.updateImageList}})],1)},[],!1,null,"2453fd06",null).exports),wt=n(7),Ct=n(0);function xt(t){return(xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function It(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function kt(t,e){return!e||"object"!==xt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function St(t){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ot(t,e){return(Ot=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=kt(this,St(e).apply(this,arguments))).imageBoxShown=!1,t.selectedFiles=[],t.draftPic=[],t.imageList=[],t}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ot(t,e)}(e,u["c"]),n=e,(i=[{key:"onImageListChange",value:function(t){this.bus.$emit("image-list-update",t)}},{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.initBus()}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){this.bus.$on("reset",this.onReset),this.bus.$on("image-draft-update",this.onImageDraftUpdate)}},{key:"onReset",value:function(){this.onImageBoxClose()}},{key:"triggerImageBoxShow",value:function(){this.imageBoxShown=!this.imageBoxShown,this.imageBoxShown&&(this.bus.$emit("emit-image-upload-click"),this.isPopupPanel?Object(wt.d)(Ct.d.PUBLICH_PIC_2,""):Object(wt.d)(Ct.d.PUBLICH_PIC_1,""))}},{key:"updateImageList",value:function(t){this.imageList=t}},{key:"onImageDraftUpdate",value:function(t){t.length>0&&(this.imageBoxShown=!0),this.draftPic=t}},{key:"onImageBoxClose",value:function(){this.bus.$emit("image-list-clear"),this.draftPic=[],this.imageList=[],this.selectedFiles=[],this.imageBoxShown=!1}},{key:"validDraftPic",get:function(){return this.draftPic.filter(function(t){return t&&void 0!==t.img_src})}}])&&It(n.prototype,i),o&&It(n,o),e}();c.a([Object(u.b)()],Pt.prototype,"bus",void 0),c.a([Object(u.b)()],Pt.prototype,"loginUid",void 0),c.a([Object(u.b)(Boolean)],Pt.prototype,"isPopupPanel",void 0),c.a([Object(u.d)("imageList")],Pt.prototype,"onImageListChange",null);var Tt=Pt=c.a([Object(u.a)({name:"image-box",components:{UploadImageBox:_t}})],Pt),Et=(n(258),Object(P.a)(Tt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"image-box"},[n("button",{staticClass:"d-i-block bp-v-middle bp-icon-font icon-pic-btn box-toggle",class:{active:t.imageBoxShown},attrs:{title:"上传图片"},on:{click:t.triggerImageBoxShow}}),n("div",{staticClass:"image-popup"},[n("upload-image-box",{directives:[{name:"show",rawName:"v-show",value:t.imageBoxShown,expression:"imageBoxShown"}],attrs:{bus:t.bus,"init-files":t.selectedFiles,"draft-pic":t.validDraftPic},on:{update:t.updateImageList,close:t.onImageBoxClose}})],1)])},[],!1,null,"370500a3",null).exports),jt=(n(33),n(68));function Lt(t){return(Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function At(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Dt(t,e){return!e||"object"!==Lt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mt(t){return(Mt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nt(t,e){return(Nt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Dt(this,Mt(e).apply(this,arguments))).field=null,t.inputElement=null,t.isMounted=!1,t.unameToUid={},t.caretPos=0,t}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nt(t,e)}(e,u["c"]),n=e,(i=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.debounceFetchNameToUid=Object(m.b)(this.fetchNameToUid,1),this.debounceAtHandler=Object(m.b)(this.atHandler,1),this.initBus()}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){this.isMounted=!0,this.buttonElement=this.$refs.button}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("text-update",this.debounceAtHandler),this.bus.$on("editor-dom-change",function(e){t.inputElement=e}),this.bus.$on("caret-change",function(e){t.caretPos=e})}},{key:"atHandler",value:function(t){var e=/@[^\n\r\s@↵]{1,20}(?=\s)/g,n=[],i=!0;do{var o=e.exec(t);if(o){var r=o[0];$t(r)&&n.push({text:r,index:o.index})}else i=!1}while(i);this.debounceFetchNameToUid(n)}},{key:"generateCtrl",value:function(t){var e=this,n=[];t.forEach(function(t){e.unameToUid[t.text]&&n.push({location:t.index,type:1,length:t.text.length+1,data:String(e.unameToUid[t.text])})}),this.bus.$emit("update-ctrl",{at:n})}},{key:"fetchNameToUid",value:function(t){var e=this,n="",i={};t.forEach(function(t){e.unameToUid[t.text]||i[t.text]||(i[t.text]=!0,n+=",".concat(t.text.slice(1)))}),(n=n.replace(/^,/,""))?this.bpapi({method:"get",url:"".concat(b.a.API_VC,"/dynamic_mix/v1/dynamic_mix/name_to_uid"),data:{names:n,teenagers_mode:0}}).then(function(n){n.data&&n.data.uid_list&&n.data.uid_list.forEach(function(t){e.unameToUid["@".concat(t.name)]=t.uid}),e.generateCtrl(t)}).catch(function(n){console.error(n),e.generateCtrl(t)}):this.generateCtrl(t)}},{key:"triggerAtBoxShow",value:function(t){t.stopPropagation(),t.preventDefault(),this.bus.$emit("insert","@")}},{key:"selectHandler",value:function(t){var e=this,n=t.uid,i=t.uname,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.unameToUid["@".concat(i)]=n,this.bus.$emit("delete",o.length),setTimeout(function(){e.bus.$emit("insert","@".concat(i," "))},0)}},{key:"logHandler",value:function(){var t=this.isPopupPanel?Ct.d.PUBLISH_AT_LIST_SHOW_2:Ct.d.PUBLISH_AT_LIST_SHOW_1;Object(wt.d)(t)}}])&&At(n.prototype,i),o&&At(n,o),e}();c.a([Object(u.b)()],Rt.prototype,"bus",void 0),c.a([Object(u.b)()],Rt.prototype,"loginUid",void 0),c.a([Object(u.b)(Boolean)],Rt.prototype,"isPopupPanel",void 0),Rt=c.a([Object(u.a)({name:"at-box",components:{AtPopup:jt.a}})],Rt);var Bt,Ut,Ht,$t=function(t){var e=t.replace(/^@/,"");return!!e&&!/[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(e)&&/^[^\n\r\s@↵]{1,20}$/.test(e)},Ft=Rt,Vt=(n(259),Object(P.a)(Ft,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"at-box"},[this.isMounted?e("at-popup",{attrs:{buttonElm:this.buttonElement,"input-elm":this.inputElement,"select-handler":this.selectHandler,"log-handler":this.logHandler}}):this._e()],1)},[],!1,null,"0b6ba356",null).exports),zt=(n(146),n(152),n(36),n(142),n(56),["boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing"]),Gt=function(t,e){(Bt=document.getElementById(t.nodeName+"--mirror-div"))||((Bt=document.createElement("div")).id=t.nodeName+"--mirror-div",document.body.appendChild(Bt)),Ht=Bt.style,Ut=getComputedStyle(t),Ht.whiteSpace="pre-wrap","INPUT"!==t.nodeName&&(Ht.wordWrap="break-word"),Ht.position="absolute",Ht.top=t.offsetTop+parseInt(Ut.borderTopWidth)+"px",Ht.left=t.offsetLeft+parseInt(Ut.borderLeftWidth)+"px",Ht.visibility="hidden",zt.forEach(function(t){Ht[t]=Ut[t]}),navigator.userAgent.indexOf("Firefox")>-1?(Ht.width=parseInt(Ut.width)-2+"px",t.scrollHeight>parseInt(Ut.height)&&(Ht.overflowY="scroll")):Ht.overflow="hidden",Bt.textContent=t.value.substring(0,e),"INPUT"===t.nodeName&&(Bt.textContent=Bt.textContent.replace(/\s/g," "));var n=document.createElement("span");return n.textContent=t.value.substring(e)||".",Bt.appendChild(n),{top:n.offsetTop+parseInt(Ut.borderTopWidth)+parseInt(Ut["line-height"])-t.scrollTop,left:n.offsetLeft+parseInt(Ut.borderLeftWidth)}},Jt=/^ |\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]|@|\n| $/,Wt={data:function(){return{isShow:!1,top:0,left:0,selectedIndex:0,topicList:[],mouseOverEnabled:!0,needHide:!1,isSafari:!1,isIE:!1}},props:{inputElm:{required:!0},buttonElm:{},clickButtonHandler:{type:Function,default:function(){}},selectHandler:{type:Function,default:function(){}},logHandler:{type:Function,default:function(){}},loginUid:{type:Number,default:0},emojiBoxShown:{type:Boolean,default:function(){return!1}}},computed:{topPx:function(){return this.top+"px"},leftPx:function(){return this.left+"px"},computedHeight:function(){return this.topicList.length>0?"150px":"30px"}},beforeMount:function(){var t=Object(m.d)();this.isIE=-1!==t.indexOf("IE"),this.isSafari=-1!==t.indexOf("Safari")},mounted:function(){this.initEvents(),this.debounceSearch=Object(m.b)(this.search,500),this.debounceEnableMouseOver=Object(m.b)(this.enableMouseOver,200)},watch:{emojiBoxShown:function(t){t&&(this.isShow=!1)}},methods:{onMousedown:function(t){(t||window.event).preventDefault()},onClickItem:function(t){var e=this,n=Object(l.g)(this.inputElm),i=(this.isIE?this.inputElm.value:this.inputElm.value.replace(/\n/g,"")).substring(0,n),o=i.lastIndexOf("#"),r=i.substring(o,n);this.selectHandler(t,r),this.hide(),this.topicList=[],this.inputElm.focus(),"TEXTAREA"===this.inputElm.tagName&&setTimeout(function(){var n=o+t.length+3;Object(l.r)(e.inputElm,n)},0)},show:function(){this.emojiBoxShown||(this.isShow?this.calculatePosition():(this.isShow=!0,this.selectedIndex=0,this.calculatePosition()))},hide:function(){this.isShow=!1},updateView:function(){var t=Object(l.g)(this.inputElm,!1),e=this.inputElm.value.substring(t-33,t),n=e.lastIndexOf("#");if(~n){var i=e.substring(n+1);""!==i&&""===String(i).trim()||i.match(Jt)||" "===i.substring(0,1)?this.hide():(this.show(),this.debounceSearch(i))}else this.hide()},search:function(t){var e=this;""===t?this.loginUid?this.bpapi({url:"".concat(b.a.API_VC,"/topic_svr/v1/topic_svr/get_rcmd_topic"),method:"get"}).then(function(t){if(0===t.code){var n=t.data.rcmds||[];Array.isArray(n)?e.topicList=n.slice(0,10).map(function(t){return t.topic_name}):e.topicList=[]}else e.topicList=[]},function(){e.topicList=[]}):this.topicList=[]:this.bpapi({url:"".concat(b.a.API_VC,"/dynamic_topic/v1/Topic/search"),method:"get",data:{s:t}}).then(function(t){if(0===t.code){var n=t.data.list||[];Array.isArray(n)?e.topicList=n.slice(0,10):e.topicList=[]}else e.topicList=[]},function(){e.topicList=[]})},calculatePosition:function(){var t,e=Object(l.g)(this.inputElm),n=(this.isIE?this.inputElm.value:this.inputElm.value.replace(/\n/g,"")).substring(0,e).lastIndexOf("#");if(this.isIE||this.isSafari)t=Gt(this.inputElm,n),this.left=t.left,this.top=t.top;else{var i=this.inputElm.getBoundingClientRect(),o=i.top,r=i.left,a=window.getSelection().getRangeAt(0);if(0===a.getClientRects().length){var s=this.inputElm.value,c=document.createTextNode(" ");a.insertNode(c),a.selectNode(c),t=a.getBoundingClientRect(),a.deleteContents(),a.collapse(!0),this.inputElm.value=s}else t=a.getBoundingClientRect();this.left=t.left-r,this.top=t.top+18-o}var u=parseFloat(getComputedStyle(this.inputElm,null).getPropertyValue("height").replace(/px/,""));(this.top>u+10||this.top<-20)&&(this.top=u+10),this.left<-20&&(this.left=0)},initEvents:function(){this.inputElm&&(this.inputElm.addEventListener("input",this.textInputHandler),this.inputElm.addEventListener("keydown",this.keyDownHandler),this.inputElm.addEventListener("keyup",this.keyUpHandler),this.inputElm.addEventListener("focus",this.focusHandler),this.inputElm.addEventListener("blur",this.blurHandler),this.inputElm.addEventListener("click",this.clickHandler)),this.buttonElm&&this.buttonElm.addEventListener("click",this.buttonClickHandler)},removeEvents:function(){this.inputElm.removeEventListener("input",this.textInputHandler),this.inputElm.removeEventListener("keydown",this.keyDownHandler),this.inputElm.removeEventListener("keyup",this.keyUpHandler),this.inputElm.removeEventListener("focus",this.focusHandler),this.inputElm.removeEventListener("blur",this.blurHandler),this.inputElm.removeEventListener("click",this.clickHandler),this.buttonElm&&this.buttonElm.removeEventListener("click",this.buttonClickHandler)},mouseOverHandler:function(t){this.mouseOverEnabled&&(this.selectedIndex=t)},textInputHandler:function(){var t=this;setTimeout(function(){t.updateView()},0)},keyDownHandler:function(t){if(this.isShow)if(13===t.keyCode){var e=this.topicList[this.selectedIndex];e&&(this.onClickItem(e),t.preventDefault())}else 38===t.keyCode?(t.preventDefault(),this.pickUp()):40===t.keyCode&&(t.preventDefault(),this.pickDown())},keyUpHandler:function(t){t.keyCode>=37&&t.keyCode<=40?this.updateView():51===t.keyCode&&!0===t.shiftKey&&this.logHandler()},blurHandler:function(){var t=this;setTimeout(function(){t.needHide&&t.hide()},300),this.needHide=!0},focusHandler:function(){setTimeout(this.updateView,0)},buttonClickHandler:function(){var t=this;this.needHide=!1,this.clickButtonHandler&&this.clickButtonHandler(),setTimeout(function(){t.clickHandler()},100)},clickHandler:function(){this.updateView()},pickUp:function(){this.selectedIndex-1>=0?this.selectedIndex--:this.selectedIndex=this.topicList.length-1,this.updateListScrollTop()},pickDown:function(){this.selectedIndex+1<this.topicList.length?this.selectedIndex++:this.selectedIndex=0,this.updateListScrollTop()},updateListScrollTop:function(){if(this.$refs.topicList){var t=this.selectedIndex;24*t>this.$refs.topicList.scrollTop+96?(this.$refs.topicList.scrollTop=24*t-96,this.disableMouseOver()):24*t<this.$refs.topicList.scrollTop&&(this.$refs.topicList.scrollTop=24*t,this.disableMouseOver())}},disableMouseOver:function(){this.mouseOverEnabled=!1,this.debounceEnableMouseOver()},enableMouseOver:function(){this.mouseOverEnabled=!0}}},Kt=(n(260),Object(P.a)(Wt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"hash-popup bg-white",style:{top:t.topPx,left:t.leftPx,height:t.computedHeight}},[n("p",{staticClass:"hint ff-yahei fs-12 tc-slate ls-0 c-default"},[t._v("选择你想用的话题")]),t.topicList.length>0?n("div",{ref:"topicList",staticClass:"topic-container w-100"},t._l(t.topicList,function(e,i){return n("a",{staticClass:"item ff-yahei fs-12 tc-black ls-0 d-block c-pointer",class:{"is-selected":i===t.selectedIndex},on:{mouseover:function(e){return t.mouseOverHandler(i)},mousedown:t.onMousedown,click:function(n){return t.onClickItem(e)}}},[t._v(t._s("#"+e+"#"))])}),0):t._e()])},[],!1,null,"9f192432",null).exports);o.a.use(s.b);var Yt=Kt;function qt(t){return(qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Xt(t,e){return!e||"object"!==qt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zt(t){return(Zt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function te(t,e){return(te=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ee=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Xt(this,Zt(e).apply(this,arguments))).text="",t.field=null,t.inputElement=null,t.isMounted=!1,t.caretPos=0,t}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&te(t,e)}(e,u["c"]),n=e,(i=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.initBus()}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){this.isMounted=!0,this.buttonElement=this.$refs.button}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("text-update",function(e){t.text=e}),this.bus.$on("editor-dom-change",function(e){t.inputElement=e}),this.bus.$on("caret-change",function(e){t.caretPos=e})}},{key:"triggerTopicBoxShow",value:function(t){t.stopPropagation(),t.preventDefault(),this.bus.$emit("insert","#")}},{key:"selectHandler",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.bus.$emit("delete",n.length),"#"===this.text.substring(this.caretPos-1,this.caretPos)&&setTimeout(function(){e.bus.$emit("delete",-1)},0),setTimeout(function(){e.bus.$emit("insert","#".concat(t,"# "))},0)}},{key:"logHandler",value:function(){var t=this.isPopupPanel?Ct.d.PUBLISH_AT_LIST_SHOW_2:Ct.d.PUBLISH_AT_LIST_SHOW_1;Object(wt.d)(t)}}])&&Qt(n.prototype,i),o&&Qt(n,o),e}();c.a([Object(u.b)()],ee.prototype,"bus",void 0),c.a([Object(u.b)()],ee.prototype,"loginUid",void 0),c.a([Object(u.b)(Boolean)],ee.prototype,"isPopupPanel",void 0);var ne=ee=c.a([Object(u.a)({name:"topic-box",components:{HashPopup:Yt}})],ee),ie=Object(P.a)(ne,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"topic-box"},[n("button",{ref:"button",staticClass:"d-i-block bp-v-middle bp-icon-font icon-topic box-toggle",attrs:{title:"参与话题"},on:{click:t.triggerTopicBoxShow}}),t.isMounted?n("hash-popup",{attrs:{buttonElm:t.buttonElement,"input-elm":t.inputElement,"select-handler":t.selectHandler,"login-uid":t.loginUid,"log-handler":t.logHandler}}):t._e()],1)},[],!1,null,"5a5dc85c",null).exports,oe=(n(261),n(54));function re(t){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ae(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function se(t,e){return!e||"object"!==re(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ce(t){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ue(t,e){return(ue=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var le=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),se(this,ce(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ue(t,e)}(e,u["c"]),n=e,(i=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"onClick",value:function(t){this.$emit("click",t)}}])&&ae(n.prototype,i),o&&ae(n,o),e}(),de=le=c.a([Object(u.a)({name:"bp-add-button",components:{}})],le),fe=(n(262),Object(P.a)(de,function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"bp-add-button",on:{click:this.onClick}},[e("i",{staticClass:"add-icon"}),this._t("default")],2)},[],!1,null,"f69b0614",null).exports);function pe(t){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function he(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function me(t,e){return!e||"object"!==pe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ge(t){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ve(t,e){return(ve=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var be=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),me(this,ge(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ve(t,e)}(e,u["c"]),n=e,(i=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"onClick",value:function(t){this.$emit("click",t)}},{key:"buttonClassArray",get:function(){var t=[];switch(this.status){case"active":t=t.concat(["active","no-border"])}return t}}])&&he(n.prototype,i),o&&he(n,o),e}();c.a([Object(u.b)(String)],be.prototype,"status",void 0);var ye=be=c.a([Object(u.a)({name:"bp-button",components:{}})],be),_e=(n(263),Object(P.a)(ye,function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"bp-button",class:this.buttonClassArray,on:{click:this.onClick}},[this._t("default")],2)},[],!1,null,"b26b5ce0",null).exports);function we(t){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ce(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function xe(t,e){return!e||"object"!==we(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ie(t){return(Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ke(t,e){return(ke=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Se=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=xe(this,Ie(e).apply(this,arguments))).isOnFocus=!1,t}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ke(t,e)}(e,u["c"]),n=e,(i=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"onInput",value:function(t){var e=t.target;this.$emit("input",e.value)}},{key:"onFocus",value:function(){this.isOnFocus=!0}},{key:"onBlur",value:function(){this.isOnFocus=!1}},{key:"currentlength",get:function(){return String(this.value).length||0}}])&&Ce(n.prototype,i),o&&Ce(n,o),e}();c.a([Object(u.b)({type:String,default:"text"})],Se.prototype,"type",void 0),c.a([Object(u.b)([String,Number])],Se.prototype,"maxlength",void 0),c.a([Object(u.b)([String,Number])],Se.prototype,"value",void 0),c.a([Object(u.b)(String)],Se.prototype,"placeholder",void 0);var Oe=Se=c.a([Object(u.a)({name:"bp-input",components:{}})],Se),Pe=(n(264),Object(P.a)(Oe,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"bp-input"},["textarea"===t.type?[n("div",{staticClass:"content-box textarea-box",class:{"on-focus":t.isOnFocus}},[n("textarea",{staticClass:"textarea",attrs:{placeholder:t.placeholder,maxlength:t.maxlength},domProps:{value:t.value},on:{input:t.onInput,focus:t.onFocus,blur:t.onBlur}}),n("div",{staticClass:"indicator"},[t._v(t._s(t.currentlength)+"/"+t._s(t.maxlength))])])]:t._e(),"textarea"!==t.type?[n("div",{staticClass:"content-box input-box",class:{"on-focus":t.isOnFocus}},[t._t("prefix"),n("input",{staticClass:"input",class:"input-"+t.type,attrs:{type:t.type,placeholder:t.placeholder,maxlength:t.maxlength},domProps:{value:t.value},on:{input:t.onInput,focus:t.onFocus,blur:t.onBlur}}),n("div",{staticClass:"indicator"},[t._v(t._s(t.currentlength)+"/"+t._s(t.maxlength))])],2),t._t("suffix")]:t._e()],2)},[],!1,null,"793bb182",null).exports);function Te(t){return(Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ee(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function je(t,e){return!e||"object"!==Te(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Le(t){return(Le=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ae(t,e){return(Ae=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var De=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),je(this,Le(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ae(t,e)}(e,u["c"]),n=e,(i=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"onClick",value:function(t){this.$emit("click",t)}}])&&Ee(n.prototype,i),o&&Ee(n,o),e}();c.a([Object(u.b)(Boolean)],De.prototype,"checked",void 0),c.a([Object(u.b)(String)],De.prototype,"value",void 0),c.a([Object(u.b)(String)],De.prototype,"name",void 0);var Me=De=c.a([Object(u.a)({name:"bp-radio",components:{}})],De),Ne=(n(265),Object(P.a)(Me,function(){var t=this.$createElement,e=this._self._c||t;return e("label",{staticClass:"bp-radio",on:{click:this.onClick}},[e("div",{staticClass:"radio-icon",class:{checked:this.checked}}),e("input",{staticClass:"radio-input",attrs:{type:"radio",name:this.name},domProps:{value:this.value,checked:this.checked}}),this._t("default")],2)},[],!1,null,"51588634",null).exports);function Re(t){return(Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Be(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ue(t,e){return!e||"object"!==Re(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function He(t){return(He=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $e(t,e){return($e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fe=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ue(this,He(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$e(t,e)}(e,u["c"]),n=e,(i=[{key:"onValueChange",value:function(t){var e=t.target;this.$emit("input",e.value)}},{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}}])&&Be(n.prototype,i),o&&Be(n,o),e}();c.a([Object(u.b)([String,Number])],Fe.prototype,"value",void 0),c.a([Object(u.b)(Array)],Fe.prototype,"options",void 0);var Ve=Fe=c.a([Object(u.a)({name:"bp-selector",components:{}})],Fe),ze=(n(266),Object(P.a)(Ve,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"bp-selector"},[n("select",{staticClass:"selector",domProps:{value:t.value},on:{change:t.onValueChange}},t._l(t.options,function(e){return n("option",{key:e.value,domProps:{value:e.value}},[t._v(t._s(e.label)+"\n    ")])}),0),n("i",{staticClass:"more-icon"})])},[],!1,null,"6aaa05f4",null).exports);function Ge(t){return(Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Je(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function We(t,e){return!e||"object"!==Ge(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ke(t){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ye(t,e){return(Ye=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qe=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=We(this,Ke(e).apply(this,arguments))).formatList=["jpg","jpeg","png"],t.maxMByte=20,t.minWidth=10,t.minHeight=10,t.errorType={mbyte:"图片大小请勿超过20M",size:"图片宽高均不得小于10像素",format:"仅支持JPG PNG格式的图片"},t}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ye(t,e)}(e,u["c"]),n=e,(i=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"imageBoxUrl",value:function(){var t=this.url;return"string"==typeof t&&"loading"!==t&&"error"!==t?(t=Object(st.a)(t.replace(/^(https?:)|^(\/\/)/,""),56,56,{c:1}),"background-image: url(".concat(t,"); background-size: cover;")):""}},{key:"checkFormat",value:function(t){for(var e=0,n=this.formatList.length;e<n;e+=1)if(t.indexOf(this.formatList[e])>-1)return!0;return!1}},{key:"checkImage",value:function(t,e,n,i){return this.checkFormat(t)?Math.floor(e/1024/1024)>=this.maxMByte?this.errorType.mbyte:(n<this.minWidth||i<this.minHeight)&&this.errorType.size:this.errorType.format}},{key:"callFileDialog",value:function(){var t=this,e=document.createElement("input");e.type="file",e.accept="image/png, image/jpeg, image/jpg, image/gif",e.name="upload",e.addEventListener("change",function(e){var n=e.target||e.srcElement,i=n&&n.files||[];if(i&&i.length>0){var o=i[0],r=t.checkImage(o.type,o.size,20,20);if(r)return void t.linkMsg(null,r,"error",!0,!0);var a=new Image;a.src=window.URL?window.URL.createObjectURL(o):window.webkitURL.createObjectURL(o),a.onload=function(){var e=t.checkImage(o.type,o.size,a.width,a.height);e?t.linkMsg(null,e,"error",!0,!0):(t.$emit("loading",{index:t.index}),t.uploadImage(i[0]).then(function(e){t.$emit("success",{index:t.index,bres:e})},function(e){t.$emit("fail",{index:t.index,berr:e})}))}}}),e.click(),window.upload_input=e,e=null}},{key:"uploadImage",value:function(t){var e=new FormData;return e.append("file_up",t),e.append("biz","draw"),e.append("category","daily"),this.bpapi({url:"//api.vc.bilibili.com/api/v1/drawImage/upload",method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}})}}])&&Je(n.prototype,i),o&&Je(n,o),e}();c.a([Object(u.b)(Number)],qe.prototype,"index",void 0),c.a([Object(u.b)(String)],qe.prototype,"url",void 0);var Qe=qe=c.a([Object(u.a)({name:"bp-upload",components:{}})],qe),Xe=(n(267),Object(P.a)(Qe,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bp-upload",on:{click:function(e){return t.callFileDialog(t.index)}}},[t.url?n("div",{staticClass:"image-box",class:t.url,style:t.imageBoxUrl(t.index)}):t._e(),t.url?t._e():n("div",{staticClass:"image-box"}),n("div",{staticClass:"bg-color"})])},[],!1,null,"2be57f3e",null).exports);function Ze(t){return(Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function en(t,e){return!e||"object"!==Ze(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nn(t){return(nn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function on(t,e){return(on=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),en(this,nn(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&on(t,e)}(e,u["c"]),n=e,(i=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}}])&&tn(n.prototype,i),o&&tn(n,o),e}(),an=rn=c.a([Object(u.a)({name:"bp-title",components:{}})],rn),sn=(n(268),Object(P.a)(an,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("div",{staticClass:"title-content"},[this._t("default")],2),e("div",{staticClass:"slot-right"},[this._t("right")],2)])},[],!1,null,"47d56164",null).exports);var cn=function(t){var e="";return t.msg&&"非法请求"!==t.msg&&"电波无法到达~"!==t.msg&&(e=t.msg),e||{100:"诶呦，似乎你还没有登录呢",1e3:"诶呦，似乎你还不能发布投票呢"}[t.code]||"电波无法到达~ ".concat(t.code)};function un(t){return(un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ln(t,e,n,i,o,r,a){try{var s=t[r](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}function dn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function fn(t,e){return!e||"object"!==un(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pn(t){return(pn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hn(t,e){return(hn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=fn(this,pn(e).apply(this,arguments))).voteTitle="",t.typeList=[{name:"文字投票",value:"text"},{name:"图片投票",value:"image"}],t.type="text",t.optionsCount=2,t.optionsList=["",""],t.optionsImageList=["",""],t.moreConfigShow=!1,t.hasIntroduction=!1,t.introduction="",t.choiceCount="1",t.durationList=[{label:"三天",value:String(259200)},{label:"一周",value:String(604800)},{label:"一个月",value:String(2592e3)}],t.duration=String(604800),t.voteId="",t.errorList=[],t.defaultText="我发起了一个投票",t.canUploadIOS=!0,t.canUploadAndroid=!0,t.maxOptionsCount=20,t.maxTextLength=20,t}var n,i,o,r,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hn(t,e)}(e,u["c"]),n=e,(i=[{key:"onOptionsCountChange",value:function(t){"1"!==this.choiceCount&&parseInt(this.choiceCount,10)>t&&(this.choiceCount=String(t))}},{key:"onShowChange",value:function(t){t&&this.init()}},{key:"onConfigChange",value:function(){this.init()}},{key:"mounted",value:(r=pt.a.mark(function t(){var e,n;return pt.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.init(),t.next=3,Object(st.d)(!1);case 3:e=t.sent,"928123"!==(n=String(e.mid))&&"32708587"!==n&&"5552021"!==n||(this.maxOptionsCount=9999),this.$bpreport.pv({spmId:"444.41",logId:"000391",event:"poll_visit",data:{type:"web"}});case 7:case"end":return t.stop()}},t,this)}),a=function(){var t=this,e=arguments;return new Promise(function(n,i){var o=r.apply(t,e);function a(t){ln(o,n,i,a,s,"next",t)}function s(t){ln(o,n,i,a,s,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"clear",value:function(){this.voteTitle="",this.typeList=[{name:"文字投票",value:"text"},{name:"图片投票",value:"image"}],this.type="text",this.optionsCount=2,this.optionsList=["",""],this.optionsImageList=["",""],this.moreConfigShow=!1,this.hasIntroduction=!1,this.introduction="",this.choiceCount="1",this.duration=String(604800),this.voteId="",this.errorList=[]}},{key:"init",value:function(){this.config&&this.config.vote_id?(this.voteId=this.config.vote_id,this.fetchConfig()):this.clear()}},{key:"getOptionsList",value:function(){var t=this;return this.optionsList.map(function(e,n){var i={desc:e};return"image"===t.type&&(i.img_url=t.optionsImageList[n]),i})}},{key:"setErrorList",value:function(t){this.errorList=t}},{key:"setTypeValue",value:function(t){this.type=t.value}},{key:"addIntroduction",value:function(){this.hasIntroduction=!0}},{key:"addOption",value:function(){this.optionsCount+=1,this.optionsList.push(""),this.optionsImageList.push("")}},{key:"deletePrize",value:function(t){this.optionsCount>2&&(this.optionsCount-=1,this.optionsList.splice(t-1,1),this.optionsImageList.splice(t-1,1))}},{key:"showMoreConfig",value:function(){this.moreConfigShow=!0}},{key:"onImgLoading",value:function(t){var e=t.index;this.optionsImageList[e-1]="loading",this.$forceUpdate()}},{key:"onImgSuccess",value:function(t){var e=t.index,n=t.bres;this.optionsImageList[e-1]=n.data.image_url,this.$forceUpdate();var i=this.errorList;this.errorList=[],this.errorList=i}},{key:"onImgFail",value:function(t){var e=t.index,n=t.berr;this.optionsImageList[e-1]="error",this.$forceUpdate(),this.linkMsg(null,"".concat(n.msg," ").concat(n.code),"error",!0,!0)}},{key:"fetchConfig",value:function(){var t=this;this.bpapi({method:"get",url:"//api.vc.bilibili.com/vote_svr/v1/vote_svr/vote_info",data:{vote_id:this.voteId}}).then(function(e){var n=e.data.info,i=[],o=[];n.options.forEach(function(t){i[t.idx-1]=t.desc,1===n.type&&(o[t.idx-1]=t.img_url)}),t.optionsList=i,t.optionsImageList=o,t.voteTitle=n.title,n.desc&&(t.introduction=n.desc,t.hasIntroduction=!0),t.type=0===n.type?"text":"image",t.optionsCount=i.length,t.choiceCount=String(n.choice_cnt);var r=n.endtime-(new Date).getTime()/1e3,a=Math.floor(r/86400);t.duration=a<3?String(259200):a<7?String(604800):String(2592e3),t.moreConfigShow=!0,t.optionsList=i},function(e){var n=cn(e);t.linkMsg(null,n,"error",!0,!0)})}},{key:"onSubmit",value:function(){if(this.$bpreport.pv({spmId:"444.41",logId:"000391",event:"dt_poll_submit",data:{from:"create_vote.".concat(this.from||"dynamic",".web")}}),this.isActive)this.apiSubmit();else{var t=this.errorList[0];this.linkMsg(null,t||"请检查您所填写的全部内容","success",!0,!0)}}},{key:"apiSubmit",value:function(){var t=this,e=this.getOptionsList(),n={title:this.voteTitle,desc:this.introduction,type:"text"===this.type?0:1,choice_cnt:this.choiceCount,duration:parseInt(this.duration,10),options:e},i="//api.vc.bilibili.com/vote_svr/v1/vote_svr/create_vote";this.voteId&&(i="//api.vc.bilibili.com/vote_svr/v1/vote_svr/update_vote",n.vote_id=this.voteId),this.bpapi({method:"post",url:i,data:{info:n}}).then(function(e){t.callNative(e.data.vote_id)},function(e){var n=cn(e);t.linkMsg(null,n,"error",!0,!0)})}},{key:"callNative",value:function(t){var e={vote_id:t,default_text:this.voteId?"":this.defaultText,title:this.voteTitle};this.postMessage(e)}},{key:"postMessage",value:function(t){this.$emit("vote-create",t)}},{key:"onCancel",value:function(){this.$emit("cancel")}},{key:"isActive",get:function(){var t=[];this.voteTitle||t.push("请填写标题"),this.voteTitle.length>32&&t.push("标题请不要超过32个字"),this.introduction.length>100&&t.push("描述请不要超过100个字");for(var e=this.optionsImageList,n=Math.max(this.optionsCount,this.optionsImageList.length,this.optionsList.length),i=0;i<n;i+=1)"image"!==this.type||e[i]&&"loading"!==e[i]&&"error"!==e[i]||t.push("请上传图片"),this.optionsList[i]||t.push("请填写完所有选项");return this.setErrorList(t),!(this.errorList.length>0)}},{key:"choiceCountList",get:function(){for(var t=[{label:"单选",value:"1"}],e=1;e<this.optionsCount;e+=1)t.push({label:"最多选".concat(e+1,"项"),value:String(e+1)});return t}},{key:"zIndexStyle",get:function(){return"z-index: ".concat(this.zIndex||2,";")}}])&&dn(n.prototype,i),o&&dn(n,o),e}();c.a([Object(u.b)(Number)],mn.prototype,"zIndex",void 0),c.a([Object(u.b)(Object)],mn.prototype,"config",void 0),c.a([Object(u.b)(Boolean)],mn.prototype,"show",void 0),c.a([Object(u.b)(String)],mn.prototype,"from",void 0),c.a([Object(u.d)("optionsCount")],mn.prototype,"onOptionsCountChange",null),c.a([Object(u.d)("show")],mn.prototype,"onShowChange",null),c.a([Object(u.d)("config")],mn.prototype,"onConfigChange",null);var gn=mn=c.a([Object(u.a)({name:"create",components:{BpAddButton:fe,BpButton:_e,BpInput:Pe,BpRadio:Ne,BpSelector:ze,BpUpload:Xe,BpTitle:sn}})],mn),vn=(n(269),Object(P.a)(gn,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bp-vote-container"},[n("transition",{attrs:{name:"move-in"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"create-vote",style:t.zIndexStyle},[n("div",{staticClass:"main-content"},[n("div",{staticClass:"group"},[n("bp-title",[t._v("投票标题")]),n("bp-input",{attrs:{placeholder:"请填写标题",maxlength:"32","data-model":"voteTitle"},model:{value:t.voteTitle,callback:function(e){t.voteTitle=e},expression:"voteTitle"}}),t.hasIntroduction?t._e():n("bp-add-button",{on:{click:t.addIntroduction}},[t._v("添加说明\n          ")]),t.hasIntroduction?n("bp-title",[t._v("投票说明")]):t._e(),t.hasIntroduction?n("bp-input",{attrs:{type:"textarea",maxlength:"100",placeholder:"请填写投票说明(选填)","data-model":"introduction"},model:{value:t.introduction,callback:function(e){t.introduction=e},expression:"introduction"}}):t._e()],1),n("div",{staticClass:"group"},[n("bp-title",[n("span",[t._v("投票类型")]),t._l(t.typeList,function(e){return n("bp-radio",{key:e.value,attrs:{slot:"right",checked:e.value===t.type,value:e.value,name:"at-config"},on:{click:function(n){return t.setTypeValue(e)}},slot:"right"},[t._v("\n              "+t._s(e.name)+"\n            ")])})],2)],1),n("div",{staticClass:"group"},[n("bp-title",[t._v("投票选项")]),t._l(t.optionsCount,function(e){return n("bp-input",{key:e,attrs:{placeholder:"请填写选项内容"+e,type:"text",maxlength:t.maxTextLength,"data-model":"number"+(e-1)},model:{value:t.optionsList[e-1],callback:function(n){t.$set(t.optionsList,e-1,n)},expression:"optionsList[index - 1]"}},["image"===t.type?n("bp-upload",{attrs:{slot:"prefix",index:e,url:t.optionsImageList[e-1]},on:{loading:t.onImgLoading,success:t.onImgSuccess,fail:t.onImgFail},slot:"prefix"}):t._e(),t.optionsCount>2?n("div",{staticClass:"option-delete",attrs:{slot:"suffix"},on:{click:function(n){return n.preventDefault(),n.stopPropagation(),t.deletePrize(e)}},slot:"suffix"}):t._e()],1)}),t.optionsCount<t.maxOptionsCount?n("bp-add-button",{on:{click:t.addOption}},[t._v("添加选项\n          ")]):t._e()],2),n("div",{staticClass:"group"},[n("bp-title",[t._v("更多设置")]),n("bp-title",[n("span",[t._v("单选/多选")]),n("bp-selector",{attrs:{slot:"right",options:t.choiceCountList},slot:"right",model:{value:t.choiceCount,callback:function(e){t.choiceCount=e},expression:"choiceCount"}})],1),n("bp-title",[n("span",[t._v("投票时长")]),n("bp-selector",{attrs:{slot:"right",options:t.durationList},slot:"right",model:{value:t.duration,callback:function(e){t.duration=e},expression:"duration"}})],1)],1)]),n("div",{staticClass:"button-bar"},[n("bp-button",{on:{click:t.onCancel}},[t._v("取消")]),n("bp-button",{attrs:{status:t.isActive?"active":"disable"},on:{click:t.onSubmit}},[t._v(t._s(t.voteId?"更新投票":"发起投票")+"\n        ")])],1)])])],1)},[],!1,null,"4b97839a",null).exports);o.a.use(Object(r.a)()),o.a.use(s.b),o.a.use(oe.bpreportPlugin,{click:{spmId:"444.41",logId:"000391"},pv:{spmId:"444.41",logId:"000391"}});var bn=vn;function yn(t){return(yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function wn(t,e){return!e||"object"!==yn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Cn(t){return(Cn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xn(t,e){return(xn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var In=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=wn(this,Cn(e).apply(this,arguments))).text="",t.voteBoxShown=!1,t.voteConfig={},t}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xn(t,e)}(e,u["c"]),n=e,(i=[{key:"onVoteIndexChanged",value:function(t){t<0?this.clearCtrl():this.updateCtrl()}},{key:"onLotteryBoxShown",value:function(t){this.bus.$emit("vote-trigger",t)}},{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.initBus()}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("text-update",function(e){t.text=e}),this.bus.$on("vote-restore",this.restoreFromDraft),this.bus.$on("vote-item-click",function(){t.voteBoxShown=!0})}},{key:"triggerVoteBoxShow",value:function(){this.voteBoxShown=!0}},{key:"onVoteCreate",value:function(t){var e=this,n=t.default_text,i=t.title,o=t.vote_id,r=this.voteConfig.vote_id===o,a=this.voteConfig.title||"";if(this.voteConfig=t,this.onVoteCancel(),r)this.bus.$emit("replace",{oldStr:"​".concat(a),newStr:"​".concat(i)}),setTimeout(function(){e.updateCtrl()});else{var s="".concat(n," ​").concat(i," ");this.bus.$emit("insert",s),setTimeout(function(){e.updateCtrl()})}}},{key:"clearCtrl",value:function(){this.voteConfig={},this.onVoteCancel(),this.bus.$emit("update-ctrl",{vote:[]}),this.bus.$emit("update-extension",{vote:null})}},{key:"updateCtrl",value:function(){var t=[{data:String(this.voteConfig.title.length+1),length:0,location:this.voteIndex,type:3}],e={vote_id:this.voteConfig.vote_id,title:this.voteConfig.title};this.bus.$emit("update-ctrl",{vote:t}),this.bus.$emit("update-extension",{vote:e})}},{key:"onVoteCancel",value:function(){this.voteBoxShown=!1}},{key:"restoreFromDraft",value:function(t){var e=t.ctrl,n=t.extension;if(e&&n){var i=e.location+1,o=Number(e.data)-1,r=this.text.substring(i,i+o);this.voteConfig={vote_id:n.vote_id,title:r}}}},{key:"voteIndex",get:function(){return this.voteConfig.title?this.text.indexOf("​".concat(this.voteConfig.title)):-1}}])&&_n(n.prototype,i),o&&_n(n,o),e}();c.a([Object(u.b)()],In.prototype,"bus",void 0),c.a([Object(u.b)()],In.prototype,"loginUid",void 0),c.a([Object(u.b)(Boolean)],In.prototype,"isPopupPanel",void 0),c.a([Object(u.d)("voteIndex")],In.prototype,"onVoteIndexChanged",null),c.a([Object(u.d)("voteBoxShown")],In.prototype,"onLotteryBoxShown",null);var kn=In=c.a([Object(u.a)({name:"vote-box",components:{Vote:bn}})],In),Sn=(n(270),Object(P.a)(kn,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"vote-box"},[e("button",{staticClass:"d-i-block bp-v-middle bp-icon-font vote-create-btn box-toggle",class:{active:this.voteBoxShown},attrs:{title:"发起投票"},on:{click:this.triggerVoteBoxShow}}),e("vote",{staticClass:"vote-popup",attrs:{show:this.voteBoxShown,config:this.voteConfig},on:{"vote-create":this.onVoteCreate,cancel:this.onVoteCancel}})],1)},[],!1,null,"e47c66e2",null).exports);n(271),n(394);function On(t){return(On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Tn(t,e){return!e||"object"!==On(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function En(t){return(En=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jn(t,e){return(jn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ln=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Tn(this,En(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jn(t,e)}(e,u["c"]),n=e,(i=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"onClick",value:function(t){this.$emit("click",t)}}])&&Pn(n.prototype,i),o&&Pn(n,o),e}(),An=Ln=c.a([Object(u.a)({name:"bp-add-button",components:{}})],Ln),Dn=(n(272),Object(P.a)(An,function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"bp-add-button",on:{click:this.onClick}},[e("i",{staticClass:"add-icon"}),this._t("default")],2)},[],!1,null,"da335d44",null).exports);function Mn(t){return(Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Rn(t,e){return!e||"object"!==Mn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bn(t){return(Bn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Un(t,e){return(Un=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Rn(this,Bn(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Un(t,e)}(e,u["c"]),n=e,(i=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"onClick",value:function(t){this.$emit("click",t)}},{key:"buttonClassArray",get:function(){var t=[];switch(this.status){case"active":t=t.concat(["active","no-border"])}return t}}])&&Nn(n.prototype,i),o&&Nn(n,o),e}();c.a([Object(u.b)(String)],Hn.prototype,"status",void 0);var $n=Hn=c.a([Object(u.a)({name:"bp-button",components:{}})],Hn),Fn=(n(273),Object(P.a)($n,function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"bp-button",class:this.buttonClassArray,on:{click:this.onClick}},[this._t("default")],2)},[],!1,null,"791cd12a",null).exports);function Vn(t){return(Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Gn(t,e){return!e||"object"!==Vn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jn(t){return(Jn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wn(t,e){return(Wn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Kn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Gn(this,Jn(e).apply(this,arguments))).isOnFocus=!1,t}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wn(t,e)}(e,u["c"]),n=e,(i=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"onInput",value:function(t){var e=t.target;this.$emit("input",e.value)}},{key:"onFocus",value:function(t){this.isOnFocus=!0,this.$emit("focus",t)}},{key:"onBlur",value:function(t){this.isOnFocus=!1,this.$emit("blur",t)}},{key:"onTextInput",value:function(t){this.$emit("textInput",t)}},{key:"onKeydown",value:function(t){this.$emit("keyDown",t)}},{key:"currentlength",get:function(){return String(this.value).length||0}}])&&zn(n.prototype,i),o&&zn(n,o),e}();c.a([Object(u.b)({type:String,default:"text"})],Kn.prototype,"type",void 0),c.a([Object(u.b)([String,Number])],Kn.prototype,"maxlength",void 0),c.a([Object(u.b)([String,Number])],Kn.prototype,"max",void 0),c.a([Object(u.b)([String,Number])],Kn.prototype,"value",void 0),c.a([Object(u.b)(String)],Kn.prototype,"placeholder",void 0);var Yn=Kn=c.a([Object(u.a)({name:"bp-input",components:{}})],Kn),qn=(n(274),Object(P.a)(Yn,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"bp-input"},["textarea"===t.type?[n("div",{staticClass:"content-box textarea-box",class:{"on-focus":t.isOnFocus}},[n("textarea",{staticClass:"textarea",attrs:{placeholder:t.placeholder,maxlength:t.maxlength},domProps:{value:t.value},on:{input:t.onInput,focus:t.onFocus,blur:t.onBlur}}),n("div",{staticClass:"indicator"},[t._v(t._s(t.currentlength)+"/"+t._s(t.maxlength))])])]:t._e(),"textarea"!==t.type?[n("div",{staticClass:"content-box input-box",class:{"on-focus":t.isOnFocus}},[t._t("prefix"),n("input",{staticClass:"input",class:"input-"+t.type,attrs:{type:t.type,placeholder:t.placeholder,maxlength:t.maxlength,max:t.max},domProps:{value:t.value},on:{input:t.onInput,textInput:t.onTextInput,keydown:t.onKeydown,focus:t.onFocus,blur:t.onBlur}}),"number"!==t.type?n("div",{staticClass:"indicator"},[t._v(t._s(t.currentlength)+"/"+t._s(t.maxlength)+"\n      ")]):t._e()],2),t._t("suffix")]:t._e()],2)},[],!1,null,"54972c91",null).exports);function Qn(t){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Zn(t,e){return!e||"object"!==Qn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ti(t){return(ti=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ei(t,e){return(ei=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ni=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Zn(this,ti(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ei(t,e)}(e,u["c"]),n=e,(i=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"onClick",value:function(t){this.$emit("click",t)}}])&&Xn(n.prototype,i),o&&Xn(n,o),e}();c.a([Object(u.b)(Boolean)],ni.prototype,"checked",void 0),c.a([Object(u.b)([String,Number,Boolean])],ni.prototype,"value",void 0),c.a([Object(u.b)(String)],ni.prototype,"name",void 0);var ii=ni=c.a([Object(u.a)({name:"bp-radio",components:{}})],ni),oi=(n(275),Object(P.a)(ii,function(){var t=this.$createElement,e=this._self._c||t;return e("label",{staticClass:"bp-radio",on:{click:this.onClick}},[e("div",{staticClass:"radio-icon",class:{checked:this.checked}}),e("input",{staticClass:"radio-input",attrs:{type:"radio",name:this.name},domProps:{value:this.value,checked:this.checked}}),this._t("default")],2)},[],!1,null,"55cdfc81",null).exports);function ri(t){return(ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ai(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function si(t,e){return!e||"object"!==ri(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ci(t){return(ci=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ui(t,e){return(ui=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var li=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),si(this,ci(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ui(t,e)}(e,u["c"]),n=e,(i=[{key:"onValueChange",value:function(t){var e=t.target;this.$emit("input",e.value)}},{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}}])&&ai(n.prototype,i),o&&ai(n,o),e}();c.a([Object(u.b)([String,Number])],li.prototype,"value",void 0),c.a([Object(u.b)(Array)],li.prototype,"options",void 0);var di=li=c.a([Object(u.a)({name:"bp-selector",components:{}})],li),fi=(n(276),Object(P.a)(di,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"bp-selector"},[n("select",{staticClass:"selector",domProps:{value:t.value},on:{change:t.onValueChange}},t._l(t.options,function(e){return n("option",{key:e.value,domProps:{value:e.value}},[t._v(t._s(e.label)+"\n    ")])}),0),n("i",{staticClass:"more-icon"})])},[],!1,null,"1d49d04b",null).exports);function pi(t){return(pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function mi(t,e){return!e||"object"!==pi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gi(t){return(gi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vi(t,e){return(vi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bi=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=mi(this,gi(e).apply(this,arguments))).formatList=["jpg","jpeg","png"],t.maxMByte=20,t.minWidth=10,t.minHeight=10,t.errorType={mbyte:"图片大小请勿超过20M",size:"图片宽高均不得小于10像素",format:"仅支持JPG PNG格式的图片"},t}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vi(t,e)}(e,u["c"]),n=e,(i=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"imageBoxUrl",value:function(){var t=this.url;return"string"==typeof t&&"loading"!==t&&"error"!==t?(t=Object(st.a)(t.replace(/^(https?:)|^(\/\/)/,""),56,56,{c:1}),"background-image: url(".concat(t,"); background-size: cover;")):""}},{key:"checkFormat",value:function(t){for(var e=0,n=this.formatList.length;e<n;e+=1)if(t.indexOf(this.formatList[e])>-1)return!0;return!1}},{key:"checkImage",value:function(t,e,n,i){return this.checkFormat(t)?Math.floor(e/1024/1024)>=this.maxMByte?this.errorType.mbyte:(n<this.minWidth||i<this.minHeight)&&this.errorType.size:this.errorType.format}},{key:"callFileDialog",value:function(){var t=this,e=document.createElement("input");e.type="file",e.accept="image/png, image/jpeg, image/jpg, image/gif",e.name="upload",e.addEventListener("change",function(e){var n=e.target||e.srcElement,i=n&&n.files||[];if(i&&i.length>0){var o=i[0],r=t.checkImage(o.type,o.size,20,20);if(r)return void t.linkMsg(null,r,"error",!0,!0);var a=new Image;a.src=window.URL?window.URL.createObjectURL(o):window.webkitURL.createObjectURL(o),a.onload=function(){var e=t.checkImage(o.type,o.size,a.width,a.height);e?t.linkMsg(null,e,"error",!0,!0):(t.$emit("loading",{index:t.index}),t.uploadImage(i[0]).then(function(e){t.$emit("success",{index:t.index,bres:e})},function(e){t.$emit("fail",{index:t.index,berr:e})}))}}}),e.click(),window.upload_input=e,e=null}},{key:"uploadImage",value:function(t){var e=new FormData;return e.append("file_up",t),e.append("biz","draw"),e.append("category","daily"),this.bpapi({url:"//api.vc.bilibili.com/api/v1/drawImage/upload",method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}})}}])&&hi(n.prototype,i),o&&hi(n,o),e}();c.a([Object(u.b)(Number)],bi.prototype,"index",void 0),c.a([Object(u.b)(String)],bi.prototype,"url",void 0);var yi=bi=c.a([Object(u.a)({name:"bp-upload",components:{}})],bi),_i=(n(277),Object(P.a)(yi,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bp-upload",on:{click:function(e){return t.callFileDialog(t.index)}}},[t.url?n("div",{staticClass:"image-box",class:t.url,style:t.imageBoxUrl(t.index)},[n("div",{staticClass:"change-tip"},[t._v("更改")])]):t._e(),t.url?t._e():n("div",{staticClass:"image-box"}),n("div",{staticClass:"bg-color"})])},[],!1,null,"17892e73",null).exports);function wi(t){return(wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ci(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function xi(t,e){return!e||"object"!==wi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ii(t){return(Ii=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ki(t,e){return(ki=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Si=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),xi(this,Ii(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ki(t,e)}(e,u["c"]),n=e,(i=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}}])&&Ci(n.prototype,i),o&&Ci(n,o),e}(),Oi=Si=c.a([Object(u.a)({name:"bp-title",components:{}})],Si),Pi=(n(278),Object(P.a)(Oi,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("div",{staticClass:"title-content"},[this._t("default")],2),e("div",{staticClass:"slot-right"},[this._t("right")],2)])},[],!1,null,"28adec7b",null).exports);function Ti(t){return(Ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ei(t,e,n){return(Ei=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&Ni(o,n.prototype),o}).apply(null,arguments)}function ji(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Li(t,e,n,i,o,r,a){try{var s=t[r](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}function Ai(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Di(t,e){return!e||"object"!==Ti(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mi(t){return(Mi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ni(t,e){return(Ni=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ri={dynamic:1,comment:9,article:64,archive:8},Bi=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Di(this,Mi(e).apply(this,arguments))).loaded=!1,t.maxCount=100,t.isSpecial=!1,t.lid=0,t.atConfig=0,t.followList=[{name:"不限制",value:0},{name:"关注我",value:1}],t.followConfig=1,t.prizeCount=1,t.firstPrizeNum="",t.secondPrizeNum="",t.thirdPrizeNum="",t.firstPrizeInfo={needMail:"",desc:"",imgUrl:""},t.secondPrizeInfo={needMail:"",desc:"",imgUrl:""},t.thirdPrizeInfo={needMail:"",desc:"",imgUrl:""},t.mailRadioList=[{name:"需邮寄",value:!0},{name:"不需邮寄",value:!1}],t.time=null,t.errorList=[],t.formatList=["jpg","jpeg","png"],t.maxMByte=20,t.minWidth=10,t.minHeight=10,t.errorType={mbyte:"图片大小请勿超过20M",size:"图片宽高均不得小于10像素",format:"仅支持JPG PNG格式的图片"},t.maxTimes=1,t.lotteryTimes=0,t.minDatetime="",t.maxDatetime="",t.realShow=!1,t.datePickerMinDate=Date.now()+3e5,t.datePickerMaxDate=Date.now()+7776e6,t.updateTimePid=0,t.datePickerShown=!0,t}var n,i,o,r,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ni(t,e)}(e,u["c"]),n=e,(i=[{key:"onShowChange",value:function(t){var e=this;t?this.fetchLotteryTimes().then(function(){e.haveLeftTimes?(e.realShow=t,e.init()):(e.linkMsg(null,"本月您发起抽奖次数已达到上限\n（每月上限为1次），下月再来吧~","error",!0,!0),e.onCancel())}).catch(function(){e.linkMsg(null,"本月您发起抽奖次数已达到上限\n（每月上限为1次），下月再来吧~","error",!0,!0),e.onCancel()}):this.realShow=t}},{key:"onConfigChange",value:function(){this.init()}},{key:"created",value:function(){var t=this;this.updateTimePid=setInterval(function(){t.datePickerMinDate=Date.now()+3e5,t.datePickerMaxDate=Date.now()+7776e6},6e4)}},{key:"beforeDestroy",value:function(){clearInterval(this.updateTimePid)}},{key:"mounted",value:(r=pt.a.mark(function t(){var e,n;return pt.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.updateMinMaxDatetime(),t.next=3,Object(st.d)(!1);case 3:e=t.sent,"208259"!==(n=String(e.mid))&&"167388493"!==n&&"6810576"!==n||(this.maxCount=1e4,this.isSpecial=!0),this.isFromComment&&(this.followConfig=0);case 7:case"end":return t.stop()}},t,this)}),a=function(){var t=this,e=arguments;return new Promise(function(n,i){var o=r.apply(t,e);function a(t){Li(o,n,i,a,s,"next",t)}function s(t){Li(o,n,i,a,s,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"init",value:function(){var t=this;this.config&&this.config.lottery_id?(this.lid=this.config.lottery_id,this.bpapi({method:"get",url:"//api.vc.bilibili.com/lottery_svr/v1/lottery_svr/lottery_notice",data:{lottery_id:this.lid}}).then(function(e){var n=e.data;t.followConfig=n.lottery_feed_limit,t.firstPrizeNum=n.first_prize,t.secondPrizeNum=n.second_prize,t.thirdPrizeNum=n.third_prize,t.firstPrizeInfo={needMail:!!(1&n.need_post),desc:n.first_prize_cmt,imgUrl:n.first_prize_pic},t.secondPrizeInfo={needMail:!!(2&n.need_post),desc:n.second_prize_cmt,imgUrl:n.second_prize_pic},t.thirdPrizeInfo={needMail:!!(4&n.need_post),desc:n.third_prize_cmt,imgUrl:n.third_prize_pic},t.prizeCount=1,Number(t.secondPrizeNum)>0&&(t.prizeCount+=1),Number(t.thirdPrizeNum)>0&&(t.prizeCount+=1)},function(e){var n="电波无法到达~ ".concat(e.code);t.linkMsg(null,e.msg||n,"error",!0,!0),window.console.error(e)})):(this.clear(),this.resetDatetime())}},{key:"clear",value:function(){this.followConfig=1,this.prizeCount=1,this.firstPrizeNum="",this.secondPrizeNum="",this.thirdPrizeNum="",this.lid=0,this.firstPrizeInfo={needMail:"",desc:"",imgUrl:""},this.secondPrizeInfo={needMail:"",desc:"",imgUrl:""},this.thirdPrizeInfo={needMail:"",desc:"",imgUrl:""}}},{key:"getRealDate",value:function(t){if("string"==typeof t){var e=t.split(/-|T|:/g);return e[1]=String(parseInt(e[1],10)-1),Ei(Date,ji(e))}return new Date(t)}},{key:"toISOString",value:function(t,e){var n=new Date;return t&&(n=this.getRealDate(t)),new Date(n.getTime()-6e4*n.getTimezoneOffset()+e).toISOString().match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}/)[0]}},{key:"updateMinMaxDatetime",value:function(){this.minDatetime=this.toISOString(0,3e5),this.maxDatetime=this.toISOString(0,7776e6)}},{key:"resetDatetime",value:function(){var t=this;this.time=null,this.datePickerShown=!1,setTimeout(function(){t.datePickerShown=!0},0)}},{key:"setFollowValue",value:function(t){this.followConfig=t.value}},{key:"setPrizeRadio",value:function(t,e){this[t].needMail=e.value}},{key:"addPrize",value:function(){this.prizeCount+=1}},{key:"deletePrize",value:function(t){2===t&&2===this.prizeCount?(this.secondPrizeNum="",this.secondPrizeInfo={needMail:"",desc:"",imgUrl:""},this.thirdPrizeNum="",this.thirdPrizeInfo={needMail:"",desc:"",imgUrl:""}):2===t&&3===this.prizeCount?(this.secondPrizeNum=this.thirdPrizeNum,this.secondPrizeInfo=this.thirdPrizeInfo,this.thirdPrizeNum="",this.thirdPrizeInfo={needMail:"",desc:"",imgUrl:""}):3===t&&(this.thirdPrizeNum="",this.thirdPrizeInfo={needMail:"",desc:"",imgUrl:""}),this.prizeCount-=1}},{key:"onDatetimeOnChange",value:function(){return this.updateMinMaxDatetime(),!this.time||this.time.getTime()<this.getRealDate(this.minDatetime).getTime()?(this.linkMsg(null,"开奖不可早于当前时间后5分钟","info",!0,!0),!1):!(this.time.getTime()>this.getRealDate(this.maxDatetime).getTime()&&(this.linkMsg(null,"最长可设置90天后","info",!0,!0),1))}},{key:"onNumberBlur",value:function(){(Number(this.firstPrizeNum)||0)>this.maxCount?(this.firstPrizeNum=this.maxCount,this.linkMsg(null,"最大可设置为".concat(this.maxCount),"info",!0,!0)):(Number(this.firstPrizeNum)||0)<=0&&(this.firstPrizeNum=""),this.prizeCount>1&&(Number(this.secondPrizeNum)||0)>this.maxCount?(this.secondPrizeNum=this.maxCount,this.linkMsg(null,"最大可设置为".concat(this.maxCount),"info",!0,!0)):this.prizeCount>1&&(Number(this.secondPrizeNum)||0)<=0&&(this.secondPrizeNum=""),this.prizeCount>2&&(Number(this.thirdPrizeNum)||0)>this.maxCount?(this.thirdPrizeNum=this.maxCount,this.linkMsg(null,"最大可设置为".concat(this.maxCount),"info",!0,!0)):this.prizeCount>2&&(Number(this.thirdPrizeNum)||0)<=0&&(this.thirdPrizeNum="")}},{key:"onTextInput",value:function(t){Number(t.data)||0===t.data||"0"===t.data||t.preventDefault()}},{key:"onKeyDown",value:function(t){"ArrowDown"!==t.key&&"ArrowUp"!==t.key||t.preventDefault()}},{key:"filterImgError",value:function(t){return"loading"===t||"error"===t?"":t}},{key:"fetchLotteryTimes",value:function(){var t=this,e={business_type:Ri[this.from]||1};return this.bpapi({method:"get",url:"//api.vc.bilibili.com/lottery_svr/v1/lottery_svr/query_lottery_times",data:e}).then(function(e){t.loaded=!0,t.lotteryTimes=e.data.lottery_times,t.maxTimes=e.data.max_times,t.lotteryTimes>=t.maxTimes&&t.$router.replace("/noTimes")}).catch(function(){t.loaded=!0})}},{key:"onSubmit",value:function(t){if(this.isActive){if(!0!==t){if(!this.isActive)return;if(!this.onDatetimeOnChange())return}var e=this;this.bpPopup({title:"本月还剩".concat(e.maxTimes-e.lotteryTimes,"次发布抽奖机会，确认发起抽奖吗？"),content:"发起抽奖动态将消耗1次抽奖机会",button:{confirm:"发起抽奖",cancel:"取消"}}).onConfirm(function(t){e.doSubmit(),t.close()}).onCancel(function(t){t.close()})}else{var n=this.errorList[0];this.linkMsg(null,n||"请检查您所填写的全部内容","success",!0,!0)}}},{key:"doSubmit",value:function(){var t=this,e=0;this.firstPrizeInfo.needMail&&(e+=1),this.secondPrizeInfo.needMail&&(e+=2),this.thirdPrizeInfo.needMail&&(e+=4);var n={at_num:parseInt(String(this.atConfig),10),feed_limit:parseInt(String(this.followConfig),10),first_prize:parseInt(String(this.firstPrizeNum),10)||void 0,second_prize:parseInt(String(this.secondPrizeNum),10)||void 0,third_prize:parseInt(String(this.thirdPrizeNum),10)||void 0,lottery_time:this.getRealDate(this.time).getTime()/1e3,need_post:e,first_prize_cmt:this.firstPrizeInfo.desc||void 0,second_prize_cmt:this.secondPrizeInfo.desc||void 0,third_prize_cmt:this.thirdPrizeInfo.desc||void 0,first_prize_pic:this.filterImgError(this.firstPrizeInfo.imgUrl)||void 0,second_prize_pic:this.filterImgError(this.secondPrizeInfo.imgUrl)||void 0,third_prize_pic:this.filterImgError(this.thirdPrizeInfo.imgUrl)||void 0,business_type:Ri[this.from]||1},i="create";this.lid&&(n.lottery_id=this.lid,i="update"),this.bpapi({method:"post",url:"//api.vc.bilibili.com/lottery_svr/v1/lottery_svr/".concat(i,"_lottery"),data:n}).then(function(e){var i={lottery_id:e.data.lottery_id,lottery_time:n.lottery_time,title:t.isFromComment?"评论抽奖":"互动抽奖"};t.$emit("lottery-create",i)},function(e){var n="";n=4100003===e.code?"本月您发起抽奖次数已达到上限\n（每月上限为1次），下月再来吧~":e.msg,t.linkMsg(null,n||e.msg,"error",!0,!0),window.console.error(e)})}},{key:"onCancel",value:function(){this.$emit("cancel")}},{key:"onImgLoading",value:function(t,e){this[e].imgUrl="loading"}},{key:"onImgSuccess",value:function(t,e){var n=t.bres;this[e].imgUrl=n.data.image_url,this.$forceUpdate();var i=this.errorList;this.errorList=[],this.errorList=i}},{key:"onImgFail",value:function(t,e){var n=t.berr;this[e].imgUrl="error",this.$forceUpdate(),this.linkMsg(null,"".concat(n.msg," ").concat(n.code),"error",!0,!0)}},{key:"deleteImg",value:function(t){this[t].imgUrl="",this.$forceUpdate()}},{key:"haveLeftTimes",get:function(){return this.lotteryTimes<this.maxTimes}},{key:"isActive",get:function(){var t=[];return this.haveLeftTimes||t.push("本月您发起抽奖次数已达到上限\n（每月上限为1次），下月再来吧~"),(1===this.prizeCount&&(Number(this.firstPrizeNum)<1||Number(this.firstPrizeNum)>this.maxCount)||2===this.prizeCount&&(Number(this.secondPrizeNum)<1||Number(this.secondPrizeNum)>this.maxCount)||3===this.prizeCount&&(Number(this.thirdPrizeNum)<1||Number(this.thirdPrizeNum)>this.maxCount))&&t.push("获奖人数最少1人，最多".concat(this.maxCount,"人")),(1===this.prizeCount&&""===this.firstPrizeInfo.needMail||2===this.prizeCount&&""===this.secondPrizeInfo.needMail||3===this.prizeCount&&""===this.thirdPrizeInfo.needMail)&&t.push("请选择奖品发放方式"),(1===this.prizeCount&&!this.firstPrizeInfo.desc||2===this.prizeCount&&!this.secondPrizeInfo.desc||3===this.prizeCount&&!this.thirdPrizeInfo.desc)&&t.push("请填写奖品描述"),this.errorList=t,!!(1===this.prizeCount&&Number(this.firstPrizeNum)>0&&Number(this.firstPrizeNum)<=this.maxCount&&""!==this.firstPrizeInfo.needMail&&this.firstPrizeInfo.desc&&this.haveLeftTimes)||!!(2===this.prizeCount&&Number(this.firstPrizeNum)>0&&Number(this.firstPrizeNum)<=this.maxCount&&""!==this.firstPrizeInfo.needMail&&this.firstPrizeInfo.desc&&Number(this.secondPrizeNum)>0&&Number(this.secondPrizeNum)<=this.maxCount&&""!==this.secondPrizeInfo.needMail&&this.secondPrizeInfo.desc&&this.haveLeftTimes)||!!(3===this.prizeCount&&Number(this.firstPrizeNum)>0&&Number(this.firstPrizeNum)<=this.maxCount&&""!==this.firstPrizeInfo.needMail&&this.firstPrizeInfo.desc&&Number(this.secondPrizeNum)>0&&Number(this.secondPrizeNum)<=this.maxCount&&""!==this.secondPrizeInfo.needMail&&this.secondPrizeInfo.desc&&Number(this.thirdPrizeNum)>0&&Number(this.thirdPrizeNum)<=this.maxCount&&""!==this.thirdPrizeInfo.needMail&&this.thirdPrizeInfo.desc&&this.haveLeftTimes)}},{key:"prizeNumPlaceholder",get:function(){return"最多".concat(this.maxCount,"人")}},{key:"isFromComment",get:function(){return"comment"===this.from}},{key:"conditionDetail",get:function(){return this.isFromComment?"评论稿件即可参与抽奖":"转发本动态，并符合下列条件可参与抽奖"}},{key:"zIndexStyle",get:function(){return"z-index: ".concat(this.zIndex||2,";")}}])&&Ai(n.prototype,i),o&&Ai(n,o),e}();c.a([Object(u.b)(Number)],Bi.prototype,"zIndex",void 0),c.a([Object(u.b)(Object)],Bi.prototype,"config",void 0),c.a([Object(u.b)(Boolean)],Bi.prototype,"show",void 0),c.a([Object(u.b)({type:String,default:function(){return"dynamic"}})],Bi.prototype,"from",void 0),c.a([Object(u.d)("show")],Bi.prototype,"onShowChange",null),c.a([Object(u.d)("config")],Bi.prototype,"onConfigChange",null);var Ui=Bi=c.a([Object(u.a)({name:"create",components:{BpAddButton:Dn,BpButton:Fn,BpInput:qn,BpRadio:oi,BpSelector:fi,BpUpload:_i,BpTitle:Pi,DatePicker:$}})],Bi),Hi=(n(279),Object(P.a)(Ui,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bp-lottery-container"},[n("transition",{attrs:{name:"move-in"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.realShow,expression:"realShow"}],staticClass:"create-lottery",style:t.zIndexStyle},[n("div",{staticClass:"main-content"},[n("div",{staticClass:"group"},[n("div",{staticClass:"tip condition-title"},[t._v(t._s(t.conditionDetail))]),n("bp-title",{staticClass:"condition-title"},[n("span",[t._v("关注条件")]),t._l(t.followList,function(e){return n("bp-radio",{key:e.value,attrs:{slot:"right",checked:e.value===t.followConfig,value:e.value,name:"follow-config"},on:{click:function(n){return t.setFollowValue(e)}},slot:"right"},[t._v("\n              "+t._s(e.name)+"\n            ")])})],2)],1),n("div",{staticClass:"group"},[t.prizeCount>1?n("bp-title",[n("span",{staticClass:"bold-title"},[t._v("一等奖")])]):t._e(),n("bp-title",[n("div",[n("span",[t._v("获奖人数")]),n("div",{staticClass:"tip"},[t._v(t._s(t.prizeNumPlaceholder))])]),n("template",{slot:"right"},[n("bp-input",{staticClass:"number-input",attrs:{type:"number",max:t.maxCount,placeholder:"0"},on:{blur:t.onNumberBlur,textInput:t.onTextInput,keyDown:t.onKeyDown},model:{value:t.firstPrizeNum,callback:function(e){t.firstPrizeNum=e},expression:"firstPrizeNum"}}),t._v("\n              人\n            ")],1)],2),n("bp-title",[n("span",[t._v("奖品发放")]),t._l(t.mailRadioList,function(e){return n("bp-radio",{key:e.value,attrs:{slot:"right",checked:e.value===t.firstPrizeInfo.needMail,value:e.value,name:"first-prize-radio"},on:{click:function(n){return t.setPrizeRadio("firstPrizeInfo",e)}},slot:"right"},[t._v("\n              "+t._s(e.name)+"\n            ")])})],2),n("bp-title",[n("span",[t._v("奖品描述")]),n("bp-input",{attrs:{slot:"right",type:"text",maxlength:20,placeholder:"奖品描述信息"},slot:"right",model:{value:t.firstPrizeInfo.desc,callback:function(e){t.$set(t.firstPrizeInfo,"desc",e)},expression:"firstPrizeInfo.desc"}})],1),n("bp-title",[n("div",[n("span",[t._v("奖品图片")]),n("div",{staticClass:"tip"},[t._v("可选")])]),n("template",{slot:"right"},[n("bp-upload",{attrs:{url:t.firstPrizeInfo.imgUrl},on:{loading:function(e){return t.onImgLoading(e,"firstPrizeInfo")},success:function(e){return t.onImgSuccess(e,"firstPrizeInfo")},fail:function(e){return t.onImgFail(e,"firstPrizeInfo")}}}),t.firstPrizeInfo.imgUrl?n("button",{staticClass:"delete-button",on:{click:function(e){return t.deleteImg("firstPrizeInfo")}}},[t._v("删除\n              ")]):t._e()],1)],2)],1),t.prizeCount>1?n("div",{staticClass:"group"},[n("bp-title",[n("span",{staticClass:"bold-title"},[t._v("二等奖")]),n("div",{staticClass:"delete-button-box",attrs:{slot:"right"},slot:"right"},[n("button",{staticClass:"delete-button",on:{click:function(e){return t.deletePrize(2)}}},[t._v("删除奖项\n              ")])])]),n("bp-title",[n("div",[n("span",[t._v("获奖人数")]),n("div",{staticClass:"tip"},[t._v(t._s(t.prizeNumPlaceholder))])]),n("template",{slot:"right"},[n("bp-input",{staticClass:"number-input",attrs:{type:"number",max:t.maxCount,placeholder:"0"},on:{blur:t.onNumberBlur,textInput:t.onTextInput,keyDown:t.onKeyDown},model:{value:t.secondPrizeNum,callback:function(e){t.secondPrizeNum=e},expression:"secondPrizeNum"}}),t._v("\n              人\n            ")],1)],2),n("bp-title",[n("span",[t._v("奖品发放")]),t._l(t.mailRadioList,function(e){return n("bp-radio",{key:e.value,attrs:{slot:"right",checked:e.value===t.secondPrizeInfo.needMail,value:e.value,name:"second-prize-radio"},on:{click:function(n){return t.setPrizeRadio("secondPrizeInfo",e)}},slot:"right"},[t._v("\n              "+t._s(e.name)+"\n            ")])})],2),n("bp-title",[n("span",[t._v("奖品描述")]),n("bp-input",{attrs:{slot:"right",type:"text",maxlength:20,placeholder:"奖品描述信息"},slot:"right",model:{value:t.secondPrizeInfo.desc,callback:function(e){t.$set(t.secondPrizeInfo,"desc",e)},expression:"secondPrizeInfo.desc"}})],1),n("bp-title",[n("div",[n("span",[t._v("奖品图片")]),n("div",{staticClass:"tip"},[t._v("可选")])]),n("template",{slot:"right"},[n("bp-upload",{attrs:{slot:"right",url:t.secondPrizeInfo.imgUrl},on:{loading:function(e){return t.onImgLoading(e,"secondPrizeInfo")},success:function(e){return t.onImgSuccess(e,"secondPrizeInfo")},fail:function(e){return t.onImgFail(e,"secondPrizeInfo")}},slot:"right"}),t.secondPrizeInfo.imgUrl?n("button",{staticClass:"delete-button",on:{click:function(e){return t.deleteImg("secondPrizeInfo")}}},[t._v("删除\n              ")]):t._e()],1)],2)],1):t._e(),t.prizeCount>2?n("div",{staticClass:"group"},[n("bp-title",[n("span",{staticClass:"bold-title"},[t._v("三等奖")]),n("div",{staticClass:"delete-button-box",attrs:{slot:"right"},slot:"right"},[n("button",{staticClass:"delete-button",on:{click:function(e){return t.deletePrize(3)}}},[t._v("删除奖项\n              ")])])]),n("bp-title",[n("div",[n("span",[t._v("获奖人数")]),n("div",{staticClass:"tip"},[t._v(t._s(t.prizeNumPlaceholder))])]),n("template",{slot:"right"},[n("bp-input",{staticClass:"number-input",attrs:{type:"number",max:t.maxCount,placeholder:"0"},on:{blur:t.onNumberBlur,textInput:t.onTextInput,keyDown:t.onKeyDown},model:{value:t.thirdPrizeNum,callback:function(e){t.thirdPrizeNum=e},expression:"thirdPrizeNum"}}),t._v("\n              人\n            ")],1)],2),n("bp-title",[n("span",[t._v("奖品发放")]),t._l(t.mailRadioList,function(e){return n("bp-radio",{key:e.value,attrs:{slot:"right",checked:e.value===t.thirdPrizeInfo.needMail,value:e.value,name:"third-prize-radio"},on:{click:function(n){return t.setPrizeRadio("thirdPrizeInfo",e)}},slot:"right"},[t._v("\n              "+t._s(e.name)+"\n            ")])})],2),n("bp-title",[n("span",[t._v("奖品描述")]),n("bp-input",{attrs:{slot:"right",type:"text",maxlength:20,placeholder:"奖品描述信息"},slot:"right",model:{value:t.thirdPrizeInfo.desc,callback:function(e){t.$set(t.thirdPrizeInfo,"desc",e)},expression:"thirdPrizeInfo.desc"}})],1),n("bp-title",[n("div",[n("span",[t._v("奖品图片")]),n("div",{staticClass:"tip"},[t._v("可选")])]),n("template",{slot:"right"},[n("bp-upload",{attrs:{slot:"right",url:t.thirdPrizeInfo.imgUrl},on:{loading:function(e){return t.onImgLoading(e,"thirdPrizeInfo")},success:function(e){return t.onImgSuccess(e,"thirdPrizeInfo")},fail:function(e){return t.onImgFail(e,"thirdPrizeInfo")}},slot:"right"}),t.thirdPrizeInfo.imgUrl?n("button",{staticClass:"delete-button",on:{click:function(e){return t.deleteImg("thirdPrizeInfo")}}},[t._v("删除\n              ")]):t._e()],1)],2)],1):t._e(),n("div",{staticClass:"group no-border"},[t.prizeCount<3?n("bp-add-button",{on:{click:t.addPrize}},[t._v("添加选项\n          ")]):t._e(),n("div",{staticClass:"tip button-tip"},[t._v("\n            最多支持3个奖项，每个奖项人数最多100人\n            "),n("br"),t._v("\n            奖品选择需邮寄的，发奖人可在抽奖结果页面查看中奖人收货地址\n          ")])],1),t.datePickerShown?n("div",{staticClass:"group datepicker-minheight"},[n("bp-title",{staticClass:"datepicker-aligntop"},[n("span",{staticClass:"datepicker-title"},[t._v("开奖时间")]),n("div",{attrs:{slot:"right"},slot:"right"},[n("date-picker",{attrs:{min:new Date(t.datePickerMinDate),max:new Date(t.datePickerMaxDate)},on:{change:t.onDatetimeOnChange},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}}),n("div",{staticClass:"tip button-tip"},[t._v("\n                开奖后将自动通过该账号发布开奖公示动态，并通过私信提醒中奖用户\n              ")])],1)])],1):t._e()]),n("div",{staticClass:"button-bar"},[n("bp-button",{on:{click:t.onCancel}},[t._v("取消")]),n("bp-button",{attrs:{status:t.isActive?"active":"disable"},on:{click:t.onSubmit}},[t._v(t._s(t.lid?"更新抽奖":"发起抽奖")+"\n        ")])],1)])])],1)},[],!1,null,"917101c4",null).exports);o.a.use(Object(r.a)()),o.a.use(s.b),o.a.use(a.a);var $i=Hi;function Fi(t){return(Fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function zi(t,e){return!e||"object"!==Fi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gi(t){return(Gi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ji(t,e){return(Ji=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wi=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=zi(this,Gi(e).apply(this,arguments))).text="",t.lotteryBoxShown=!1,t.lotteryConfig={},t}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ji(t,e)}(e,u["c"]),n=e,(i=[{key:"onLotteryIndexChanged",value:function(t){t<0?this.clearCtrl():this.updateCtrl()}},{key:"onLotteryBoxShown",value:function(t){this.bus.$emit("lottery-trigger",t)}},{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.initBus()}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("text-update",function(e){t.text=e}),this.bus.$on("lottery-restore",this.restoreFromDraft),this.bus.$on("lottery-item-click",function(){t.lotteryBoxShown=!0})}},{key:"triggerLotteryBoxShow",value:function(){this.lotteryBoxShown=!0}},{key:"onLotteryCreate",value:function(t){var e=this,n=this.lotteryConfig.lottery_id===t.lottery_id;this.lotteryConfig=t,this.onLotteryCancel();var i=t.title;if(!n){var o="​".concat(i," ");this.bus.$emit("insert",o),setTimeout(function(){e.updateCtrl()})}}},{key:"clearCtrl",value:function(){this.lotteryConfig={},this.onLotteryCancel(),this.bus.$emit("update-ctrl",{lottery:[]}),this.bus.$emit("update-extension",{lottery:null})}},{key:"updateCtrl",value:function(){var t=[{data:String(this.lotteryConfig.title.length+1),length:0,location:this.lotteryIndex,type:2}],e={lottery_id:this.lotteryConfig.lottery_id};this.bus.$emit("update-ctrl",{lottery:t}),this.bus.$emit("update-extension",{lottery:e})}},{key:"onLotteryCancel",value:function(){this.lotteryBoxShown=!1}},{key:"restoreFromDraft",value:function(t){var e=t.ctrl,n=t.extension;if(e&&n){var i=e.location+1,o=Number(e.data)-1,r=this.text.substring(i,i+o);this.lotteryConfig={lottery_id:n.lottery_id,title:r}}}},{key:"lotteryIndex",get:function(){return this.lotteryConfig.title?this.text.indexOf("​".concat(this.lotteryConfig.title)):-1}}])&&Vi(n.prototype,i),o&&Vi(n,o),e}();c.a([Object(u.b)()],Wi.prototype,"bus",void 0),c.a([Object(u.b)()],Wi.prototype,"loginUid",void 0),c.a([Object(u.b)(Boolean)],Wi.prototype,"isPopupPanel",void 0),c.a([Object(u.d)("lotteryIndex")],Wi.prototype,"onLotteryIndexChanged",null),c.a([Object(u.d)("lotteryBoxShown")],Wi.prototype,"onLotteryBoxShown",null);var Ki=Wi=c.a([Object(u.a)({name:"lottery-box",components:{Lottery:$i}})],Wi),Yi=(n(280),Object(P.a)(Ki,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"lottery-box"},[e("button",{staticClass:"d-i-block bp-v-middle bp-icon-font lottery-create-btn box-toggle",class:{active:this.lotteryBoxShown},attrs:{title:"发起抽奖"},on:{click:this.triggerLotteryBoxShow}}),e("lottery",{staticClass:"lottery-popup",attrs:{show:this.lotteryBoxShown,config:this.lotteryConfig},on:{"lottery-create":this.onLotteryCreate,cancel:this.onLotteryCancel}})],1)},[],!1,null,"309d9658",null).exports);function qi(t){return(qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Xi(t,e){return!e||"object"!==qi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zi(t){return(Zi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function to(t,e){return(to=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var eo=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Xi(this,Zi(e).apply(this,arguments))).scheduleBarShow=!1,t.schPubTipsVisable=!1,t}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&to(t,e)}(e,u["c"]),n=e,(i=[{key:"onScheduleBarShow",value:function(t,e){t!==e&&this.bus.$emit("schedule-trigger",t)}},{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.initBus()}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){this.scheduledPublishTips()}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("schedule-trigger",function(e){t.scheduleBarShow=e})}},{key:"triggerSchedule",value:function(){if(this.isLockedAsScheduled)this.scheduleBarShow=!0;else{this.scheduleBarShow=!this.scheduleBarShow;var t=this.editDraft?2:this.isPopupPanel?1:0;Object(wt.d)(Ct.d.TIMER_ICON,t)}}},{key:"scheduledPublishTips",value:function(){var t=this;"undefined"!=typeof window&&"true"!==window.localStorage.getItem("dynamic_scheduled_publish_intro_".concat(this.loginUid))&&(t.schPubTipsVisable=!0,window.localStorage.setItem("dynamic_scheduled_publish_intro_".concat(t.loginUid),String(!0)),setTimeout(function(){t.schPubTipsVisable=!1},5e3))}}])&&Qi(n.prototype,i),o&&Qi(n,o),e}();c.a([Object(u.b)()],eo.prototype,"bus",void 0),c.a([Object(u.b)()],eo.prototype,"loginUid",void 0),c.a([Object(u.b)()],eo.prototype,"isLockedAsScheduled",void 0),c.a([Object(u.b)(Boolean)],eo.prototype,"isPopupPanel",void 0),c.a([Object(u.b)()],eo.prototype,"editDraft",void 0),c.a([Object(u.d)("scheduleBarShow")],eo.prototype,"onScheduleBarShow",null);var no=eo=c.a([Object(u.a)({name:"schedule-btn",components:{}})],eo),io=(n(281),Object(P.a)(no,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"schedule-btn"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.schPubTipsVisable,expression:"schPubTipsVisable"}],staticClass:"sch-pub-tips"},[n("span",[t._v("可以设置定时发布动态啦")]),n("i",{staticClass:"bp-icon-font icon-group-dynamic",on:{click:function(e){t.schPubTipsVisable=!1}}})]),n("button",{staticClass:"d-i-block bp-v-middle bp-icon-font icon-ic_timer box-toggle",class:{active:t.scheduleBarShow},attrs:{title:"定时发布"},on:{click:t.triggerSchedule}})])},[],!1,null,"3a26abfb",null).exports);function oo(t){return(oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ro(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ao(t,e){return!e||"object"!==oo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function so(t){return(so=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function co(t,e){return(co=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var uo=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ao(this,so(e).apply(this,arguments))).lotteryBoxShown=!1,t.voteBoxShown=!1,t.ifShowScheduleBar=!1,t.hasLottery=!1,t.hasVote=!1,t.hasSchedule=!1,t}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&co(t,e)}(e,u["c"]),n=e,(i=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.initBus()}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("lottery-trigger",function(e){t.lotteryBoxShown=e}),this.bus.$on("vote-trigger",function(e){t.voteBoxShown=e}),this.bus.$on("schedule-trigger",function(e){t.ifShowScheduleBar=e}),this.bus.$on("has-lottery",function(e){t.hasLottery=e}),this.bus.$on("has-vote",function(e){t.hasVote=e})}},{key:"showLotteryBtn",get:function(){return this.canLottery&&!this.ifShowScheduleBar}},{key:"showVoteBtn",get:function(){return this.canVote&&!this.ifShowScheduleBar}},{key:"showScheduleBtn",get:function(){return this.canBeScheduled&&!(this.lotteryBoxShown||this.voteBoxShown||this.hasVote||this.hasLottery)}}])&&ro(n.prototype,i),o&&ro(n,o),e}();c.a([Object(u.b)()],uo.prototype,"bus",void 0),c.a([Object(u.b)()],uo.prototype,"loginUid",void 0),c.a([Object(u.b)(Boolean)],uo.prototype,"canLottery",void 0),c.a([Object(u.b)(Boolean)],uo.prototype,"canVote",void 0),c.a([Object(u.b)(Boolean)],uo.prototype,"canBeScheduled",void 0),c.a([Object(u.b)()],uo.prototype,"isLockedAsScheduled",void 0),c.a([Object(u.b)(Boolean)],uo.prototype,"isPopupPanel",void 0),c.a([Object(u.b)()],uo.prototype,"editDraft",void 0);var lo=uo=c.a([Object(u.a)({name:"toolbar",components:{Emoji:ot,ImageBox:Et,AtBox:Vt,TopicBox:ie,VoteBox:Sn,LotteryBox:Yi,ScheduleBtn:io}})],uo),fo=(n(282),Object(P.a)(lo,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"toolbar-box"},[n("emoji",{staticClass:"toolbar-item",attrs:{bus:t.bus,"login-uid":t.loginUid}}),n("image-box",{staticClass:"toolbar-item",attrs:{"is-popup-panel":t.isPopupPanel,bus:t.bus,"login-uid":t.loginUid}}),n("at-box",{staticClass:"toolbar-item",attrs:{"is-popup-panel":t.isPopupPanel,bus:t.bus,"login-uid":t.loginUid}}),n("topic-box",{staticClass:"toolbar-item",attrs:{"is-popup-panel":t.isPopupPanel,bus:t.bus,"login-uid":t.loginUid}}),t.showVoteBtn?n("vote-box",{staticClass:"toolbar-item",attrs:{"is-popup-panel":t.isPopupPanel,bus:t.bus,"login-uid":t.loginUid}}):t._e(),t.showLotteryBtn?n("lottery-box",{staticClass:"toolbar-item",attrs:{"is-popup-panel":t.isPopupPanel,bus:t.bus,"login-uid":t.loginUid}}):t._e(),t.showScheduleBtn?n("schedule-btn",{staticClass:"toolbar-item",attrs:{"is-popup-panel":t.isPopupPanel,"is-locked-as-scheduled":t.isLockedAsScheduled,"edit-draft":t.editDraft,bus:t.bus,"login-uid":t.loginUid}}):t._e()],1)},[],!1,null,"144da048",null).exports),po=(n(58),n(395),n(51)),ho={},mo=(n(283),Object(P.a)(ho,function(){var t=this.$createElement;this._self._c;return this._m(0)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"specification p-rel"},[e("iframe",{staticClass:"iframe",attrs:{src:"//t.bilibili.com/h5/dynamic/specification"}})])}],!1,null,"2fd23f66",null).exports);function go(t){return(go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{i||null==s.return||s.return()}finally{if(o)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function bo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function yo(t,e){return!e||"object"!==go(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _o(t){return(_o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wo(t,e){return(wo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Co=1,xo=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=yo(this,_o(e).apply(this,arguments))).publishTime=new Date,t.text="",t.ctrlObj={},t.ctrlKeys=["at","vote","lottery"],t.extensionObj={},t.extendCtrlJson="{}",t.isPublishing=!1,t.specificationShown=!1,t.specificationAgreed=!1,t.schConfirmVisible=!1,t.isScheduled=Boolean(t.editDraft||t.isLockedAsScheduled),t.imageList=[],t.textPublishParam={},t.albumPublishParam={},t.schConfirmText="",t.articleMinTextCount=400,t.articleMaxTextCount=2e4,t.articlePubConfirmVisible=!1,t.articlePubTipsVisable=!1,t}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wo(t,e)}(e,u["c"]),n=e,(i=[{key:"onExtendCtrlJson",value:function(t){this.bus.$emit("extend-json-changed",t)}},{key:"onLockedAsScheduledChange",value:function(t){this.isScheduled=!!t}},{key:"onScheduleModeChange",value:function(t){var e=this.editDraft?2:this.isPopupPanel?1:0;Object(wt.d)(Ct.d.TIMER_ICON,e),this.isScheduled=t}},{key:"onLoginUidChange",value:function(){this.initLocalStorage(),this.onTopicPageInit(),this.checkSpecification(),this.scheduleEditDraftRecovery()}},{key:"onPublishImageListChange",value:function(){this.debounceGenerateExtendCtrlJson()}},{key:"onPublishTime",value:function(t){this.bus.$emit("schedule-time-update",t)}},{key:"onIfShowArticleBtn",value:function(t){t&&(this.checkIfShowArticlePubTips(),this.articlePubShowReport())}},{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.debounceGenerateExtendCtrlJson=Object(m.b)(this.generateExtendCtrlJson,1),this.initBus()}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){this.initLocalStorage(),this.onTopicPageInit(),this.checkSpecification(),this.scheduleEditDraftRecovery(),this.getArticleMaxLength()}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("schedule-time-update",function(e){t.publishTime=e}),this.bus.$on("update-ctrl",function(e){t.ctrlKeys.forEach(function(n){e[n]&&e[n]instanceof Array&&(t.ctrlObj[n]=e[n])}),t.debounceGenerateExtendCtrlJson()}),this.bus.$on("update-extension",function(e){e.vote?t.extensionObj.vote=e.vote:null===e.vote&&delete t.extensionObj.vote,e.lottery?t.extensionObj.lottery=e.lottery:null===e.lottery&&delete t.extensionObj.lottery,t.debounceGenerateExtendCtrlJson()}),this.bus.$on("text-update",function(e){t.text=e,t.debounceGenerateExtendCtrlJson()}),this.bus.$on("image-list-update",function(e){t.imageList=e,t.debounceGenerateExtendCtrlJson()})}},{key:"getArticleMaxLength",value:function(){var t=this;this.bpapi({method:"get",url:"//api.bilibili.com/x/article/conf"}).then(function(e){t.articleMaxTextCount=e.content_max||t.articleMaxTextCount})}},{key:"onPublishBtnClick",value:function(){if(this.disabled)this.textLength>this.articleMaxTextCount?this.linkMsg(this.$refs.publishBtn,"超过规定字数了哦~","caution"):this.ifArticleBtnActive&&this.showArticlePubConfirm();else{var t=this.schConfirmVisible?this.$refs.schPubConfirm.buttons.confirmBtn:this.$refs.publishBtn;if(this.isPopupPanel?Object(wt.d)(Ct.d.PUBLICH_CLICK_2,""):Object(wt.d)(Ct.d.PUBLICH_CLICK_1,""),!this.isPublishing){if(!this.specificationAgreed)return void this.showSpecification();this.isPublishing=!0,this.publishImageList.length>0?this.publishAlbum(t):this.publishText(t)}}}},{key:"showSpecification",value:function(){if(this.specificationAgreed||this.specificationShown)return!1;this.specificationShown=!0}},{key:"generateExtendCtrlJson",value:function(){var t={from:{emoji_type:1}},e=this.ctrlObj.lottery,n=this.ctrlObj.vote,i=(this.ctrlObj.at||[]).slice(0,10),o=e?e.slice():[],r=[],a=function(t,e){for(var n=!0,i=0;i<r.length;i++){var o=vo(r[i],2),a=o[0];if(!(n=!!(t>=o[1]||e<=a)))break}return n};e instanceof Array&&e.length>0?(this.bus.$emit("has-lottery",!0),e.forEach(function(t){r.push([t.location,t.location+Number(t.data)])})):this.bus.$emit("has-lottery",!1),n instanceof Array&&n.length>0?(this.bus.$emit("has-vote",!0),n.forEach(function(t){a(t.location,t.location+Number(t.data))&&(r.push([t.location,t.location+Number(t.data)]),o.push(t))})):this.bus.$emit("has-vote",!1);var s=[];i instanceof Array&&i.forEach(function(t){a(t.location,t.location+t.length)&&(o.push(t),s.push(t.data))}),t.ctrl=o,this.extensionObj.vote&&(t.vote=this.extensionObj.vote),this.extensionObj.lottery&&(t.lottery=this.extensionObj.lottery),this.extendCtrlJson=JSON.stringify(t);var c=Object(d.c)(this.content),u={dynamic_id:0,type:4,rid:0,content:c},l={biz:3,category:3,type:0,pictures:JSON.stringify(this.publishImageList),title:"",tags:"",description:c,content:c,setting:this.isScheduled?void 0:JSON.stringify({copy_forbidden:0,cachedTime:0}),from:"create.dynamic.web"},f={emoji_type:1,from:{emoji_type:1},vote_cfg:t.vote,lott_cfg:t.lottery},p=JSON.stringify(t.ctrl);u.extension=JSON.stringify(f),u.at_uids=s.join(","),u.ctrl=p,l.extension=JSON.stringify(f),l.at_uids=s.join(","),l.at_control=p,this.textPublishParam=u,this.albumPublishParam=l,this.setLocalStorage()}},{key:"onTopicPageInit",value:function(){this.topicName&&""===this.text&&this.bus.$emit("text-update","#".concat(this.topicName,"# "))}},{key:"checkSpecification",value:function(){this.specificationAgreed=1===parseInt(m.a.getItem("dy_spec_agreed"))}},{key:"publishText",value:function(t){var e=this;this.bpapi({url:"".concat(b.a.API_VC,"/dynamic_svr/v1/dynamic_svr/create"),method:"post",data:this.textPublishParam}).then(function(n){0===n.data.result?(e.linkMsg(t,"发布成功 ".concat(st.j.happy()),"success"),e.dispatchFeedUpdate(n.data.dynamic_id),e.$emit("succeed",{isScheduled:!1}),e.handlePublishComplete()):2===n.data.result?Object(st.k)(e):e.linkMsg(t,n.data.errmsg,"caution"),e.publishHandler&&e.publishHandler(),e.isPublishing=!1},function(n){e.linkMsg(t,n.msg,n.type),e.isPublishing=!1})}},{key:"publishAlbum",value:function(t){var e=this;this.bpapi({url:"".concat(b.a.API_VC,"/dynamic_svr/v1/dynamic_svr/create_draw"),method:"post",data:this.albumPublishParam}).then(function(n){e.linkMsg(t,"发布成功 ".concat(st.j.happy()),"success"),setTimeout(function(){e.dispatchFeedUpdate(n.data.dynamic_id)},1e3),e.$emit("succeed",{isScheduled:!1}),e.handlePublishComplete(),e.publishHandler&&e.publishHandler()},function(n){e.linkMsg(t,n.msg,n.type),e.isPublishing=!1})}},{key:"showArticlePubConfirm",value:function(){this.ifArticleBtnActive&&(this.articlePubConfirmVisible=!0)}},{key:"articlePubConfirm",value:function(){if(this.ifArticleBtnActive){var t=this.content,e={infoDescription:t=t.replace(/\r\n/g,"\n").replace(/%/g,"%25"),images:this.publishImageList.map(function(t){return t.img_src.replace(/^http:/,"https:")}),vote:null},n="https://member.bilibili.com/v2#/upload/text/edit?config=".concat(encodeURIComponent(JSON.stringify(e)));window.open(n),this.articlePubConfirmVisible=!1,this.articlePubClickReport(),this.handlePublishComplete()}else this.textLength>this.articleMaxTextCount&&this.linkMsg(this.$refs.publishBtn,"超过规定字数了哦~","caution")}},{key:"handlePublishComplete",value:function(){this.resetPublishBox(),this.isPublishing=!1,this.schConfirmVisible=!1,l.b.$emit("textChange","")}},{key:"schPubConfirm",value:function(){var t,e,n,i=this,o=this.$refs.schPubConfirm.buttons.confirmBtn;this.editDraft?(n=i.editDraft.draft_id,i.publishImageList.length>0?(e=2,t=i.albumPublishParam):(e=4,t=i.textPublishParam),i.bpapi({url:"".concat(b.a.API_VC,"/dynamic_draft/v1/dynamic_draft/publish_now"),method:"post",data:{draft_id:n,type:e,request:JSON.stringify(t)}}).then(function(t){i.linkMsg(o,"发送成功",t.type),i.schConfirmVisible=!1,i.$emit("succeed",{isScheduled:!1}),i.handlePublishComplete(),i.publishHandler&&i.publishHandler()},function(t){i.linkMsg(o,t.msg,"error"),i.schConfirmVisible=!1,i.$emit("failed",t)})):this.onPublishBtnClick()}},{key:"scheduledPublish",value:function(){var t=this;if(this.schPubDisabled)this.textLength>this.articleMaxTextCount?this.linkMsg(this.$refs.publishBtn,"超过规定字数了哦~","caution"):this.ifArticleBtnActive&&this.showArticlePubConfirm();else{var e=this.editDraft?2:this.isPopupPanel?1:0;Object(wt.d)(Ct.d.TIMER_SET,e);var n=this.$refs.publishBtn;if(this.specificationAgreed){var i,o,r,a,s=function(e){t.schConfirmText=e,t.schConfirmVisible=!0},c=new Date;this.publishTime.getTime()-c.getTime()<-6e4||this.publishTime.getTime()-c.getTime()<0&&this.publishTime.getMinutes()!==c.getMinutes()?s("设置的时间点已过，是否直接发布？"):this.publishTime.getTime()-c.getTime()<3e5?s("设置的时间点过于接近当前时间，是否直接发布？"):(a=function(){t.$emit("succeed",{isScheduled:!0,draft:{draft_id:r,publish_time:Math.ceil(t.publishTime.getTime()/1e3),type:o,request:JSON.stringify(i),publish_status:0}})},t.publishImageList.length>0?(o=2,i=t.albumPublishParam):(o=4,i=t.textPublishParam),t.editDraft?t.bpapi({url:"".concat(b.a.API_VC,"/dynamic_draft/v1/dynamic_draft/modify_draft"),method:"post",data:{draft_id:t.editDraft.draft_id,type:o,publish_time:Math.ceil(t.publishTime.getTime()/1e3),request:JSON.stringify(i)}}).then(function(){t.linkMsg(n,"编辑定时发布成功","success"),r=t.editDraft.draft_id,a(),t.handlePublishComplete(),t.publishHandler&&t.publishHandler()},function(e){t.linkMsg(n,e.msg,"error"),t.$emit("failed",e)}):t.bpapi({url:"".concat(b.a.API_VC,"/dynamic_draft/v1/dynamic_draft/add_draft"),method:"post",data:{type:o,publish_time:Math.ceil(t.publishTime.getTime()/1e3),request:JSON.stringify(i)}}).then(function(e){t.linkMsg(n,"定时发布成功","success"),r=e.data.draft_id,a(),t.handlePublishComplete(),t.publishHandler&&t.publishHandler()},function(e){t.linkMsg(n,e.msg,"error"),t.$emit("failed",e)}))}else this.showSpecification()}}},{key:"dispatchFeedUpdate",value:function(t){t&&this.bpapi({url:"".concat(b.a.API_VC,"/dynamic_svr/v1/dynamic_svr/get_dynamic_detail"),method:"get",data:{dynamic_id:t}}).then(function(t){l.b.$emit(Ct.b.ADD,t.data.card)})}},{key:"generateAlbumFakeCard",value:function(t,e){try{var n={at_control:t.at_control,category:"daily",description:t.description,pictures:t.pictures,pictures_count:t.pictures.length,reply:0,role:"",source:"",title:"",id:e.doc_id},i=l.t.getMyUserInfo(),o={head_url:i.card.face,uid:i.card.mid,name:i.card.name},r={type:Ct.a.PIC,uid:~~i.card.mid,dynamic_id:"-".concat(Co),user_profile:{card:{},info:{face:i.card.face,uid:i.card.mid,uname:i.card.name,platform_user_level:(i.card.level_info||{}).current_level}},timestamp:Date.now()};Co+=1;var a={card:JSON.stringify({item:n,user:o}),desc:r,extend_json:t.extension,did:e.dynamic_id_str};l.b.$emit(Ct.b.ADD,a)}catch(t){console.error(t)}}},{key:"resetPublishBox",value:function(){this.bus.$emit("reset"),this.editDraft||this.isLockedAsScheduled||(this.isScheduled=!1)}},{key:"specificationConfirm",value:function(){m.a.setItem("dy_spec_agreed",1,1/0,"/",".bilibili.com"),this.specificationAgreed=!0,this.specificationShown=!1,this.isScheduled?this.scheduledPublish():this.onPublishBtnClick()}},{key:"specificationCancel",value:function(){this.specificationShown=!1}},{key:"scheduleEditDraftRecovery",value:function(){if(this.editDraft){var t=Number(this.editDraft.publish_time);Number.isNaN(t)||(this.publishTime=new Date(1e3*t)),this.bus.$emit("schedule-trigger",!0);var e=Object(m.e)(this.editDraft.request);if(e.pictures){var n=[];n="string"==typeof e.pictures?Object(m.e)(e.pictures):e.pictures,this.bus.$emit("image-draft-update",n)}var i=e.content||"";this.bus.$emit("text-update",i)}}},{key:"setLocalStorage",value:function(){if("undefined"!=typeof window&&this.loginUid&&!this.isLockedAsScheduled)if(this.content.length>0||this.publishImageList.length>0){if(this.topicName)return;var t={text:this.content,ctrlObj:this.ctrlObj,extensionObj:this.extensionObj,imageList:this.publishImageList};window.localStorage.setItem("bp_publish_draft_v2_".concat(this.loginUid),JSON.stringify(t))}else window.localStorage.removeItem("bp_publish_draft_v2_".concat(this.loginUid))}},{key:"initLocalStorage",value:function(){if(this.storeInput&&!this.isLockedAsScheduled&&"undefined"!=typeof window&&this.loginUid){var t=window.localStorage.getItem("bp_publish_draft_v2_".concat(this.loginUid));if(t){var e=Object(m.e)(t);this.bus.$emit("text-update",e.text);var n=e.ctrlObj.vote?e.ctrlObj.vote[0]:null,i=e.extensionObj.vote;this.bus.$emit("vote-restore",{ctrl:n,extension:i});var o=e.ctrlObj.lottery?e.ctrlObj.lottery[0]:null,r=e.extensionObj.lottery;this.bus.$emit("lottery-restore",{ctrl:o,extension:r})}}}},{key:"checkIfShowArticlePubTips",value:function(){var t=this;"undefined"!=typeof window&&"true"!==window.localStorage.getItem("dynamic_article_publish_intro_".concat(this.loginUid))&&(t.articlePubTipsVisable=!0,window.localStorage.setItem("dynamic_article_publish_intro_".concat(t.loginUid),String(!0)),setTimeout(function(){t.articlePubTipsVisable=!1},5e3))}},{key:"articlePubShowReport",value:function(){var t="444.41",e="publish_article_show1";this.isPopupPanel&&(e="publish_article_show2"),this.topicName&&(e="publish_article_show",t="333.169"),oe.bpreport.event({spmId:t,event:e})}},{key:"articlePubClickReport",value:function(){var t="444.41",e="publish_article_click1";this.isPopupPanel&&(e="publish_article_click2"),this.topicName&&(e="publish_article_click",t="333.169"),oe.bpreport.event({spmId:t,event:e})}},{key:"content",get:function(){return this.text.replace(/\n{2,}/g,"\n\n").replace(/^\n+/,"").replace(/\n+$/,"").replace(/^ +/,"").replace(/ +$/," ")}},{key:"textLength",get:function(){return Object(l.i)(this.content)}},{key:"leftTextCount",get:function(){return this.maxLength-this.textLength}},{key:"indicatorShowTextCount",get:function(){return this.leftTextCount<0?this.leftTextCount:this.textLength}},{key:"ifShowArticleBtn",get:function(){return this.textLength>=this.articleMinTextCount&&!this.editDraft&&!this.isLockedAsScheduled}},{key:"ifArticleBtnActive",get:function(){return this.textLength>=this.articleMinTextCount&&this.textLength<=this.articleMaxTextCount}},{key:"publishBtnText",get:function(){var t="发布";return this.isScheduled?t=!this.editDraft&&this.scheduledCount>20?"已满上限":"定时发布":this.isPublishing&&(t="发布中"),t}},{key:"publishImageList",get:function(){return this.imageList.filter(function(t){return!t.status&&t.img_src&&""!==t.img_src}).map(function(t){return{img_src:t.img_src,img_width:t.img_width,img_height:t.img_height,img_size:t.img_size}})}},{key:"disabled",get:function(){return 0===this.textLength&&0===this.publishImageList.length||this.textLength>this.maxLength||this.imageList.length!==this.publishImageList.length||this.topicName&&this.content==="#".concat(this.topicName,"#")}},{key:"schPubDisabled",get:function(){return this.disabled||!this.editDraft&&this.scheduledCount>=20}}])&&bo(n.prototype,i),o&&bo(n,o),e}();c.a([Object(u.b)()],xo.prototype,"bus",void 0),c.a([Object(u.b)()],xo.prototype,"loginUid",void 0),c.a([Object(u.b)({type:Number,default:function(){return 1e3}})],xo.prototype,"maxLength",void 0),c.a([Object(u.b)(String)],xo.prototype,"topicName",void 0),c.a([Object(u.b)()],xo.prototype,"editDraft",void 0),c.a([Object(u.b)(Number)],xo.prototype,"scheduledCount",void 0),c.a([Object(u.b)(Boolean)],xo.prototype,"storeInput",void 0),c.a([Object(u.b)(Boolean)],xo.prototype,"isPopupPanel",void 0),c.a([Object(u.b)(Boolean)],xo.prototype,"onScheduleMode",void 0),c.a([Object(u.b)(Function)],xo.prototype,"publishHandler",void 0),c.a([Object(u.b)(Boolean)],xo.prototype,"isLockedAsScheduled",void 0),c.a([Object(u.d)("extendCtrlJson")],xo.prototype,"onExtendCtrlJson",null),c.a([Object(u.d)("isLockedAsScheduled")],xo.prototype,"onLockedAsScheduledChange",null),c.a([Object(u.d)("onScheduleMode")],xo.prototype,"onScheduleModeChange",null),c.a([Object(u.d)("loginUid")],xo.prototype,"onLoginUidChange",null),c.a([Object(u.d)("publishImageList")],xo.prototype,"onPublishImageListChange",null),c.a([Object(u.d)("publishTime")],xo.prototype,"onPublishTime",null),c.a([Object(u.d)("ifShowArticleBtn")],xo.prototype,"onIfShowArticleBtn",null);var Io=xo=c.a([Object(u.a)({name:"publish-launcher",components:{DynamicSpecification:mo,BpPopup:po.a}})],xo),ko=(n(284),Object(P.a)(Io,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"publish-launcher",class:{"is-popup-panel":t.isPopupPanel}},[n("span",{directives:[{name:"show",rawName:"v-show",value:0!==t.indicatorShowTextCount,expression:"indicatorShowTextCount !== 0"}],staticClass:"indicator",class:{"too-long":t.textLength>t.maxLength},attrs:{title:"全角字符计数为1\n半角字符计数为0.5，不足1时记为1"}},[t._v(t._s(t.indicatorShowTextCount))]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.ifShowArticleBtn,expression:"ifShowArticleBtn"}],staticClass:"article-pub-btn-box"},[t.articlePubTipsVisable&&t.ifShowArticleBtn?n("div",{staticClass:"article-pub-tips"},[n("span",[t._v("字数较多，点击可以快速发布专栏")]),n("i",{staticClass:"bp-icon-font icon-group-dynamic",on:{click:function(e){t.articlePubTipsVisable=!1}}})]):t._e(),n("button",{staticClass:"publish-btn d-i-block bp-v-middle to-article",class:{disabled:!t.ifArticleBtnActive},on:{click:t.articlePubConfirm}},[t._v("转为专栏\n    ")])]),t.isScheduled?t._e():n("button",{ref:"publishBtn",staticClass:"publish-btn d-i-block bp-v-middle",class:{publishing:t.isPublishing,disabled:t.disabled&&!t.ifArticleBtnActive},on:{click:t.onPublishBtnClick}},[t._v(t._s(t.publishBtnText)+"\n  ")]),t.isScheduled?n("button",{ref:"publishBtn",staticClass:"publish-btn d-i-block bp-v-middle",class:{publishing:t.isPublishing,disabled:t.schPubDisabled&&!t.ifArticleBtnActive},on:{click:t.scheduledPublish}},[t._v(t._s(t.publishBtnText)+"\n  ")]):t._e(),n("bp-popup",{staticClass:"dynamic-specification-popup",class:{"is-popup":t.isPopupPanel},attrs:{show:t.specificationShown,width:796,button:{confirm:"确认并发送"},"on-confirm":t.specificationConfirm,"on-cancel":t.specificationCancel}},[n("dynamic-specification")],1),n("div",{directives:[{name:"show",rawName:"v-show",value:t.schConfirmVisible,expression:"schConfirmVisible"}],staticClass:"sch-confirm-wrapper"},[n("bp-popup",{ref:"schPubConfirm",staticClass:"sch-confirm",attrs:{show:t.schConfirmVisible,button:{confirm:"是",cancel:"否"},width:360,onConfirm:t.schPubConfirm,onCancel:function(){t.schConfirmVisible=!1}}},[n("p",[t._v(t._s(t.schConfirmText))])])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:t.articlePubConfirmVisible,expression:"articlePubConfirmVisible"}],staticClass:"sch-confirm-wrapper"},[n("bp-popup",{ref:"schPubConfirm",staticClass:"sch-confirm",attrs:{title:"动态字数过多",show:t.articlePubConfirmVisible,button:{confirm:"发布专栏",cancel:"取消"},width:360,onConfirm:t.articlePubConfirm,onCancel:function(){t.articlePubConfirmVisible=!1}}},[n("p",[t._v("是否转为专栏发布？")])])],1)],1)},[],!1,null,"686ba2b1",null).exports),So=(n(73),n(74),n(48),{}),Oo=(n(285),Object(P.a)(So,function(){var t=this.$createElement;this._self._c;return this._m(0)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"specification p-rel"},[e("iframe",{staticClass:"iframe",attrs:{src:"//t.bilibili.com/h5/dynamic/specification"}})])}],!1,null,"7f2da7ec",null).exports),Po={props:{arrow:{type:Boolean,default:!1},width:{type:Number,default:300}},data:function(){return{}},methods:{onClose:function(t){this.$emit("close"),t.stopPropagation()}}},To=(n(286),Object(P.a)(Po,function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"move-in"}},[e("div",{staticClass:"static-popup",class:{"bp-arrow":this.arrow},style:{width:this.width+"px"}},[e("div",{staticClass:"bp-icon-font icon-group-dynamic close-btn",on:{click:this.onClose}}),e("div",{staticClass:"title"},[this._t("title")],2),e("div",{staticClass:"content-ctnr"},[this._t("default")],2)])])},[],!1,null,"3bcd26f6",null).exports),Eo={data:function(){return{isShow:!0}},props:{status:{type:String,default:""},errorText:{type:String,default:""},imgUrl:{type:String,default:""}},computed:{bgImg:function(){var t=Object(m.g)(Object(st.a)(this.imgUrl,80,80,{e:1,c:1}));return/\.gif$/.test(t)&&(t+="@1s.jpg"),t}}},jo=(n(287),Object(P.a)(Eo,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"upload-status"},["loading"===t.status?n("div",{staticClass:"loading-wrapper"},[n("span",{staticClass:"loading"})]):t._e(),"error"===t.status?n("div",{staticClass:"error-wrapper b-box"},[n("span",{staticClass:"bp-svg-icon error"}),n("span",{staticClass:"reason",domProps:{textContent:t._s(t.errorText)}})]):t._e(),t.imgUrl?n("div",{staticClass:"success-wrapper bg-center bg-cover",style:{backgroundImage:"url("+t.bgImg+")"}}):t._e(),t._t("editBtn"),t._t("close")],2)},[],!1,null,"20c6bfae",null).exports);function Lo(t,e,n,i,o,r,a){try{var s=t[r](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}function Ao(t){return new Promise(function(e){var n=new FileReader;n.onload=function(t){var n=new DataView(t.target.result);65496!==n.getUint16(0,!1)&&e(-2);for(var i=n.byteLength,o=2;o<i;){n.getUint16(o+2,!1)<=8&&e(-1);var r=n.getUint16(o,!1);if(o+=2,65505===r){1165519206!==n.getUint32(o+=2,!1)&&e(-1);var a=18761===n.getUint16(o+=6,!1);o+=n.getUint32(o+4,a);var s=n.getUint16(o,a);o+=2;for(var c=0;c<s;c++)274===n.getUint16(o+12*c,a)&&e(n.getUint16(o+12*c+8,a))}else{if(65280!=(65280&r))break;o+=n.getUint16(o,!1)}}e(-1)},n.readAsArrayBuffer(t)})}function Do(){var t;return t=pt.a.mark(function t(e){var i,o,r,a,s,c,u,l;return pt.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ao(e);case 2:if(!((i=t.sent)<2||i>8)){t.next=5;break}return t.abrupt("return",e);case 5:return(o=new Image).src=window.URL?window.URL.createObjectURL(e):window.webkitURL.createObjectURL(e),t.next=9,new Promise(function(t){o.onload=function(){return t()}});case 9:if(s=0,c=!1,[5,6,7,8].some(function(t){return t===i})?(r=o.height,a=o.width):(r=o.width,a=o.height),[7,8].some(function(t){return t===i})&&(s=1.5*Math.PI),[3,4].some(function(t){return t===i})&&(s=Math.PI),[5,6].some(function(t){return t===i})&&(s=.5*Math.PI),[2,4,5,7].some(function(t){return t===i})&&(c=!0),u=document.createElement("canvas"),l=u.getContext("2d"),u.width=r,u.height=a,c&&(l.translate(r,0),l.scale(-1,1)),l.translate(r/2,a/2),l.rotate(s),l.drawImage(o,-o.width/2,-o.height/2),u.toBlob){t.next=27;break}return t.next=27,n.e(2).then(n.t.bind(null,523,7));case 27:return t.abrupt("return",new Promise(function(t){u.toBlob(function(e){return t(e)},"image/jpeg")}));case 28:case"end":return t.stop()}},t)}),(Do=function(){var e=this,n=arguments;return new Promise(function(i,o){var r=t.apply(e,n);function a(t){Lo(r,i,o,a,s,"next",t)}function s(t){Lo(r,i,o,a,s,"throw",t)}a(void 0)})}).apply(this,arguments)}var Mo={data:function(){return{uid:"",localUploadList:[],gifMaxMByte:8,errorType:{common:"上传失败",mbyte:"文件大小请勿超过".concat(this.maxMByte,"M"),gifbype:"请上传小于".concat(8,"M的gif图"),size:"宽高均不得小于".concat(this.minWidth,"像素"),format:"仅支持JPG PNG GIF"},uploadBtnStyle:{}}},mounted:function(){var t=this;this.localUploadList=this.localUploadList.concat(this.draftPic),this.setInitFiles(),new dt.a(this.$refs.uploadList,{filter:".close",draggable:".draggable",animation:500,onMove:function(t){return t.related&&t.related.className.indexOf("draggable")>=0},onEnd:function(e){t.localUploadList.splice(e.newIndex,0,t.localUploadList.splice(e.oldIndex,1)[0])}})},watch:{localUploadList:function(t){this.$emit("update",t)}},props:{initFiles:{},draftPic:{type:Array,default:function(){return[]}},editStatus:{type:Boolean,default:!0},maxAmount:{type:Number,default:20},formatList:{type:Array,default:function(){return["jpg","jpeg","png","gif"]}},maxMByte:{type:Number,default:20},minWidth:{type:Number,default:10},minHeight:{type:Number,default:10}},components:{UploadStatus:jo},methods:{setInitFiles:function(){this.initFiles.length>0&&(this.checkFilesAmount(this.initFiles),this.selectImage(this.initFiles))},selectImage:function(t){var e=this,n=Array.prototype.map.call(t,function(){return{status:"loading",errorText:"",imgUrl:""}}),i=this.localUploadList.length;this.localUploadList=this.localUploadList.concat(n),this.localUploadList.length>this.maxAmount&&this.localUploadList.splice(this.maxAmount,this.localUploadList.length-this.maxAmount);for(var o=function(n,o){var r=t[n-i];e.checkFormat(r.type)||e.$set(e.localUploadList,n,{status:"error",errorText:e.errorType.format,id:e.randomNum()});var a=function(t){var i=new Image;i.src=URL.createObjectURL(t),i.onload=function(){var o=e.checkImage(r.type,r.size,i.width,i.height);o?e.$set(e.localUploadList,n,{status:"error",errorText:o,id:e.randomNum()}):e.uploadImage(t,n)}};["jpg","jpeg"].some(function(t){return r.type.indexOf(t)>-1})?function(t){return Do.apply(this,arguments)}(r).then(function(t){a(t)}):a(r)},r=i,a=this.localUploadList.length;r<a;r++)o(r)},uploadImage:function(t,e){var n=this,i=new FormData;i.append("file_up",t),i.append("biz","draw"),i.append("category","daily"),this.bpapi({url:"".concat(b.a.API_VC,"/api/v1/drawImage/upload"),method:"post",data:i,headers:{"Content-Type":"multipart/form-data"}}).then(function(i){n.$set(n.localUploadList,e,{img_src:i.data.image_url,img_width:i.data.image_width,img_height:i.data.image_height,img_size:t.size/1024,id:n.randomNum()})},function(){n.$set(n.localUploadList,e,{status:"error",errorText:"上传失败",id:n.randomNum()})})},clickSelect:function(t){var e=t.target||t.srcElement,n=e.files;this.checkFilesAmount(n),this.selectImage(n),e.value=""},dropSelect:function(t){t.stopPropagation(),t.preventDefault();var e=t.dataTransfer.files;this.checkFilesAmount(e),this.selectImage(e)},checkFilesAmount:function(t){this.localUploadList.length+t.length>this.maxAmount&&this.linkMsg(this.$refs.uploadBtn,"上传图片不得超过".concat(this.maxAmount,"张（￣∞￣）"),"caution")},dragover:function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"},checkImage:function(t,e,n,i){return this.checkFormat(t)?t.indexOf("gif")>-1&&Math.floor(e/1024/1024)>=this.gifMaxMByte?this.errorType.gifbype:Math.floor(e/1024/1024)>=this.maxMByte?this.errorType.mbyte:(n<this.minWidth||i<this.minHeight)&&this.errorType.size:this.errorType.format},checkFormat:function(t){for(var e=0,n=this.formatList.length;e<n;e++)if(t.indexOf(this.formatList[e])>-1)return!0},removeUploadItem:function(t){this.localUploadList.splice(t,1)},randomNum:function(){return Date.now()*Math.ceil(1e5*Math.random())}}},No=(n(288),Object(P.a)(Mo,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"upload-image-wrapper"},[n("div",{ref:"dropZone",staticClass:"upload-image",class:{center:!t.localUploadList.length},on:{dragover:t.dragover,drop:t.dropSelect}},[n("div",{ref:"uploadList",staticClass:"f-clear upload-list"},[t._l(t.localUploadList,function(e,i){return n("upload-status",{key:e.id||e.img_src,staticClass:"draggable f-left",attrs:{status:e.status,"error-text":e.errorText,"img-url":e.img_src}},[n("span",{staticClass:"close pointer a-fade-in",attrs:{slot:"close"},on:{click:function(e){return t.removeUploadItem(i)}},slot:"close"},[n("i",{staticClass:"bp-icon-font icon-group-dynamic c-pointer"})])])}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.localUploadList.length<parseInt(t.maxAmount),expression:"localUploadList.length < parseInt(maxAmount)"}],ref:"uploadBtn",staticClass:"f-left upload-btn b-box"},[n("input",{ref:"uploadInput",staticClass:"upload pointer",attrs:{type:"file",accept:"image/png, image/jpeg, image/jpg, image/gif",multiple:""},on:{change:t.clickSelect}}),n("i",{staticClass:"bp-icon-font icon-add pointer"})])],2)])])},[],!1,null,"14a3591d",null).exports),Ro={props:{initFiles:{},draftPic:{type:Array,default:function(){return[]}}},data:function(){return{imageList:[],selectedFiles:this.initFiles}},components:{StaticBox:To,ImageUploader:No},methods:{updateImageList:function(t){this.imageList=t,this.$emit("update",t)},close:function(){this.$emit("close")}}},Bo=(n(289),Object(P.a)(Ro,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("static-box",{staticClass:"upload-image-box",attrs:{width:290,arrow:!0},on:{close:t.close}},[n("span",{attrs:{slot:"title"},slot:"title"},[t._v("图片上传"),n("span",{staticClass:"d-i-block hint"},[t._v(t._s(t.imageList.length)+" / 9")])]),n("image-uploader",{attrs:{"max-amount":9,"init-files":t.selectedFiles,"draft-pic":t.draftPic},on:{update:t.updateImageList}})],1)},[],!1,null,"64344f08",null).exports),Uo={name:"div-edit",props:{value:{type:String,default:""},placeholder:{type:String,default:"有什么想和大家分享的？"},divClass:{type:Object},loginUid:{type:Number},storeInput:{tpye:Boolean,default:!1}},data:function(){return{waitInput:!1,isLocked:!1,content:"",nodes:[]}},computed:{},created:function(){Object(d.b)()},mounted:function(){var t=this;this.$refs.div.focus(),this.$emit("input",Object(l.h)(this.$refs.div)),setTimeout(function(){t.$refs.div.value=Object(l.h)(t.$refs.div),t.content=t.$refs.div.value})},watch:{value:function(){this.isLocked&&this.value||(this.content=this.$refs.div.value,this.$refs.div.value=Object(l.h)(this.$refs.div)),""===this.value&&(this.$refs.div.textContent="",this.$refs.div.value="",this.content="")}},methods:{changeText:function(){var t=this,e=Object(l.h)(this.$refs.div);if(!this.waitInput&&e&&""===e.trim())return this.$refs.div.textContent="",this.$refs.div.value="",void(this.content="");this.$refs.div.value=e,this.content=this.$refs.div.value,this.$emit("input",e),this.$nextTick(function(){var e=t.$refs.div.childNodes;t.nodes=[];for(var n=0;n<e.length;n++)"#text"===e[n].nodeName?t.nodes.push(Object(l.e)(e[n].nodeValue)):t.nodes.push(e[n].outerHTML);t.storeInput&&localStorage.setItem("dynamic_publisher_div_html_".concat(t.loginUid),JSON.stringify(t.nodes))})},onPaste:function(t){var e="";(e=window.clipboardData&&window.clipboardData.setData?window.clipboardData.getData("text"):(t.originalEvent||t).clipboardData.getData("text/plain")||"")&&(window.getSelection().deleteFromDocument(),Object(l.h)(this.$refs.div).trim()||e.trim()?(e=(e=Object(l.e)(e).replace(/ /g,"&nbsp")).replace(/\r\n/g,"<br>").replace(/\r/g,"<br>").replace(/\n/g,"<br>"),e=Object(d.e)(e),this.insertHtmlAtCaret(e)):this.$emit("input",""))},insertHtmlAtCaret:function(t){Object(l.l)(t),this.$refs.div.value=Object(l.h)(this.$refs.div),this.content=this.$refs.div.value}}},Ho=(n(290),Object(P.a)(Uo,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{"placeholder-shown":!t.content},attrs:{placeholder:t.placeholder}},[n("div",{ref:"div",staticClass:"editor",class:t.divClass,attrs:{contenteditable:"true"},on:{input:t.changeText,DOMNodeInserted:t.changeText,compositionstart:function(e){t.waitInput=!0},compositionend:function(e){t.waitInput=!1},focus:function(e){t.isLocked=!0},blur:function(e){t.isLocked=!1},paste:function(e){return e.preventDefault(),t.onPaste(e)}}})])},[],!1,null,"00414ad8",null).exports);function $o(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Fo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function Vo(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var zo=1;var Go={data:function(){return{isPopupPanel:!1,emojiBoxShown:!1,imageBoxShown:!1,userInput:"",maxLength:233,textarea:null,emojiTrigger:null,imageList:[],selectedFiles:{},isPublishing:!1,supportFileUpload:!1,specificationAgreed:!1,specificationShown:!1,uid:"",draftPic:[],isMounted:!1,atItems:[],voteShow:!1,voteConfig:{},lotteryShow:!1,lotteryConfig:{},nodes:[],isSafari:!1,isIE:!1,isScheduled:Boolean(this.editDraft||this.isLockedAsScheduled),publishTime:void 0,schPubTipsVisable:!1,schConfirmVisible:!1,schConfirmText:""}},computed:{content:function(){return this.userInput.replace(/\n{2,}/g,"\n\n").replace(/^\n+/,"").replace(/\n+$/,"").trim()},validDraftPic:function(){return this.draftPic.filter(function(t){return t&&void 0!==t.img_src})},contentLength:function(){return this.content.length},publishedImages:function(){return this.imageList.filter(function(t){return!t.status&&t.img_src&&""!==t.img_src}).map(function(t){return{img_src:t.img_src,img_width:t.img_width,img_height:t.img_height,img_size:t.img_size}})},disabled:function(){return(0===this.contentLength||this.contentLength>this.maxLength)&&0===this.publishedImages.length||this.imageList.length>this.publishedImages.length||this.topicName&&this.content==="#".concat(this.topicName,"#")},schPubDisabled:function(){return this.disabled||!this.publishTime||!this.editDraft&&this.scheduledCount>=20},textareaActive:function(){return this.emojiBoxShown},voteIndex:function(){return this.voteConfig.title?this.content.indexOf("​".concat(this.voteConfig.title)):-1},lotteryIndex:function(){return this.lotteryConfig.title?this.content.indexOf("​".concat(this.lotteryConfig.title)):-1}},props:{topicName:{type:String},loginUid:{type:Number,default:0},storeInput:{tpye:Boolean,default:!1},publishHandler:{type:Function},canVote:{type:Boolean},canLottery:{type:Boolean},canBeScheduled:{type:Boolean,default:!1},scheduledCount:{type:Number,default:0},editDraft:{type:Object,default:null},isLockedAsScheduled:{type:Boolean,default:!1}},components:{EmojiBox:q.a,ImageBox:Bo,BpPopup:po.a,DynamicSpecification:Oo,AtPopup:jt.a,HashPopup:Yt,DivEdit:Ho,Vote:bn,Lottery:$i,DatePicker:$},beforeMount:function(){var t=Object(m.d)();this.isIE=-1!==t.indexOf("IE"),this.isSafari=-1!==t.indexOf("Safari"),this.supportFileUpload="IE 9"!==t&&"IE Legacy"!==t},created:function(){var t=this;Object(d.b)(),l.b.$on("textChange",function(e){t.userInput=e}),this.topicName&&""===this.userInput&&(this.isIE?this.userInput="#".concat(this.topicName,"# "):setTimeout(function(){t.textarea.focus(),Object(l.l)(Object(l.e)("#".concat(t.topicName,"#&nbsp;")))}))},mounted:function(){var t=this;this.specificationAgreed=1===parseInt(m.a.getItem("dy_spec_agreed")),this.isMounted=!0,this.isIE?(this.textarea=this.$refs.textarea,this.autoHeight(this.textarea,200)):this.textarea=this.$refs.textarea.$refs.div,this.emojiTrigger=this.$refs.emojiTrigger;var e=this.getPopupPanel();if(this.isPopupPanel=!!e,this.setPopupOffset(e),setTimeout(function(){t.addVoteClick(),t.addLotteryClick()},0),this.throttleShowLimitToast=Object(m.f)(this.showLimitToast,300),this.editDraft){var n=Number(this.editDraft.publish_time);Number.isNaN(n)||(this.publishTime=new Date(1e3*n));var i=Object(m.e)(this.editDraft.request);i.pictures&&(this.imageBoxShown=!0,"string"==typeof i.pictures?this.draftPic=Object(m.e)(i.pictures):this.draftPic=i.pictures),this.textarea.innerHTML="",this.textarea.focus();var o=this.restoreFromEditDraft();this.insertHtmlAtCaret(o)}},watch:{loginUid:function(t){t&&(this.initLocalStorage(),this.scheduledPublishTips())},userInput:function(t){var e=this;this.storeInput&&localStorage.setItem("dynamic_publisher_".concat(this.loginUid),t),this.$nextTick(function(){var t=e.textarea.getElementsByClassName("bp-vote-span");0===t.length&&(e.voteConfig={}),0===(t=e.textarea.getElementsByClassName("bp-lottery-span")).length&&(e.lotteryConfig={}),0===(t=e.textarea.getElementsByClassName("bp-at-span")).length&&(e.atItems=[])}),""!==t&&""===t.trim()&&(this.userInput="",l.b.$emit("textChange",""))},atItems:function(t){localStorage.setItem("dynamic_publisher_at_".concat(this.loginUid,"_config"),JSON.stringify(t))},voteIndex:function(t){t<0&&(this.clearVote(),this.onVoteCancel(),this.voteConfig={},localStorage.setItem("dynamic_publisher_vote_".concat(this.loginUid,"_config"),"{}"))},lotteryIndex:function(t){t<0&&(this.clearLottery(),this.onLotteryCancel(),this.lotteryConfig={},localStorage.setItem("dynamic_publisher_lottery_".concat(this.loginUid,"_config"),"{}"))},isLockedAsScheduled:function(t){this.isScheduled=!!t},schConfirmVisible:function(t){var e=this;this.$nextTick(function(){var n=e.$refs.schPubConfirm;if(t&&e.isPopupPanel&&n){var i=n.$el.parentNode.parentNode.getBoundingClientRect();n.$el.parentNode.style="top: -".concat(i.top,"px;left: -").concat(i.left,"px")}})}},methods:{showLimitToast:function(){this.linkMsg(this.textarea,"您的浏览器暂不支持投票发起功能","caution")},restoreDraft:function(){var t=this;this.nodes.forEach(function(e){""===e||/^(<\/?div\/?>)*(<br\/?>)*(<\/?div\/?>)*$/.test(e)||t.insertHtmlAtCaret(e)}),this.$nextTick(function(){t.addVoteClick(),t.addLotteryClick()})},onMousedown:function(){this.textarea.focus();var t=arguments[0]||window.event;t.preventDefault()},validate:function(){return!0},selectHandler:function(t){if(this.isIE){var e=this.userInput,n=Object(l.g)(this.textarea),i=e.substring(0,n),o=e.substring(n),r=i.lastIndexOf("@");i=i.substring(0,r+1),this.userInput="".concat(i).concat(t.uname," ").concat(o)}else{var a;a='<input type="button" class="bp-at-span" readonly value="@'.concat(t.uname,'&nbsp;" style="color:#00a1d6;"></input>');var s,c,u=window.getSelection().getRangeAt(0),d=u.endContainer,f=d;3!==d.nodeType&&(f=d.childNodes[u.endOffset-1]);var p=function t(e){var n=0,i=e;if(3===e.nodeType){if(-1===(n=e.nodeValue.lastIndexOf("@"))){var o=t(e.previousSibling);n=o.index,i=o.node}}else{var r=e.childNodes;if(r.length){var a=t(r[r.length-1]);n=a.index,i=a.node}}return{index:n,node:i}}(f);s=p.index,c=p.node,u.setStart(c,s),u.deleteContents(),this.insertHtmlAtCaret(a)}this.atItems.push(t)},getEmojiSrc:function(t){return Object(d.e)(t,{emojiType:1})},emojiSelectHandler:function(t){var e=this.getEmojiSrc(t),n=this.userInput,i=Object(l.g)(this.textarea),o=n.substring(0,i),r=n.substring(i);if(this.isIE)this.userInput="".concat(o).concat(t).concat(r);else{var a=e;this.insertHtmlAtCaret(a)}},initLocalStorage:function(){var t=this;if(this.storeInput&&"undefined"!=typeof window&&this.loginUid){this.loginUid&&null===localStorage.getItem("dynamic_publisher_".concat(this.loginUid))&&localStorage.setItem("dynamic_publisher_".concat(this.loginUid),""),this.loginUid&&null===localStorage.getItem("dynamic_publisher_pic_".concat(this.loginUid))&&localStorage.setItem("dynamic_publisher_pic_".concat(this.loginUid),"[]");var e=localStorage.getItem("dynamic_publisher_".concat(this.loginUid)||!1).trim();/^(<\/?div\/?>)*(<br\/?>)*(<\/?div\/?>)*$/.test(e)||(this.userInput=e),this.draftPic=Object(m.e)(localStorage.getItem("dynamic_publisher_pic_".concat(this.loginUid)))||[],this.atItems=Object(m.e)(localStorage.getItem("dynamic_publisher_at_".concat(this.loginUid,"_config")))||[],this.voteConfig=Object(m.e)(localStorage.getItem("dynamic_publisher_vote_".concat(this.loginUid,"_config")))||{},this.lotteryConfig=Object(m.e)(localStorage.getItem("dynamic_publisher_lottery_".concat(this.loginUid,"_config")))||{},this.nodes=Object(m.e)(localStorage.getItem("dynamic_publisher_div_html_".concat(this.loginUid)))||[],this.$nextTick(function(){t.validDraftPic.length>0&&t.showImageBox(),t.restoreDraft()})}},callFileDialog:function(){var t=this;if(this.isPopupPanel?Object(wt.d)(Ct.d.PUBLICH_PIC_2,""):Object(wt.d)(Ct.d.PUBLICH_PIC_1,""),"IE 10"===Object(m.d)()||"IE 11"===Object(m.d)())return this.showImageBox();if(this.validDraftPic.length>0&&this.storeInput&&this.showImageBox(),!this.imageBoxShown){var e=document.createElement("input");e.type="file",e.accept="image/png, image/jpeg, image/jpg, image/gif",e.multiple="multiple",e.addEventListener("change",function(e){var n=(e.target||e.srcElement).files;n&&n.length>0&&(t.selectedFiles=n,t.showImageBox())}),e.click(),window.upload_input=e,e=null}},clickButtonHandler:function(t){var e=this,n=this.textarea,i=Object(l.g)(n);this.$nextTick(function(){if(e.isIE){var o=e.userInput;e.userInput="".concat(o.slice(0,i),"##").concat(o.slice(i))}else{e.insertHtmlAtCaret("#"),e.insertHtmlAtCaret("".concat("#","&nbsp;"))}setTimeout(function(){if(e.isIE)n.setSelectionRange(i+1,i+1);else try{e.setHashPos("before")}catch(t){return}n.focus(),t&&t()},0)})},selectTopicHandler:function(t){var e,n=this;e=this.isIE?this.userInput:this.textarea.value.replace(/\n/g,"");var i=Object(l.g)(this.textarea),o=e.substring(0,i),r=e.substring(i),a=o.lastIndexOf("#"),s=o.substring(0,a+1),c="after2";if(this.isIE)r=!r||r&&"#"!==r.slice(0,1)?"# ".concat(r):"# ".concat(r.slice(1)),this.userInput="".concat(s).concat(t).concat(r);else{var u=Object(l.e)(t);o.length===s.length&&(c="after1"),this.setSelectText(i,a),this.insertHtmlAtCaret(u),(!r||r&&"#"!==r.slice(0,1))&&(u="#&nbsp;",this.insertHtmlAtCaret(u),c="static"),setTimeout(function(){try{n.setHashPos(c)}catch(t){return}},0)}},logTopicHandler:function(){var t=this.isPopupPanel?Ct.d.PUBLISH_AT_LIST_SHOW_2:Ct.d.PUBLISH_AT_LIST_SHOW_1;Object(wt.d)(t)},publish:function(){if(!this.disabled){var t=this.schConfirmVisible?this.$refs.schPubConfirm.buttons.confirmBtn:this.$refs.publishBtn;if(this.isPopupPanel?Object(wt.d)(Ct.d.PUBLICH_CLICK_2,""):Object(wt.d)(Ct.d.PUBLICH_CLICK_1,""),!this.isPublishing&&this.validatePublish(t)){if(!this.specificationAgreed)return void this.showSpecification();this.isPublishing=!0,this.publishedImages.length>0?this.publishAlbum(t):this.publishText(t)}}},getPublishTextParams:function(){var t=Object(d.c)(this.content),e={dynamic_id:0,type:4,rid:0,content:t},n=l.a.generateAtParams(t,void 0,this.atItems),i=n.atUids,o=n.ctrl,r={emoji_type:1};return this.voteConfig.vote_id&&(o=JSON.stringify(JSON.parse(o).concat({data:String(this.voteConfig.title.length+1),length:0,location:this.voteIndex,type:3})),r.vote_cfg={vote_id:this.voteConfig.vote_id}),this.lotteryConfig.lottery_id&&(o=JSON.stringify(JSON.parse(o).concat({data:String(this.lotteryConfig.title.length+1),length:0,location:this.lotteryIndex,type:2})),r.lott_cfg={lottery_id:this.lotteryConfig.lottery_id}),e.extension=JSON.stringify(r),e.at_uids=i,e.ctrl=o,e},publishText:function(t){var e=this,n=this.getPublishTextParams();this.bpapi({url:"".concat(b.a.API_VC,"/dynamic_svr/v1/dynamic_svr/create"),method:"post",data:n}).then(function(n){0===n.data.result?(e.linkMsg(t,"发布成功 ".concat(st.j.happy()),"success"),e.dispatchFeedUpdate(n.data.dynamic_id),e.$emit("succeed",{isScheduled:!1}),e.handlePublishComplete()):2===n.data.result?Object(st.k)(e):e.linkMsg(t,n.data.errmsg,"caution"),e.publishHandler&&e.publishHandler(),e.isPublishing=!1},function(n){e.linkMsg(t,n.msg,n.type),e.isPublishing=!1})},getPublishAlbumParams:function(){var t=this.contentLength>0?this.content:void 0;t=Object(d.c)(t);var e={biz:3,category:3,type:0,pictures:JSON.stringify(this.publishedImages),title:"",tags:"",description:t,content:t,setting:this.isScheduled?void 0:JSON.stringify({copy_forbidden:0,cachedTime:0}),from:"create.dynamic.web"},n=l.a.generateAtParams(t,void 0,this.atItems),i=n.atUids,o=n.ctrl,r={emoji_type:1};return this.voteConfig.vote_id&&(o=JSON.stringify(JSON.parse(o).concat({data:String(this.voteConfig.title.length+1),length:0,location:this.voteIndex,type:3})),r.vote_cfg={vote_id:this.voteConfig.vote_id}),this.lotteryConfig.lottery_id&&(o=JSON.stringify(JSON.parse(o).concat({data:String(this.lotteryConfig.title.length+1),length:0,location:this.lotteryIndex,type:2})),r.lott_cfg={lottery_id:this.lotteryConfig.lottery_id}),e.extension=JSON.stringify(r),e.at_uids=i,e.at_control=o,e},publishAlbum:function(t){var e=this,n=this.getPublishAlbumParams();this.bpapi({url:"".concat(b.a.API_VC,"/dynamic_svr/v1/dynamic_svr/create_draw"),method:"post",data:n}).then(function(i){e.linkMsg(t,"发布成功 ".concat(st.j.happy()),"success");var o=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Fo(n,!0).forEach(function(e){Vo(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Fo(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},n,{setting:{copy_forbidden:0,cachedTime:0},pictures:e.publishedImages});e.generateAlbumFakeCard(o,i.data),e.$emit("succeed",{isScheduled:!1}),e.handlePublishComplete(),e.publishHandler&&e.publishHandler()},function(n){e.linkMsg(t,n.msg,n.type),e.isPublishing=!1})},handlePublishComplete:function(){this.resetPublishBox(),this.isPublishing=!1,this.schConfirmVisible=!1,l.b.$emit("textChange","")},schPubConfirm:function(){var t,e,n,i=this,o=this.$refs.schPubConfirm.buttons.confirmBtn;this.editDraft?(n=i.editDraft.draft_id,i.publishedImages.length>0?(e=2,t=i.getPublishAlbumParams()):(e=4,t=i.getPublishTextParams()),i.bpapi({url:"".concat(b.a.API_VC,"/dynamic_draft/v1/dynamic_draft/publish_now"),method:"post",data:{draft_id:n,type:e,request:JSON.stringify(t)}}).then(function(t){i.linkMsg(o,"发送成功",t.type),i.schConfirmVisible=!1,i.$emit("succeed",{isScheduled:!1}),i.handlePublishComplete(),i.publishHandler&&i.publishHandler()},function(t){i.linkMsg(o,t.msg,"error"),i.schConfirmVisible=!1,i.$emit("failed",t)})):this.publish()},scheduledPublish:function(){var t=this;if(!this.schPubDisabled){var e=this.editDraft?2:this.isPopupPanel?1:0;Object(wt.d)(Ct.d.TIMER_SET,e);var n=this.$refs.publishBtn;if(this.publishTime&&this.validatePublish(n))if(this.specificationAgreed){var i,o,r,a,s=function(e){t.schConfirmText=e,t.schConfirmVisible=!0},c=new Date;this.publishTime.getTime()-c<-6e4||this.publishTime.getTime()-c<0&&this.publishTime.getMinutes()!==c.getMinutes()?s("设置的时间点已过，是否直接发布？"):this.publishTime.getTime()-c<3e5?s("设置的时间点过于接近当前时间，是否直接发布？"):(a=function(){t.$emit("succeed",{isScheduled:!0,draft:{draft_id:r,publish_time:Math.ceil(t.publishTime.getTime()/1e3),type:o,request:JSON.stringify(i),publish_status:0}})},t.publishedImages.length>0?(o=2,i=t.getPublishAlbumParams()):(o=4,i=t.getPublishTextParams()),t.editDraft?t.bpapi({url:"".concat(b.a.API_VC,"/dynamic_draft/v1/dynamic_draft/modify_draft"),method:"post",data:{draft_id:t.editDraft.draft_id,type:o,publish_time:Math.ceil(t.publishTime.getTime()/1e3),request:JSON.stringify(i)}}).then(function(){t.linkMsg(n,"编辑定时发布成功","success"),r=t.editDraft.draft_id,a(),t.handlePublishComplete(),t.publishHandler&&t.publishHandler()},function(e){t.linkMsg(n,e.msg,"error"),t.$emit("failed",e)}):t.bpapi({url:"".concat(b.a.API_VC,"/dynamic_draft/v1/dynamic_draft/add_draft"),method:"post",data:{type:o,publish_time:Math.ceil(t.publishTime.getTime()/1e3),request:JSON.stringify(i)}}).then(function(e){t.linkMsg(n,"定时发布成功","success"),r=e.data.draft_id,a(),t.handlePublishComplete(),t.publishHandler&&t.publishHandler()},function(e){t.linkMsg(n,e.msg,"error"),t.$emit("failed",e)}))}else this.showSpecification()}},dispatchFeedUpdate:function(t){t&&this.bpapi({url:"".concat(b.a.API_VC,"/dynamic_svr/v1/dynamic_svr/get_dynamic_detail"),method:"get",data:{dynamic_id:t}}).then(function(t){l.b.$emit(Ct.b.ADD,t.data.card)})},generateAlbumFakeCard:function(t,e){try{var n={at_control:t.at_control,category:"daily",description:t.description,pictures:t.pictures,pictures_count:t.pictures.length,reply:0,role:"",source:"",title:"",id:e.doc_id},i=l.t.getMyUserInfo(),o={head_url:i.card.face,uid:i.card.mid,name:i.card.name},r={type:Ct.a.PIC,uid:~~i.card.mid,dynamic_id:"-".concat(zo),user_profile:{card:{},info:{face:i.card.face,uid:i.card.mid,uname:i.card.name,platform_user_level:(i.card.level_info||{}).current_level}},timestamp:Date.now()};zo+=1;var a={card:JSON.stringify({item:n,user:o}),desc:r,extend_json:JSON.stringify({from:{emoji_type:1}}),did:e.dynamic_id_str};l.b.$emit(Ct.b.ADD,a)}catch(t){console.error(t)}},resetPublishBox:function(){this.userInput="",this.closeImageBox(),this.emojiBoxShown=!1,this.onVoteCancel(),this.onLotteryCancel(),this.voteConfig={},this.lotteryConfig={},localStorage.setItem("dynamic_publisher_vote_".concat(this.loginUid,"_config"),"{}"),localStorage.setItem("dynamic_publisher_lottery_".concat(this.loginUid,"_config"),"{}"),localStorage.setItem("dynamic_publisher_div_html_".concat(this.loginUid),"[]"),this.editDraft||(this.isLockedAsScheduled||(this.isScheduled=!1),this.publishTime=void 0)},validatePublish:function(t){return this.imageList.length>this.publishedImages.length?(this.linkMsg(t,"请先删除不符合规格的图片 ".concat(st.j.shock()),"info"),this.textarea.focus(),!1):0===this.contentLength&&0===this.publishedImages.length?(this.textarea.focus(),!1):!(this.contentLength>this.maxLength)||(this.linkMsg(t,"输入的内容太长啦 ".concat(st.j.shock()),"info"),!1)},updateImageList:function(t){this.imageList=t,this.storeInput&&localStorage.setItem("dynamic_publisher_pic_".concat(this.loginUid),JSON.stringify(t))},showImageBox:function(){this.imageBoxShown=!0},closeImageBox:function(){this.storeInput&&localStorage.setItem("dynamic_publisher_pic_".concat(this.loginUid),"[]"),this.draftPic=[],this.imageList=[],this.selectedFiles={},this.imageBoxShown=!1},getPopupPanel:function(){var t=this.$el;if(!t.classList)return!1;for(;t&&!t.classList.contains("bp-popup-panel");)t=t.parentElement;return t},setPopupOffset:function(t){t&&(t.style.marginBottom="420px")},showSpecification:function(){var t=this;if(this.specificationAgreed||this.specificationShown)return!1;this.specificationShown=!0,this.isPopupPanel||this.bpPopup({width:796,button:{confirm:"同意并发送"},component:{name:"dynamic-specification-popup",components:{DynamicSpecification:Oo},template:"<dynamic-specification></dynamic-specification>"}}).onConfirm(function(e){e.close(),t.specificationConfirm()}).onCancel(function(e){e.close(),t.specificationCancel()})},specificationConfirm:function(){m.a.setItem("dy_spec_agreed",1,1/0,"/",".bilibili.com"),this.specificationAgreed=!0,this.specificationShown=!1,this.isScheduled?this.scheduledPublish():this.publish()},specificationCancel:function(){this.specificationShown=!1},logHandler:function(){var t="BAR"===this.type?Ct.d.PUBLISH_AT_LIST_SHOW_2:Ct.d.PUBLISH_AT_LIST_SHOW_1;Object(wt.d)(t)},insertHtmlAtCaret:function(t){Object(l.l)(t),this.textarea&&(this.textarea.value=Object(l.h)(this.textarea),this.userInput=this.textarea.value)},setSelectText:function(t,e){var n,i,o=t-e-1;if(window.getSelection){if((n=window.getSelection()).getRangeAt&&n.rangeCount){i=n.getRangeAt(0);try{i.setStart(i.commonAncestorContainer,i.endOffset-o)}catch(t){for(var r=i.endContainer,a=function t(e){var n=[];return 0===e.childNodes.length?n.push(e):Array.from(e.childNodes).forEach(function(e){n=n.concat(t(e))}),n}(this.textarea),s=r,c=Array.from(a).indexOf(r);c>=0;c--)if("#text"===a[c].nodeName){var u=a[c].nodeValue.indexOf("#");if(-1!==u){s=a[c];break}}i.setStart(s,u+1)}i.deleteContents()}}else document.selection&&"Control"!==document.selection.type&&this.textarea.setSelectionRange(e,t)},setHashPos:function(t){var e,n;window.getSelection&&(e=window.getSelection()).getRangeAt&&e.rangeCount&&(n=e.getRangeAt(0),"before"===t?this.isSafari?Object(l.r)(n.startContainer,n.endOffset-1):n.setStart(n.startContainer,n.endOffset-1):"after2"===t?this.isSafari?n.setStart(n.startContainer,n.endOffset+1):n.setStart(n.startContainer,n.endOffset+2):"after1"===t?n.setStart(n.startContainer,n.endOffset+1):"static"===t&&n.setStart(n.startContainer,n.endOffset),n.collapse(!0))},onClickVote:function(){this.isIE?this.throttleShowLimitToast():this.canVote&&(this.voteShow=!0)},onVoteCreate:function(t){var e=this;this.voteConfig=t;var n,i=t.default_text,o=t.title;this.storeInput&&localStorage.setItem("dynamic_publisher_vote_".concat(this.loginUid,"_config"),JSON.stringify(this.voteConfig)),this.textarea.focus(),this.keepIndex(this.textarea),this.clearVote(),i&&(n="".concat(i),this.insertHtmlAtCaret(n)),n='<input type="button" class="bp-vote-span" readonly value="&nbsp;​'.concat(o,'"></input>&nbsp;'),this.insertHtmlAtCaret(n),setTimeout(function(){e.addVoteClick()},0),this.voteShow=!1},onVoteCancel:function(){this.voteShow=!1},clearVote:function(){var t=this.textarea.getElementsByClassName("bp-vote-span");if(t&&t.length)for(var e=0;e<t.length;e++){var n=t[e];n.removeEventListener("click",this.onClickVote),n.nextSibling&&"#text"===n.nextSibling.nodeName&&" "===n.nextSibling.nodeValue&&n.parentNode.removeChild(n.nextSibling),n.parentNode.removeChild(n)}},addVoteClick:function(){var t=this.textarea.getElementsByClassName("bp-vote-span");if(t&&t.length)for(var e=0;e<t.length;e++)t[e].addEventListener("click",this.onClickVote)},onClickLottery:function(){this.isIE?this.throttleShowLimitToast():this.canLottery&&(this.lotteryShow=!0)},onLotteryCreate:function(t){var e,n=this,i=t.title;this.textarea.focus(),this.keepIndex(this.textarea),this.lotteryConfig.lottery_id||(this.clearLottery(),e='<input type="button" class="bp-lottery-span" readonly value="&nbsp;​'.concat(i,'"></input>&nbsp;'),this.insertHtmlAtCaret(e),setTimeout(function(){n.addLotteryClick()},0)),this.lotteryConfig=t,this.storeInput&&localStorage.setItem("dynamic_publisher_lottery_".concat(this.loginUid,"_config"),JSON.stringify(this.lotteryConfig)),this.lotteryShow=!1},onLotteryCancel:function(){this.lotteryShow=!1},clearLottery:function(){var t=this.textarea.getElementsByClassName("bp-lottery-span");if(t&&t.length)for(var e=0;e<t.length;e++){var n=t[e];n.removeEventListener("click",this.onClickLottery),n.parentNode.removeChild(n)}},addLotteryClick:function(){var t=this.textarea.getElementsByClassName("bp-lottery-span");if(t&&t.length)for(var e=0;e<t.length;e++)t[e].addEventListener("click",this.onClickLottery)},keepIndex:function(t){if(window.getSelection){t.focus();var e=window.getSelection();e.selectAllChildren(t),e.collapseToEnd()}else if(document.selection){var n=document.selection.createRange();n.moveToElementText(t),n.collapse(!1),n.select()}},autoHeight:function(t,e){var n=function(e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)},i=t.currentStyle?function(e){var n=t.currentStyle[e];if("height"===e&&1!==n.search(/px/i)){var o=t.getBoundingClientRect();return o.bottom-o.top-parseFloat(i("paddingTop"))-parseFloat(i("paddingBottom"))+"px"}return n}:function(e){return getComputedStyle(t,null)[e]},o=parseFloat(i("height"));t.style.resize="none";var r=function(){var n;t._length!==t.value.length&&(t._length=t.value.length,t.style.height=o+"px",t.scrollHeight>o&&(e&&t.scrollHeight>e?(n=e,t.style.overflowY="scroll"):(n=t.scrollHeight,t.style.overflowY="hidden"),t.style.height=n+"px"))};n("propertychange",r),n("input",r),n("focus",r),r()},switchScheduled:function(){if(!(this.editDraft||this.voteConfig.vote_id||this.voteShow||this.lotteryConfig.lottery_id||this.lotteryShow||this.isLockedAsScheduled)){var t=this.editDraft?2:this.isPopupPanel?1:0;Object(wt.d)(Ct.d.TIMER_ICON,t),this.isScheduled=!this.isScheduled}},restoreFromEditDraft:function(){var t=this,e=function(e,n){var i=e.split(""),o={"<":"&lt;",">":"&gt;"," ":"&#32;","\n":"<br/>"};return i=i.map(function(t){return o[t]||t}),n.forEach(function(e){var n,o=i.slice(e.location,e.location+e.length);t.atItems.push({uid:Number(e.data),uname:o.slice(1).join("")}),o[0]='<input type="button" class="bp-at-span" readonly value="@'.concat(o[0]),o[o.length-1]="".concat(o[o.length-1],'&nbsp;"></input>'),(n=i).splice.apply(n,[e.location,e.length].concat($o(o)))}),i.join("")},n=Object(m.e)(this.editDraft.request);if(4===this.editDraft.type&&n){var i=(Object(m.e)(n.ctrl)||[]).filter(function(t){return 1===t.type}),o=e(n.content,i);return this.isIE?Object(l.e)(n.content):Object(l.o)(o)}if(2===this.editDraft.type&&n){var r=(Object(m.e)(n.at_control)||[]).filter(function(t){return 1===t.type}),a=e(n.description,r);return this.isIE?Object(l.e)(n.description):Object(l.o)(a)}return""},scheduledPublishTips:function(){var t=this;if("undefined"!=typeof window){this.canBeScheduled&&"true"!==window.localStorage.getItem("dynamic_scheduled_publish_intro_".concat(this.loginUid))&&(t.schPubTipsVisable=!0,window.localStorage.setItem("dynamic_scheduled_publish_intro_".concat(t.loginUid),!0),setTimeout(function(){t.schPubTipsVisable=!1},5e3))}}}},Jo=(n(291),n(292),Object(P.a)(Go,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-rel f-clear publish-panel"},[n("div",{staticClass:"input-section",class:{overflow:t.contentLength>t.maxLength,active:t.textareaActive}},[[t.isIE?n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.userInput,expression:"userInput"}],ref:"textarea",staticClass:"textarea",attrs:{placeholder:"有什么想和大家分享的？"},domProps:{value:t.userInput},on:{input:function(e){e.target.composing||(t.userInput=e.target.value)}}}):n("div-edit",{ref:"textarea",staticClass:"textarea no-padding",attrs:{loginUid:t.loginUid,storeInput:t.storeInput,placeholder:"有什么想和大家分享的？"},model:{value:t.userInput,callback:function(e){t.userInput=e},expression:"userInput"}})],n("div",{directives:[{name:"show",rawName:"v-show",value:t.isScheduled,expression:"isScheduled"}],staticClass:"schedule-panel"},[n("span",{staticClass:"dp-label"},[t._v("发布时间：")]),n("date-picker",{attrs:{min:new Date,max:new Date(Date.now()+1296e6)},model:{value:t.publishTime,callback:function(e){t.publishTime=e},expression:"publishTime"}})],1)],2),t.isMounted?n("at-popup",{attrs:{"input-elm":t.textarea,"select-handler":t.selectHandler,validate:t.validate,"log-handler":t.logHandler}}):t._e(),t.isMounted?n("hash-popup",{attrs:{"input-elm":t.textarea,"button-elm":t.$refs.topicBtn,"click-button-handler":t.clickButtonHandler,"select-handler":t.selectTopicHandler,"login-uid":t.loginUid,emojiBoxShown:t.emojiBoxShown,"log-handler":t.logTopicHandler}}):t._e(),t.canVote?n("vote",{staticClass:"vote-box",attrs:{show:t.voteShow,config:t.voteConfig},on:{"vote-create":t.onVoteCreate,cancel:t.onVoteCancel}}):t._e(),t.canLottery?n("lottery",{staticClass:"lottery-box",attrs:{show:t.lotteryShow,config:t.lotteryConfig},on:{"lottery-create":t.onLotteryCreate,cancel:t.onLotteryCancel}}):t._e(),n("div",{staticClass:"action-row f-clear"},[n("div",{ref:"operateDiv",staticClass:"f-left p-rel",staticStyle:{"margin-top":"5px"}},[n("a",{ref:"emojiTrigger",staticClass:"d-i-block bp-v-middle bp-icon-font icon-emoji-btn box-toggle",class:{active:t.emojiBoxShown},staticStyle:{"margin-left":"0"},on:{click:function(e){t.emojiBoxShown=!0},mousedown:t.onMousedown}}),t.supportFileUpload?n("a",{staticClass:"d-i-block bp-v-middle bp-icon-font icon-pic-btn img-btn box-toggle",class:{active:t.imageBoxShown},on:{click:t.callFileDialog,mousedown:t.onMousedown}}):t._e(),n("a",{ref:"topicBtn",staticClass:"d-i-block bp-v-middle bp-icon-font icon-topic img-btn box-toggle",on:{mousedown:t.onMousedown}}),t.canVote&&!t.isScheduled?n("a",{ref:"voteBtn",staticClass:"d-i-block bp-v-middle bp-icon-font vote-create-btn img-btn box-toggle",class:{active:t.voteShow},on:{click:t.onClickVote,mousedown:t.onMousedown}}):t._e(),t.canLottery&&!t.isScheduled?n("a",{ref:"lotteryBtn",staticClass:"d-i-block bp-v-middle bp-icon-font lottery-create-btn img-btn box-toggle",class:{active:t.lotteryShow},on:{click:t.onClickLottery,mousedown:t.onMousedown}}):t._e(),t.canBeScheduled?n("a",{staticClass:"d-i-bloack bp-v-middle bp-icon-font icon-ic_timer img-btn box-toggle",class:{active:t.isScheduled,disabled:t.voteConfig.vote_id||t.voteShow||t.lotteryConfig.lottery_id||t.lotteryShow},on:{click:t.switchScheduled}}):t._e(),t.canBeScheduled?n("div",{directives:[{name:"show",rawName:"v-show",value:t.schPubTipsVisable,expression:"schPubTipsVisable"}],staticClass:"sch-pub-tips"},[n("span",[t._v("可以设置定时发布动态啦")]),n("i",{staticClass:"bp-icon-font icon-group-dynamic",on:{click:function(e){t.schPubTipsVisable=!1}}})]):t._e()]),n("div",{staticClass:"f-right"},[n("div",{staticClass:"d-i-block bp-v-middle length-hint"},[n("span",{class:{overflow:t.contentLength>t.maxLength}},[t._v(t._s(t.maxLength-t.contentLength))])]),t.isScheduled?t._e():n("button",{ref:"publishBtn",staticClass:"d-i-block bp-v-middle dynamic-btn pink with-border-radius publish-btn",class:{publishing:t.isPublishing,disabled:t.disabled},on:{click:t.publish}},[t._v(t._s(t.isPublishing?"发布中":"发布"))]),t.isScheduled?n("button",{ref:"publishBtn",staticClass:"d-i-block bp-v-middle with-border-radius sch-pub-btn",class:{publishing:t.isPublishing,disabled:t.schPubDisabled},on:{click:t.scheduledPublish}},[t._v(t._s(!t.editDraft&&t.scheduledCount>=20?"已满上限":"定时发布"))]):t._e()])]),t.emojiBoxShown?n("emoji-box",{staticClass:"bp-emoji-box",attrs:{field:t.textarea,"select-handler":t.emojiSelectHandler,"frozen-elements":[t.textarea,t.emojiTrigger],"emoji-type":["kaomojis","dynamicEmojis"],"spm-type":t.topicName?"TAG":"MAIN","pub-type":t.isPopupPanel?"2":"1"},on:{close:function(e){t.emojiBoxShown=!1}}}):t._e(),t.imageBoxShown?n("image-box",{staticClass:"image-box",attrs:{"init-files":t.selectedFiles,"draft-pic":t.validDraftPic},on:{update:t.updateImageList,close:t.closeImageBox}}):t._e(),t.isPopupPanel?n("bp-popup",{staticClass:"dynamic-specification-popup",attrs:{show:t.specificationShown,width:796,button:{confirm:"确认并发送"},"on-confirm":t.specificationConfirm,"on-cancel":t.specificationCancel}},[n("dynamic-specification")],1):t._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:t.schConfirmVisible,expression:"schConfirmVisible"}],staticClass:"sch-confirm-wrapper"},[n("bp-popup",{ref:"schPubConfirm",staticClass:"sch-confirm",attrs:{show:t.schConfirmVisible,button:{confirm:"是",cancel:"否"},width:360,onConfirm:t.schPubConfirm,onCancel:function(){t.schConfirmVisible=!1}}},[n("p",[t._v(t._s(t.schConfirmText))])])],1)],1)},[],!1,null,"0db885c5",null).exports);o.a.use(Object(r.a)()),o.a.use(a.a),o.a.use(s.b);var Wo=Jo;function Ko(t){return(Ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function qo(t,e){return!e||"object"!==Ko(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qo(t){return(Qo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xo(t,e){return(Xo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zo=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=qo(this,Qo(e).apply(this,arguments))).ifShowScheduleBar=!1,t.maxLength=1e3,t.isChrome=!1,t.isFirefox=!1,t.isIE=!1,t.isEdge=!1,t.isSafari=!1,t.isTheWorld=!1,t}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xo(t,e)}(e,u["c"]),n=e,(i=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.bus=new o.a,this.initBus()}},{key:"beforeMount",value:function(){var t=Object(m.d)();this.isChrome=-1!==t.indexOf("Chrome"),this.isFirefox=-1!==t.indexOf("Firefox"),this.isIE=-1!==t.indexOf("IE"),this.isEdge=-1!==t.indexOf("Edge"),this.isSafari=-1!==t.indexOf("Safari"),this.isTheWorld=-1!==t.indexOf("TheWorld")}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("schedule-trigger",function(e){t.ifShowScheduleBar=e})}},{key:"onSucceed",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.$emit.apply(this,["succeed"].concat(e))}},{key:"onFailed",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.$emit.apply(this,["succeed"].concat(e))}},{key:"fallbackOldVersion",get:function(){return this.isIE||this.isTheWorld}}])&&Yo(n.prototype,i),r&&Yo(n,r),e}();c.a([Object(u.b)()],Zo.prototype,"loginUid",void 0),c.a([Object(u.b)(Boolean)],Zo.prototype,"canLottery",void 0),c.a([Object(u.b)(Boolean)],Zo.prototype,"canVote",void 0),c.a([Object(u.b)(Boolean)],Zo.prototype,"canBeScheduled",void 0),c.a([Object(u.b)(String)],Zo.prototype,"topicName",void 0),c.a([Object(u.b)()],Zo.prototype,"editDraft",void 0),c.a([Object(u.b)(Number)],Zo.prototype,"scheduledCount",void 0),c.a([Object(u.b)(Boolean)],Zo.prototype,"storeInput",void 0),c.a([Object(u.b)(Boolean)],Zo.prototype,"isLockedAsScheduled",void 0),c.a([Object(u.b)(Function)],Zo.prototype,"publishHandler",void 0),c.a([Object(u.b)(Boolean)],Zo.prototype,"isPopupPanel",void 0);var tr=Zo=c.a([Object(u.a)({name:"publish-panel",components:{Editor:T,ScheduleBar:Y,Toolbar:fo,PublishLauncher:ko,PublishPanelV1:Wo}})],Zo),er=(n(293),Object(P.a)(tr,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.fallbackOldVersion?t._e():n("div",{staticClass:"publish-panel"},[n("div",{staticClass:"editor"},[n("editor",{attrs:{bus:t.bus,"max-length":t.maxLength,"with-schedule-bar":t.ifShowScheduleBar,"is-popup-panel":t.isPopupPanel}}),n("transition",{attrs:{name:"schedule-bar-in"}},[n("schedule-bar",{directives:[{name:"show",rawName:"v-show",value:t.ifShowScheduleBar,expression:"ifShowScheduleBar"}],attrs:{bus:t.bus}})],1)],1),n("div",{staticClass:"toolbar"},[n("toolbar",{attrs:{bus:t.bus,"is-locked-as-scheduled":t.isLockedAsScheduled,"is-popup-panel":t.isPopupPanel,"can-lottery":t.canLottery,"can-vote":t.canVote,"can-be-scheduled":t.canBeScheduled,"edit-draft":t.editDraft,"login-uid":t.loginUid}}),n("publish-launcher",{attrs:{bus:t.bus,"topic-name":t.topicName,"edit-draft":t.editDraft,"scheduled-count":t.scheduledCount,"store-input":t.storeInput,"publish-handler":t.publishHandler,"is-locked-as-scheduled":t.isLockedAsScheduled,"on-schedule-mode":t.ifShowScheduleBar,"is-popup-panel":t.isPopupPanel,"login-uid":t.loginUid},on:{succeed:t.onSucceed,failed:t.onFailed}})],1)]),t.fallbackOldVersion?n("publish-panel-v1",{attrs:{"topic-name":t.topicName,"edit-draft":t.editDraft,"scheduled-count":t.scheduledCount,"store-input":t.storeInput,"publish-handler":t.publishHandler,"is-locked-as-scheduled":t.isLockedAsScheduled,"is-popup-panel":t.isPopupPanel,"can-lottery":t.canLottery,"can-vote":t.canVote,"can-be-scheduled":t.canBeScheduled,"login-uid":t.loginUid}}):t._e()],1)},[],!1,null,"e0d83596",null).exports);o.a.use(Object(r.a)()),o.a.use(a.a),o.a.use(s.b);var nr=er;e.a=nr},function(t,e,n){"use strict";n(10),n(29);var i=n(11),o=n.n(i),r=(n(40),n(8)),a=n(4),s=n(63),c=n(51),u=n(0);function l(t,e,n,i,o,r,a){try{var s=t[r](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}function d(t){return function(){var e=this,n=arguments;return new Promise(function(i,o){var r=t.apply(e,n);function a(t){l(r,i,o,a,s,"next",t)}function s(t){l(r,i,o,a,s,"throw",t)}a(void 0)})}}var f,p,h={data:function(){return{loginId:"0",isLoginChange:!1}},components:{LinkButton:s.a,BpPopup:c.a},mounted:(p=d(o.a.mark(function t(){var e;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(r.d)();case 2:e=t.sent,this.loginId=e.mid,this.initEvents();case 5:case"end":return t.stop()}},t,this)})),function(){return p.apply(this,arguments)}),beforeDestroy:function(){this.removeEvents()},methods:{reload:function(){window.location.reload()},initEvents:function(){window.addEventListener("focus",this.checkLoginStatus)},removeEvents:function(){document.removeEventListener("focus",this.checkLoginStatus)},checkLoginStatus:(f=d(o.a.mark(function t(){var e;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(r.d)(!0);case 2:e=t.sent,(this.loginId&&void 0!==e.isLogin&&!e.isLogin||this.loginId&&void 0!==e.isLogin&&this.loginId!==e.mid)&&(this.isLoginChange=!0,a.b.$emit(u.b.REMOVE_SCROLL));case 4:case"end":return t.stop()}},t,this)})),function(){return f.apply(this,arguments)})}},m=(n(294),n(2)),g=Object(m.a)(h,function(){var t=this.$createElement,e=this._self._c||t;return this.isLoginChange?e("div",{staticClass:"check-login d-table p-fixed w-100 h-100"},[e("div",{staticClass:"panel p-abs bg-white fs-12 ff-yahei"},[e("p",{staticClass:"hint fw-bold fs-14"},[this._v("提示")]),e("p",{staticClass:"content"},[this._v("登录状态发生变化，请刷新页面")]),e("div",{staticClass:"t-center"},[e("link-button",{on:{click:this.reload}},[this._v("确认")])],1)])]):this._e()},[],!1,null,"7d0a3fd3",null);e.a=g.exports},function(t,e,n){"use strict";var i,o,r=n(9),a=n.n(r),s=n(191),c=(n(32),n(47),"PUSH_VC_AUTOPLAY"),u="REMOVE_VC_AUTOPLAY",l="SET_PLAYING_VC",d="REMOVE_PLAYING_VC",f="AUTOPLAY_NEXT_VC";function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h={state:{playingVideo:null,autoplayWaitingStack:[]},mutations:(i={},p(i,c,function(t,e){t.autoplayWaitingStack.some(function(t){return t.videoId===e.videoId})||t.autoplayWaitingStack.push({videoId:e.videoId,player:e.player})}),p(i,u,function(t,e){t.autoplayWaitingStack=t.autoplayWaitingStack.filter(function(t){return t.videoId!==e})}),p(i,l,function(t,e){null!==t.playingVideo&&t.playingVideo.player.pause(),t.playingVideo=e,t.autoplayWaitingStack.filter(function(t){return t.videoId!==e.videoId})}),p(i,d,function(t){null!==t.playingVideo&&(t.playingVideo=null)}),p(i,f,function(t){if(t.autoplayWaitingStack.length>0){var e=t.autoplayWaitingStack.pop();null!==t.playingVideo&&t.playingVideo.videoId===e.videoId||e.player.play()}}),i),actions:(o={},p(o,c,function(t,e){var n=t.commit;n(c,e),n(f)}),p(o,u,function(t,e){(0,t.commit)(u,e)}),p(o,l,function(t,e){(0,t.commit)(l,e)}),p(o,d,function(t){var e=t.commit;e(d),e(f)}),o),getters:{playingVideo:function(t){return t.playingVideo}}};a.a.use(s.a);e.a=new s.a.Store({modules:{vcPlayers:h}})},,,,,,function(t,e,n){"use strict";var i=n(9),o=n.n(i),r=n(37),a=n(42),s=(n(13),n(28),n(24),n(58),n(41),n(27),n(33),n(18),n(34),n(48),n(10),n(29),n(12),n(36),n(21),n(30),n(11)),c=n.n(s),u=(n(40),n(70)),l=n.n(u),d=n(6),f=n(4),p=n(43),h=n(7),m=n(8),g={};function v(t,e,n,i){g[e]&&g[e].indexOf(t)>-1||(t.addEventListener(e,n,i),g[e]||(g[e]=[]),g[e].push(t))}function b(t,e,n){t.removeEventListener(e,n),g[e]&&g[e].indexOf(t)>-1&&(g[e][g[e].indexOf(t)]=null)}var y=n(0),_=function(t){t.desc.repost=t.desc.repost+1};function w(t){return t<10?t="0"+t:t}function C(t){if(!+t)return t;var e=Math.floor((new Date).getTime()/1e3),n=new Date;if(n.setHours(0)&&n.setMinutes(0)&&n.setSeconds(0)&&(n=Math.floor(n.getTime()/1e3))&&t>n&&e-t>=0){if(e-t<=50){var i=10*Math.floor((e-t)%60/10);return(t>10?i:10)+"秒前"}return e-t<3600?Math.ceil((e-t)/60)+"分钟前":Math.ceil((e-t)/3600)+"小时前"}return function(t){var e=new Date;e.setTime(1e3*t);var n=[w(e.getMonth()+1),w(e.getDate()),w(e.getHours()),w(e.getMinutes())],i=n[0],o=n[1],r=n[2],a=n[3];return"".concat(e.getFullYear(),"-").concat(i,"-").concat(o," ").concat(r,":").concat(a)}(t)}var x={currentType:0,isNeedCardPopup:!0,pageType:""},I={setCurrentType:function(t){t===y.a.HOT?x.currentType="hot":t===y.a.QUICK?x.currentType="quick":x.currentType=t||0},getCurrentType:function(){return x.currentType},setIsNeedCardPopup:function(t){x.isNeedCardPopup=!!t},getIsNeedCardPopup:function(){return x.isNeedCardPopup},setPageType:function(t){x.pageType=t},getPageType:function(){return x.pageType}};function k(t,e){var n={},i=I.getPageType(),o=[];t.display&&t.display.highlight&&t.display.highlight.items&&t.display.highlight.items.forEach(function(t){o.push(t.item_id)});var r=o.join(",");if(i===y.c.MAIN)n={tab_type:I.getCurrentType()};else if(i===y.c.TAG){n={type:"S"===t.desc.topic_board?3:"A"===t.desc.topic_board?2:1}}return n=Object.assign(n,{item_id:r},e),Object.assign(Object(h.a)(t),n)}function S(t,e){var n={},i=I.getPageType(),o=[];t.display&&t.display.origin&&t.display.origin.highlight&&t.display.origin.highlight.items&&t.display.origin.highlight.items.forEach(function(t){o.push(t.item_id)});var r=o.join(",");if(i===y.c.MAIN)n={tab_type:I.getCurrentType()};else if(i===y.c.TAG){n={type:"S"===t.desc.topic_board?3:"A"===t.desc.topic_board?2:1}}return n=Object.assign({},{item_id:r},e),Object.assign(Object(h.b)(t),n)}n(15),n(19),n(35);var O=n(5),P=function(t,e){var n=Object(d.e)(t),i=Object(d.e)(e),o=i.ctrl;Array.isArray(n)||(n=[]),Array.isArray(o)||(o=[]),n=o.concat(n);var r=!1,a=!1,s=i.dispute||"";return n.forEach(function(t){2===t.type?r=!0:3===t.type&&(a=!0)}),{hasLottery:r,hasVote:a,riskTip:s}},T=function(t,e){var n={uid:0,name:"",face:"",url:"",type_desc:"",contentArray:[],clipContentArray:[],voteInfo:null,hasLottery:!1},i=t.desc.type===y.a.REPOST,o=i?t.desc.orig_type:t.desc.type,r=Object(d.e)(t.card),a=i?Object(d.e)(r.origin):r,s=a.user||{},c=i?r.origin_extend_json:t.extend_json,u=Object(d.e)(c),l={};l.vote_cfg=u.vote,l.lott_cfg=u.lott;var p=i?t.desc.orig_dy_id:t.desc.dynamic_id;l&&l.vote_cfg&&(n.voteInfo={title:l.vote_cfg.desc,desc:void 0!==l.vote_cfg.join_num?"".concat(l.vote_cfg.join_num,"人参与"):"",url:"".concat(O.a.T,"/vote/h5/index/#/result?vote_id=").concat(l.vote_cfg.vote_id,"&dynamic_id=").concat(t.desc.dynamic_id,"&isWeb=1")});var h="",g="",v={},b={},_=!1,w="",C=0,x="",I=i&&t.display?t.display.origin:t.display,k=Object(d.e)(c);switch(n.shopCards=k.open_goods&&k.open_goods.list,o){case y.a.PIC:n.uid=~~s.uid,n.name=s.name,n.face=s.head_url,n.url=e?"":"".concat(O.a.T,"/").concat(p,"?tab=2"),n.type_desc="的图片",n.pureText=a.item.description||a.item.title,n.contentArray=Object(f.q)(a.item.description||a.item.title,{ctrlJson:a.item.at_control,extendCtrlJson:c,dynamicId:p,display:I}),x=a.item.description||a.item.title,x=Object(f.i)(x)>160?Object(f.c)(x,160):Object(f.d)(x,6),n.clipContentArray=Object(f.q)(x,{ctrlJson:a.item.at_control,extendCtrlJson:c,dynamicId:p,display:I,isClip:!0}),n.renderOpts={ctrlJson:a.item.at_control,extendCtrlJson:c,dynamicId:p,display:I},b=P(a.item.at_control,c),n.hasLottery=b.hasLottery,n.riskTip=b.riskTip,n.images=a.item.pictures.map(function(t){return t.img_src=Object(d.g)(t.img_src),t});break;case y.a.WORD:n.uid=~~s.uid,n.name=s.uname,n.face=s.face,n.url=e?"":"".concat(O.a.T,"/").concat(p,"?tab=2"),n.type_desc="的动态",n.pureText=a.item.content,n.contentArray=Object(f.q)(a.item.content,{ctrlJson:a.item.ctrl,extendCtrlJson:c,dynamicId:p,display:I}),x=a.item.content,x=Object(f.i)(x)>160?Object(f.c)(x,160):Object(f.d)(x,6),n.clipContentArray=Object(f.q)(x,{ctrlJson:a.item.ctrl,extendCtrlJson:c,dynamicId:p,display:I,isClip:!0}),n.renderOpts={ctrlJson:a.item.ctrl,extendCtrlJson:c,dynamicId:p,display:I},b=P(a.item.ctrl,c),n.hasLottery=b.hasLottery,n.riskTip=b.riskTip;break;case y.a.VIDEO:n.uid=~~a.owner.mid,n.name=a.owner.name,n.face=a.owner.face,n.url=Object(m.f)(a.aid,t.desc.bvid||t.desc.origin&&t.desc.origin.bvid),n.type_desc="的投稿视频",n.pureText=a.dynamic,n.contentArray=Object(f.q)(a.dynamic,{ctrlJson:a.ctrl,extendCtrlJson:c,dynamicId:p,display:I}),x=a.dynamic,x=Object(f.i)(x)>160?Object(f.c)(x,160):Object(f.d)(x,6),n.clipContentArray=Object(f.q)(x,{ctrlJson:a.ctrl,extendCtrlJson:c,dynamicId:p,display:I,isClip:!0}),n.renderOpts={ctrlJson:a.ctrl,extendCtrlJson:c,dynamicId:p,display:I},b=P(a.ctrl,c),n.hasLottery=b.hasLottery,n.riskTip=b.riskTip,n.image=a.pic,n.title=a.title,n.desc=a.desc,n.aid=a.aid,n.duration=a.duration,n.view=a.stat.view,n.danmaku=a.stat.danmaku,n.needPay=a.rights&&!!a.rights.ugc_pay,n.isCooperation=a.rights&&!!a.rights.is_cooperation;break;case y.a.CHEESE_SERIES:n.uid=~~a.up_id,n.name=a.up_info.name,n.face=a.up_info.avatar,n.url=a.url,n.type_desc="的付费课程",n.pureText=a.dynamic,n.contentArray=Object(f.q)(a.dynamic,{ctrlJson:a.ctrl,extendCtrlJson:c,dynamicId:p,display:I}),x=a.dynamic,x=Object(f.i)(x)>160?Object(f.c)(x,160):Object(f.d)(x,6),n.clipContentArray=Object(f.q)(x,{ctrlJson:a.ctrl,extendCtrlJson:c,dynamicId:p,display:I,isClip:!0}),n.renderOpts={ctrlJson:a.ctrl,extendCtrlJson:c,dynamicId:p,display:I},b=P(a.ctrl,c),n.hasLottery=b.hasLottery,n.riskTip=b.riskTip,n.image=a.cover,n.title=a.title,n.subtitle=a.subtitle,n.desc=a.update_info||"",n.id=a.id||0;break;case y.a.CHEESE_UPDATE:n.uid=~~a.up_id,n.name=a.up_info.name,n.face=a.up_info.avatar,n.url=a.url,n.type_desc="的付费课程",n.pureText=a.dynamic,n.contentArray=Object(f.q)(a.dynamic,{ctrlJson:a.ctrl,extendCtrlJson:c,dynamicId:p,display:I}),x=a.dynamic,x=Object(f.i)(x)>160?Object(f.c)(x,160):Object(f.d)(x,6),n.clipContentArray=Object(f.q)(x,{ctrlJson:a.ctrl,extendCtrlJson:c,dynamicId:p,display:I,isClip:!0}),n.renderOpts={ctrlJson:a.ctrl,extendCtrlJson:c,dynamicId:p,display:I},b=P(a.ctrl,c),n.hasLottery=b.hasLottery,n.riskTip=b.riskTip,n.image=a.cover,n.title=a.new_ep.title,n.subtitle=a.title;var S=a.update_count,T="等".concat(S,"个视频更新");n.desc=S>1?T:"",n.id=a.id||0;break;case y.a.CLIP:n.uid=~~s.uid,n.name=s.name,n.face=s.head_url,n.url="".concat(O.a.VC,"/video/").concat(a.item.id),n.type_desc="的小视频",n.pureText=a.item.description,n.contentArray=Object(f.q)(a.item.description,{ctrlJson:a.item.at_control,extendCtrlJson:c,dynamicId:p,display:I}),x=a.item.description,x=Object(f.i)(x)>160?Object(f.c)(x,160):Object(f.d)(x,6),n.clipContentArray=Object(f.q)(x,{ctrlJson:a.item.at_control,extendCtrlJson:c,dynamicId:p,display:I,isClip:!0}),n.renderOpts={ctrlJson:a.item.at_control,extendCtrlJson:c,dynamicId:p,display:I},b=P(a.item.at_control,c),n.hasLottery=b.hasLottery,n.riskTip=b.riskTip,n.cover=a.item.cover.default,n.duration=a.item.video_time;break;case y.a.ARTICLE:n.uid=~~a.author.mid,n.name=a.author.name,n.face=a.author.face,n.url="".concat(O.a.MAIN,"/read/cv").concat(a.id),n.type_desc="的文章",n.pureText=a.dynamic,n.contentArray=Object(f.q)(a.dynamic,{dynamicId:t.desc.orig_dy_id||t.desc.dynamic_id,extendCtrlJson:c,display:I}),x=a.dynamic,x=Object(f.i)(x)>160?Object(f.c)(x,160):Object(f.d)(x,6),n.clipContentArray=Object(f.q)(x,{dynamicId:t.desc.orig_dy_id||t.desc.dynamic_id,extendCtrlJson:c,display:I,isClip:!0}),n.renderOpts={dynamicId:t.desc.orig_dy_id||t.desc.dynamic_id,extendCtrlJson:c,display:I},b=P(a.ctrl,c),n.riskTip=b.riskTip,n.images=a.image_urls,n.title=a.title,n.desc=a.summary;break;case y.a.MUSIC:n.uid=~~a.upId,n.name=a.upper,n.face=a.upperAvatar,n.url="".concat(O.a.MAIN,"/audio/au").concat(a.id,"?type=7"),n.type_desc="的音频",n.pureText=a.intro,n.contentArray=Object(f.q)(a.intro),x=a.intro,x=Object(f.i)(x)>160?Object(f.c)(x,160):Object(f.d)(x,6),n.clipContentArray=Object(f.q)(x,{isClip:!0}),b=P(a.ctrl,c),n.riskTip=b.riskTip,n.title=a.title,n.cover=a.cover,n.desc=a.typeInfo;break;case y.a.BANGUMI:case y.a.PGC_BANGUMI:case y.a.GUOCHUANG:v=a.apiSeasonInfo||a.season||{},n.name=v.title,n.title_url="".concat(O.a.BANGUMI,"/anime/").concat(v.season_id),b=P(a.ctrl,c),n.riskTip=b.riskTip,n.cover=a.cover,n.play_count=a.play_count,n.bullet_count=a.bullet_count,n.url=a.url,4===v.bgm_type?n.tags=[{name:"国创"}]:n.tags=[{name:"番剧"}],a.new_desc?n.title=a.new_desc:(h=a.index.match(/第\S集/)?a.index:"第".concat(a.index,"集"),g=a.index_title,n.title=g&&""!==g?h+" - "+g:h);break;case y.a.COMIC_SHARE:case y.a.H5_SHARE:n.uid=~~s.uid,n.name=s.uname,n.face=s.face,n.url="".concat(O.a.T,"/").concat(p,"?tab=2"),n.type_desc="的分享",b=P(a.ctrl,c),n.riskTip=b.riskTip,_=101===a.sketch.biz_type,o===y.a.COMIC_SHARE&&(n.tagsText=a.sketch.text),w=a.vest.content,n.pureText=w,n.contentArray=Object(f.q)(w,{ctrlJson:a.vest.ctrl,extendCtrlJson:c,isRemark:_,display:I}),x=w,x=Object(f.i)(x)>160?Object(f.c)(x,160):Object(f.d)(x,6),n.clipContentArray=Object(f.q)(x,{ctrlJson:a.vest.ctrl,extendCtrlJson:c,isRemark:_,display:I,isClip:!0}),n.renderOpts={ctrlJson:a.vest.ctrl,extendCtrlJson:c,isRemark:_,display:I},n.cover=a.sketch.cover_url,n.title=a.sketch.title,n.desc=a.sketch.desc_text,n.target_url=a.sketch.target_url,n.tag=a.sketch.tags||[];break;case y.a.FILM:n.name=a.apiSeasonInfo.title,n.title_url="".concat(O.a.BANGUMI,"/anime/").concat(a.apiSeasonInfo.season_id),n.cover=a.cover,n.play_count=a.play_count,n.bullet_count=a.bullet_count,n.url=a.url,b=P(a.ctrl,c),n.riskTip=b.riskTip,n.tags=[{name:"电影"}],a.new_desc?n.title=a.new_desc:n.title=a.apiSeasonInfo.title;break;case y.a.TV:v=a.apiSeasonInfo||a.season||{},n.name=v.title,n.title_url="".concat(O.a.BANGUMI,"/anime/").concat(v.season_id),n.cover=a.cover,n.play_count=a.play_count,n.bullet_count=a.bullet_count,n.url=a.url,n.tags=[{name:v.type_name||"电视剧"}],b=P(a.ctrl,c),n.riskTip=b.riskTip,a.new_desc?n.title=a.new_desc:a.index_title?n.title=a.index_title:a.index&&a.index.match(/第\S集/)?n.title=a.index:n.title="第".concat(a.index||1,"集");break;case y.a.DOCUMENTARY:v=a.apiSeasonInfo||a.season||{},n.name=v.title,n.title_url="".concat(O.a.BANGUMI,"/anime/").concat(v.season_id),n.cover=a.cover,n.play_count=a.play_count,n.bullet_count=a.bullet_count,n.url=a.url,n.tags=[{name:"纪录片"}],b=P(a.ctrl,c),n.riskTip=b.riskTip,a.new_desc?n.title=a.new_desc:(h=a.index.match(/第\S集/)?a.index:"第".concat(a.index,"集"),g=a.index_title,n.title=g?h+" - "+g:h);break;case y.a.LIVE_ROOM:case y.a.LIVE:n.uid=~~a.uid,n.name=a.uname,n.face=a.face,n.url="//live.bilibili.com/".concat(a.roomid),n.type_desc="的直播间",n.cover=a.user_cover||a.cover,n.title=a.title,n.view_num="".concat(a.online,"人气"),n.area_name=a.area_v2_name,b=P(a.ctrl,c),n.riskTip=b.riskTip,0===(C=a.live_status)?(n.status="直播结束",n.show_view_num=!1):1===C?(n.status="直播中",n.show_view_num=!0):2===C&&(n.status="直播结束",n.show_view_num=!1);break;case y.a.MEDIA_LIST:n.uid=~~a.upper.mid,n.name=a.upper.name,n.face=a.upper.face,n.url="//www.bilibili.com/medialist/detail/ml".concat(a.id),n.type_desc="的收藏夹",n.cover=a.cover,n.coverType=a.cover_type,n.title=a.title,n.description=a.intro,n.contentCount=a.media_count,b=P(a.ctrl,c),n.riskTip=b.riskTip}return n},E=(n(237),n(31),n(54)),j=(n(32),n(73),n(74),n(53),n(76),n(57),104),L=214,A=518;function D(t){var e=t.length>1?1:0;return t.map(function(t,n){var i,o=Object.assign({},t);return o.cardDisplay=Object(m.b)(o.img_src,o.img_width,o.img_height,e),o.img_src=encodeURI(o.img_src),o.img_src_zoom=(i=N(o.img_src),Object(d.g)(Object(m.a)(i,j,j,{e:1,c:1,useWebp:!1}))),o.img_src_boost=function(t){var e=t.img_src,n=t.img_width,i=(t.img_height,N(e));return n<A?Object(d.g)(Object(m.a)(i,null,null,{useWebp:!1})):Object(d.g)(Object(m.a)(i,A,null,{e:1,c:1,useWebp:!1}))}(o),o.img_src_zoom_one=function(t){var e=N(t.img_src);return Object(d.g)(Object(m.a)(e,L,L,{e:1,c:1,useWebp:!1}))}(o),o.rotate=function(t){var e,n,i,o,r=t.img_width,a=t.img_height;r>a?r>A?(e=A,n=(A-A*a/r)/2,i=0,o=A*a/r):(e=r,n=(r-a)/2,i=(A-r)/2,o=a):a>A?(n=-(A-(e=A*r/a))/2,i=(A-e)/2,o=r>A?A*a/r:a):(n=-(a-(e=r))/2,i=(A-r)/2,o=a);return[{ch:o,ih:o,maxWidth:A+"px"},{ih:o,ch:e,position:"absolute",top:n+"px",left:i+"px",transform:"rotate(90deg)",maxHeight:A+"px"},{ih:o,ch:o,transform:"rotate(180deg)"},{ih:o,ch:e,position:"absolute",top:n+"px",left:i+"px",transform:"rotate(270deg)",maxHeight:A+"px"}]}(o),o.loader=function(t,e){var n=t.img_src_boost;return function(){return new Promise(function(t,i){var o=new Image;o.src=n,o.onload=function(){t(e)},o.onerror=function(){i(e)}})}}(o,n),o.status="ready",o})}function M(t){var e=document.documentElement.scrollTop||document.body.scrollTop;return t?t.getBoundingClientRect?t.getBoundingClientRect().top+e:function t(e){return e.offsetParent===document.body?e.offsetTop:e.offsetTop+t(e.offsetParent)}(t):0}function N(t){return t.indexOf("@")>-1?t.split("@")[0]:t}n(354);function R(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}
/**
 * PhotoImager is an image viewer for website.
 * Please check documention for more detail.
 *
 * @license MIT
 */
var B=!1;"undefined"!=typeof window&&(B=window.navigator.userAgent.indexOf("Firefox")>-1);var U=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._images=[],this._isFavourite=!1,this._isSupported=!1,this._isAuthorized=!1,this._config=null,this._vm=null,this.inited=!1,this._imageMeta={originalWidth:0,originalHeight:0},this._clickeEvents=[],this.config=e}var e,n,i;return e=t,i=[{key:"setOrignalImageSize",value:function(t){var e=t._imageViewer;e.style.width=t._imageMeta.originalWidth+"px",e.style.height=t._imageMeta.originalHeight+"px"}},{key:"setReactiveImageSize",value:function(e){var n=window.innerWidth||document.documentElement.offsetWidth,i=window.innerHeight||document.documentElement.offsetHeight,o=e._imageViewer;t.setOrignalImageSize(e);var r=e._currentImageSize,a=r.width,s=r.height,c=a/s,u=n/i;if(a>n||s>i){switch(!0){case c<1:$(o,i);break;case 1===c:if(u>=1&&s>=i){$(o,i);break}a>=n&&H(o,n);break;case c>1:s>=i&&$(o,i),a>=n&&H(o,n)}if(n>800){var l=.8*n-150;e._currentImageSize.width>l&&H(o,l)}}}},{key:"setReactiveImagePosition",value:function(t){var e=window.innerWidth||document.documentElement.offsetWidth,n=window.innerHeight||document.documentElement.offsetHeight,i=t._imageViewer,o=F(i),r=(e-o.width)/2,a=(n-o.height)/2;i.style.left=(r>0?r:0)+"px",i.style.top=(a>0?a:0)+"px",t._pre&&(t._pre.style.width=i.style.left),t._next&&(t._next.style.width=i.style.left)}}],(n=[{key:"_init",value:function(t){this.inited||(void 0!==t.element?this._initByElement(t):this._initByValues(t),this._createComponent(t),this.isSupported=!!t.isSupported,this.isFavourite=!!t.isFavourite,this.isAuthorized=!!t.isAuthorized)}},{key:"_initByElement",value:function(t){for(var e=this,n=("string"==typeof t.element?document.querySelector(t.element):t.element).querySelectorAll("[data-photo-imager-src]"),i=function(t,i){var o=n[t],r=o.getAttribute("data-photo-imager-src")||"",a=o.getAttribute("title")||"",s=function(){e.currentImage=t,e.show()};o.addEventListener("click",s),e._clickeEvents.push({el:o,handler:s,type:"click"}),e.images.push({url:r,title:a})},o=0,r=n.length;o<r;o++)i(o)}},{key:"_initByValues",value:function(t){if(void 0!==t.images&&"[object Array]"!==Object.prototype.toString.call(t.images))throw new TypeError("[".concat("PhotoImager","] images 参数必须为 Array."));this.images=t.images.map(function(t){return Object.assign({},t,{url:t.url||"",title:t.title||""})})||[],this.images.length||void 0===this.images||this.images.push(t.image||{title:"",url:""})}},{key:"_createComponent",value:function(e){var n=this,i=document.createElement("div");document.body.appendChild(i);var r=new o.a({data:function(){return{config:e,isSupported:!1,isFavourite:!1,isAuthorized:!1,images:n.images,showComponent:!1,imageInLoading:!0,currentImage:0,totalImages:n.totalImages,eventInited:!1,useZoomingFunc:!1,inActualSize:!1,loadingImageUrl:"",showHinter:!1}},template:'<div class="photo-imager-container" v-show="showComponent" :class="{\'preview-mode\': useZoomingFunc && !inActualSize, \'actual-size\': useZoomingFunc && inActualSize}">\n      <div class="image-container" v-show="!imageInLoading" track-name="big_see">\n        <img class="image-viewer" @contextmenu="rightMouseFunc($event)" :src="showingImage.url" alt="Image" ref="imageViewer" :title="showingImage.title" :style="{ \'z-index\': inActualSize ? 12 : 0 }">\n      </div>\n\n      <div class="loading-image-container" v-show="imageInLoading" style="text-align: center">\n        <img class="image-viewer" @contextmenu="rightMouseFunc($event)" :src="loadingImageUrl">\n      </div>\n\n      <div class="control-buttons" v-show="!inActualSize">\n        <button class="control-button prev" ref="pre" @click="goPrev" v-if="totalImages > 1 && currentImage > 0"></button>\n        <button class="control-button next" ref="next" @click="goNext" v-if="totalImages > 1 && currentImage < totalImages - 1"></button>\n        <button class="close-button" @click="close">\n          <i class="bp-icon-font icon-close"></i>\n        </button>\n      </div>\n\n      <div class="image-hinter-ctnr" @mouseenter="openHinter($event)" @mouseleave="closeHinter($event)" v-show="!inActualSize">\n        <div class="image-count-hinter" :class="{\'show\': showHinter}">\n          <div class="count-hinter">\n            <span class="current-index">{{currentImage + 1}}</span>\n            <span>/ {{totalImages}}</span>\n          </div>\n          <div v-if="isAuthorized" class="view-actual-pictrue">\n            <a :href="showingImage.url" target="_blank">查看原图</a>\n          </div>\n        </div>\n      </div>\n\n      <button class="support-button" v-if="config.showSupportWidget" v-show="isSupported !== \'undefined\' && !inActualSize" @click="onSupport" :class="{actived: isSupported}" track-name="big_sup">\n        <div>\n          <i class="icon bp-svg-icon" :class="isSupported ? \'good-4\' : \'good-1\'"></i>\n        </div>\n        <div>\n          <span class="label" v-text="isSupported ? \'已点赞\' : \'点赞\'"></span>\n        </div>\n      </button>\n\n      <button class="favourite-button" v-if="config.showFavouriteWidget" v-show="isFavourite !== undefined && !inActualSize" @click="onFavourite" :class="{actived: isFavourite}" track-name="big_col">\n        <div>\n          <i class="icon bp-svg-icon" :class="isFavourite ? \'collection-4\' : \'collection-icons\'"></i>\n        </div>\n        <div>\n          <span class="label" v-text="isFavourite ? \'已收藏\' : \'收藏\'"></span>\n        </div>\n      </button>\n\n      <div class="loading-progress" role="progress" v-show="imageInLoading">\n        <i class="loading-icon"></i>\n      </div>\n    </div>\n    ',computed:{showingImage:function(){return this.images[this.currentImage]}},methods:{openHinter:function(){var t=this,e=null;return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:NaN,i=t;clearTimeout(e),i.showHinter=!0,n&&!isNaN(n)&&(e=setTimeout(function(){return i.closeHinter()},n))}},closeHinter:function(){this.showHinter=!1},rightMouseFunc:function(t){!1!==this.isAuthorized&&(this.popMessage(t.pageX,t.pageY,"作者设置了禁止保存，不可以偷偷存图哦~"),t.returnValue=!1)},popMessage:function(t,e,n){var i=document.createDocumentFragment(),o=document.createElement("div");o.innerHTML='<span class="toast-text">'.concat(n,"</span>"),o.className="pop-message",o.style.left=t+"px",o.style.top=e+"px",setTimeout(function(){o.className+=" out",setTimeout(function(){o.parentNode.removeChild(o)},350)},2e3),i.appendChild(o),document.body.appendChild(i)},resetState:function(){this.imageInLoading=!0,this.useZoomingFunc=!1},goPrev:function(){n.currentImage>0&&n.images.length&&!this.imageInLoading&&(n.currentImage--,this.inActualSize=!1),n.currentImage<=0&&this.openHinter(3e3)},goNext:function(){this.currentImage<n.totalImages-1&&!this.imageInLoading&&(n.currentImage++,this.inActualSize=!1),n.currentImage>=n.totalImages-1&&this.openHinter(3e3)},show:function(){this.showComponent=!0,e.hideBodyScroll&&z()},close:function(){this.releaseEvent(),this.showComponent=!1,e.hideBodyScroll&&J(),setTimeout(this.destroy)},destroy:function(){var t=this.$refs.imageViewer;t.removeEventListener("click",this.zoomingEvent),t.removeEventListener("load",this.imageOnLoad),this.releaseEvent(),this.$el.parentElement.removeChild(this.$el),this.$destroy()},onSupport:function(t){if("function"==typeof e.onSupport){var i=!this.isSupported;e.onSupport(i,t.target).then(function(){n.isSupported=i}).catch(function(){})}},onFavourite:function(t){if("function"==typeof e.onFavourite){var i=!this.isFavourite;e.onFavourite(i,t.target).then(function(){n.isFavourite=i}).catch(function(){})}},releaseEvent:function(){var t=this;window.removeEventListener("resize",t.setImagePositionAndSize),window.removeEventListener("keyup",t.keyUpEvent),window.removeEventListener("mousewheel",t.scrollingEvent),B&&window.removeEventListener("DOMMouseScroll",t.scrollingEvent),t.eventInited=!1},imageOnLoad:function(){var t=this,e=this;e.imageInLoading=!1,this.$nextTick(function(){var i=V(t.$refs.imageViewer),o=i.width,r=i.height;n._imageMeta.originalWidth=o,n._imageMeta.originalHeight=r,e.setZoomable(),e.setImagePositionAndSize()})},setZoomable:function(){var t=window.innerWidth||document.documentElement.offsetWidth,e=window.innerHeight||document.documentElement.offsetHeight,n=V(this.$refs.imageViewer),i=n.width,o=n.height;(t<i||e<o)&&(this.inActualSize=!1,this.useZoomingFunc=!0)},scrollingEvent:function(t){if(!this.inActualSize){t.preventDefault();var e=0;t.wheelDelta?e=t.wheelDelta:t.detail&&(e=-1*t.detail),e<0?this.goNext():this.goPrev()}},zoomingEvent:function(){if(this.useZoomingFunc){var i=!this.inActualSize;this.inActualSize=i,i?(t.setOrignalImageSize(n),t.setReactiveImagePosition(n),z()):(this.setImagePositionAndSize(),e.hideBodyScroll||J())}},keyUpEvent:function(t){var e=this;switch(t.keyCode){case 27:e.close();break;case 37:!e.inActualSize&&e.goPrev();break;case 39:!e.inActualSize&&e.goNext()}},setImagePositionAndSize:function(){n._setImagePositionAndSize(),this.setZoomable()},initEvent:function(){var t=this;if(!t.eventInited){var e=this.$refs.imageViewer,n=new Image;n.addEventListener("load",function e(){t.imageOnLoad(),n.removeEventListener("load",e)}),n.src=t.loadingImageUrl,e.addEventListener("load",t.imageOnLoad),e.addEventListener("click",t.zoomingEvent),window.addEventListener("resize",t.setImagePositionAndSize),window.addEventListener("keyup",t.keyUpEvent),window.addEventListener("mousewheel",t.scrollingEvent,{passive:!1}),B&&window.addEventListener("DOMMouseScroll",t.scrollingEvent),t.eventInited=!0}}},created:function(){this.loadingImageUrl=this.showingImage.url},mounted:function(){this.showComponent&&this.initEvent()},watch:{"showingImage.url":function(t){var e=this,n=this;n.loadingImageUrl="",this.$nextTick(function(){n.loadingImageUrl=t;var i=e.$refs.imageViewer;n.resetState(),i.style.width="",i.style.height=""})},showComponent:function(t){var e=this;t&&this.$nextTick(function(){e.initEvent()})}}});r.$mount(i),this._vm=r}},{key:"_setImagePositionAndSize",value:function(){var e=this;window.requestAnimationFrame?window.requestAnimationFrame(function(){t.setReactiveImageSize(e),t.setReactiveImagePosition(e)}):(t.setReactiveImageSize(this),t.setReactiveImagePosition(this))}},{key:"goPrev",value:function(){this._vm.goPrev()}},{key:"goNext",value:function(){this._vm.goNext()}},{key:"show",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._init(this.config),t<0&&(t=0),t>this.totalImages-1&&(t=this.totalImages-1),this._vm.show(),"number"==typeof t&&(this.currentImage=t)}},{key:"close",value:function(){this._vm.close()}},{key:"destroy",value:function(){this._clickeEvents.forEach(function(t){t.el.removeEventListener(t.type,t.handler)}),this._vm.destroy()}},{key:"images",get:function(){return this._images},set:function(t){this._vm&&void 0!==this._vm.images&&(this._vm.images=t),this._images=t}},{key:"isFavourite",get:function(){return this._isFavourite},set:function(t){this._isFavourite=t,this._vm&&void 0!==this._vm.isFavourite&&(this._vm.isFavourite=t)}},{key:"isSupported",get:function(){return this._isSupported},set:function(t){this._isSupported=t,this._vm&&void 0!==this._vm.isSupported&&(this._vm.isSupported=t)}},{key:"isAuthorized",get:function(){return this._isAuthorized},set:function(t){this._isAuthorized=t,this._vm&&void 0!==this._vm.isAuthorized&&(this._vm.isAuthorized=t)}},{key:"currentImage",get:function(){return this._vm.currentImage},set:function(t){this._vm.currentImage=t}},{key:"totalImages",get:function(){var t=this.images.length;return this._vm&&"number"==typeof this._vm.totalImages&&(this._vm.totalImages=t),t}},{key:"config",get:function(){return this._config},set:function(t){this._config=t,this._vm&&(this._vm.config=t)}},{key:"_currentImageSize",get:function(){return F(this._vm.$refs.imageViewer)}},{key:"_imageViewer",get:function(){return this._vm.$refs.imageViewer}},{key:"_pre",get:function(){return this._vm.$refs.pre}},{key:"_next",get:function(){return this._vm.$refs.next}}])&&R(e.prototype,n),i&&R(e,i),t}();function H(t,e){t.style.width=e+"px",t.style.height="auto"}function $(t,e){t.style.height=e+"px",t.style.width="auto"}function F(t){return t.getBoundingClientRect()}function V(t){return{width:t.naturalWidth,height:t.naturalHeight}}function z(){document.body.style.overflow="hidden"}var G="undefined"!=typeof window?document.body.style.overflow:"";function J(){document.body.style.overflow=G}var W={name:"dot-loading"},K=(n(355),n(2)),Y=Object(K.a)(W,function(){var t=this.$createElement;this._self._c;return this._m(0)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"dot-loading"},[e("span",{staticClass:"dot"},[e("em",{staticClass:"dot1"}),e("em",{staticClass:"dot2"}),e("em",{staticClass:"dot3"})])])}],!1,null,"47988eef",null).exports;function q(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function Q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?q(n,!0).forEach(function(e){X(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):q(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function X(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Z={name:"ImagesBox",props:{images:{type:Array,default:function(){return[]}},parentDOM:{default:function(){return null}},scrollToViewPort:{type:Function},extendCallback:{type:Function,default:function(t,e){0}},originCallback:{type:Function,default:function(t,e){0}},showImgTag:null,dynamicId:String,spmPageTypeString:String},components:{Loading:Y},mounted:function(){var t,e=new U({images:(t=this.images,t.map(function(t){return{url:t.img_src,width:t.img_width,height:t.img_height}})),showSupportWidget:!1,showFavouriteWidget:!1,hideBodyScroll:!0});this.photoImager=e;this.spmId={live:"444.46",topic:"333.169",space:"333.49",dt:"444.42"}[this.spmPageTypeString]},data:function(){return{HOST:O.a,imgList:D(this.images),mode:"zoom",activeIndex:-1,boostSrc:"",zloading:!1,bloading:!1,pageSize:Math.ceil(this.images.length/9),rotateStatus:0,rotate:{},ch:"",openingTags:[]}},methods:{safeJsonParse:d.e,ChangeMode:function(t){var e=this;return this.zloading=!1,this.bloading=!1,this.ReturnToViewPort(),this.$nextTick(function(){e.mode=t}),!0},ChangeActiveIndex:function(t){this.activeIndex=t},ChangeBoostSrc:function(t){this.InitStatus(),this.boostSrc=this.imgList[t].img_src_boost},ChangeContainerHeight:function(){this.ch=this.rotate.ch,this.ReturnToViewPort()},InitStatus:function(){this.boostSrc="",this.ch="",this.rotate=this.imgList[this.activeIndex].rotate[0],this.rotateStatus=0},ReturnToViewPort:function(){var t=this;this.$nextTick(function(){if(t.scrollToViewPort)t.scrollToViewPort();else{var e,n=M(t.$refs.container),i=document.documentElement.scrollTop||document.body.scrollTop;e=t.parentDOM?M(t.parentDOM):n-150,i>n&&window.scrollTo(0,e)}})},ChangeStatus:function(t,e){this.$set(this.imgList,t,Q({},this.imgList[t],{},{status:e}))},ZoomToBoost:function(t){var e=this;if(!this.zloading){var n=this.imgList[t];n.img_tags&&n.img_tags.length>0?this.openingTags=n.img_tags:this.openingTags=[];var i=n.status,o=n.loader;switch(this.ChangeActiveIndex(t),i){case"ready":case"error":n.status="loading",this.zloading=!0,(n.loader=o()).then(function(){e.ChangeBoostSrc(t),e.ChangeMode("boost"),e.zloading=!1,n.status="loaded",e.imgList.forEach(function(n,i){if(t!==i){n.status="loading";var o=n.loader;(n.loader=o()).then(function(){n.status="loaded"}).catch(function(t){e.imgList[t].status="error",e.imgList[t].loader=o})}})}).catch(function(t){e.zloading=!1,e.imgList[t].status="error",e.imgList[t].loader=o});break;case"loading":this.zloading=!0,n.loader.then(function(){e.ChangeBoostSrc(t),e.ChangeMode("boost"),e.zloading=!1,n.status="loaded"});break;case"loaded":this.ChangeBoostSrc(t),this.ChangeMode("boost")}this.extendCallback(t,this.imgList[t].img_src)}},SwitchBoost:function(t){var e=this;this.ChangeActiveIndex(t);var n=this.imgList[t];n.img_tags&&n.img_tags.length>0?this.openingTags=n.img_tags:this.openingTags=[];var i=n.status,o=n.loader;switch(i){case"error":this.bloading=!1,this.ChangeBoostSrc(t);break;case"loading":this.bloading=!0,o.then(function(t){t===e.activeIndex&&(e.bloading=!1,e.ChangeBoostSrc(t))});break;case"loaded":this.bloading=!1,this.ChangeBoostSrc(t)}},OpenPhotoImager:function(t){this.photoImager.show(t),this.originCallback(t,this.imgList[t].img_src)},TurnToLeft:function(){this.rotateStatus--,this.rotateStatus<0&&(this.rotateStatus=3),this.rotate=this.imgList[this.activeIndex].rotate[this.rotateStatus],this.ch=this.rotate.ch},TurnToRight:function(){this.rotateStatus++,this.rotateStatus>3&&(this.rotateStatus=0),this.rotate=this.imgList[this.activeIndex].rotate[this.rotateStatus],this.ch=this.rotate.ch},imgBg:function(t){var e=this.imgList.length,n=t.cardDisplay;return 1===e?"background-image: url(".concat(n.url,"); width: ").concat(n.width,"px; height: ").concat(n.height,"px"):"background-image: url(".concat(n.url,")")},tagReport:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"click";this.spmId&&this.$bpreport.click({logId:"000502",spmId:this.spmId,event:"card_pic_tag_"+e,data:{card_id:this.dynamicId,tag_type:t.type>1||1===t.type&&1===t.source_type?t.type+1:t.type,tag_name:t.text}})}},computed:{pageNo:function(){return Math.floor(this.activeIndex/9)+1},onlyOneCardStyle:function(){return 1===this.imgList.length&&this.imgList[0].img_width<200&&this.imgList[0].img_height<200?"width: auto; height: auto;":""},perTagPercentagePosition:function(){var t=this;return this.openingTags.length>0&&this.showImgTag?this.openingTags.map(function(e){var n=e.x/1e3,i=e.y/1e3,o=1===e.orientation;n>100?n=100:n<0&&(n=0),i>100?i=100:i<0&&(i=0);var r="";return r=o?"right: ".concat(100-n,"%; top: ").concat(i,"%;"):"left: ".concat(n,"%; top: ").concat(i,"%;"),4===e.type&&(e.text=Object(d.e)(e.poi).poi_info,e.text=e.text&&e.text.show_title),t.tagReport(e,"show"),Q({},e,{reverse:o,style:r})}):[]}},watch:{boostSrc:function(t){""===t&&(this.openingTags=[])}}},tt=(n(356),n(357),Object(K.a)(Z,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"container",staticClass:"imagesbox"},["zoom"===t.mode?n("div",{staticClass:"zoom-wrap"},[n("ul",{staticClass:"zoom-list list-none",class:"zoom-"+t.imgList.slice(0,9).length,style:t.onlyOneCardStyle},t._l(t.imgList.slice(0,9),function(e,i){return n("li",{key:i+e.status,staticClass:"card",class:"card-"+t.imgList.slice(0,9).length,style:t.onlyOneCardStyle,on:{click:function(e){return t.ZoomToBoost(i)}}},[n("div",{staticClass:"img-content",class:{"bg-top":e.cardDisplay.gifTop},style:t.imgBg(e),on:{error:function(e){return t.ChangeStatus(i,"error")}}}),e.img_tags&&e.img_tags.length?n("div",{staticClass:"tag-img",class:{small:t.imgList.length>1}}):t._e(),t.zloading&&t.activeIndex===i?n("div",{staticClass:"z-loading"},[n("loading")],1):t._e(),"error"===e.status?n("div",{staticClass:"z-error"},[n("span",{staticClass:"bp-svg-icon error"}),n("p",[t._v("加载失败")]),n("p",[t._v("点击重试")])]):t._e(),8===i&&t.imgList.length>9&&"error"!==e.status&&"loading"!==e.status?n("div",{staticClass:"plus-mask",domProps:{textContent:t._s(t.imgList.length+"P")}}):t._e()])}),0)]):t._e(),"boost"===t.mode?n("div",{staticClass:"boost-wrap"},[n("ul",{staticClass:"boost-control list-none"},[n("li",{staticClass:"bp-v-middle",on:{click:function(e){t.ChangeMode("zoom")&&t.InitStatus()}}},[n("i",{staticClass:"bp-icon-font icon-sq-dynamic bp-v-middle"}),n("span",[t._v("收起")])]),n("li",{staticClass:"bp-v-middle",on:{click:function(e){return t.OpenPhotoImager(t.activeIndex)}}},[n("i",{staticClass:"bp-icon-font icon-ss-dynamic bp-v-middle"}),n("span",[t._v("查看大图")])]),n("li",{staticClass:"bp-v-middle",on:{click:t.TurnToLeft}},[n("i",{staticClass:"bp-icon-font icon-left-r-dynamic bp-v-middle"}),n("span",[t._v("向左旋转")])]),n("li",{staticClass:"bp-v-middle",on:{click:t.TurnToRight}},[n("i",{staticClass:"bp-icon-font icon-right-r-dynamic bp-v-middle"}),n("span",[t._v("向右旋转")])])]),n("div",{staticClass:"boost-img",style:{height:t.ch?t.ch+"px":""},on:{click:function(e){t.ChangeMode("zoom")&&t.InitStatus()}}},[n("transition",{attrs:{name:"boost-fade",mode:"out-in"},on:{"after-leave":t.ChangeContainerHeight}},[n("div",{staticClass:"boost-img-container"},[n("img",{key:t.boostSrc,style:t.rotate,attrs:{src:t.boostSrc,height:t.rotate.ih}}),t._l(t.perTagPercentagePosition,function(e){return 0===t.rotateStatus?n("div",{staticClass:"shop-tag",class:{"not-reverse":!e.reverse},style:e.style,on:{click:function(t){t.stopPropagation()}}},[n("div",{staticClass:"tag-point"}),n("div",{staticClass:"tag-bg"},[n("div",{staticClass:"tag-real"},[n("div",{staticClass:"tag-fake"},[t._v(" ")]),1===e.type&&e.url?n("a",{staticClass:"tag-text",attrs:{href:e.url,target:"_blank",title:e.text},on:{click:function(n){return t.tagReport(e)}}},[n("div",{staticClass:"tag-icon"}),n("div",{staticClass:"tag-text"},[t._v(t._s(e.text))])]):t._e(),2===e.type&&e.mid?n("a",{staticClass:"tag-text",attrs:{href:"//space.bilibili.com/"+e.mid,target:"_blank",title:e.text},on:{click:function(n){return t.tagReport(e)}}},[t._v("@"+t._s(e.text))]):t._e(),3===e.type&&e.text?n("a",{staticClass:"tag-text",attrs:{href:e.jump_url||t.HOST.T+"/topic/name/"+encodeURIComponent(e.text)+"/feed",target:"_blank",title:e.text},on:{click:function(n){return t.tagReport(e)}}},[t._v(t._s("#"+e.text+"#"))]):t._e(),4===e.type?n("div",{staticClass:"tag-text",attrs:{title:e.text}},[n("div",{staticClass:"tag-icon lbs"}),n("div",{staticClass:"tag-text"},[t._v(t._s(e.text))])]):t._e(),0===e.type?n("div",{staticClass:"tag-text",attrs:{title:e.text}},[t._v(t._s(e.text))]):t._e()])])]):t._e()})],2)]),t.bloading?n("div",{staticClass:"b-loading"},[n("loading")],1):t._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:0!==t.activeIndex,expression:"activeIndex !== 0"}],staticClass:"prev",on:{click:function(e){return e.stopPropagation(),t.SwitchBoost(t.activeIndex-1)}}}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.activeIndex!==t.imgList.length-1,expression:"activeIndex !== imgList.length - 1"}],staticClass:"next",on:{click:function(e){return e.stopPropagation(),t.SwitchBoost(t.activeIndex+1)}}})],1),n("div",{staticClass:"boost-slider-wrap"},[1!==t.imgList.length?n("div",{staticClass:"boost-slider-border",style:{left:t.activeIndex%9*58+"px"}}):t._e(),1!==t.imgList.length?n("div",{staticClass:"boost-slider"},[t.pageSize>1&&t.pageNo>1?n("div",{staticClass:"arrow-left",on:{click:function(e){t.SwitchBoost(9*(t.pageNo-1)-1)}}}):t._e(),t.pageSize>1&&t.pageNo!==t.pageSize?n("div",{staticClass:"arrow-right",on:{click:function(e){return t.SwitchBoost(9*t.pageNo)}}}):t._e(),n("ul",{staticClass:"list-none",style:{transform:"translateX(-"+100*(t.pageNo-1)+"%)"}},t._l(t.imgList,function(e,i){return n("li",{key:i+e.status,class:i===t.activeIndex?"active":"",on:{click:function(e){return t.SwitchBoost(i)}}},[n("img",{attrs:{src:e.img_src_zoom}})])}),0)]):t._e()])]):t._e()])},[],!1,null,"2ef3df58",null).exports);o.a.use(E.bpreportPlugin);var et=tt,nt=(n(144),520),it=170,ot=120,rt=203,at=127;function st(t){var e=lt(t);return Object(d.g)(Object(m.a)(e,rt,at,{e:1,c:1}))}function ct(t){return m.h.autoParse(t).replace(/\s+/g,"")}function ut(t){return t<10?"0".concat(t):t}function lt(t){return t.indexOf("@")>-1?t.split("@")[0]:t}var dt={props:{href:{type:String,default:function(){return""},required:!0},link:{type:Function,default:function(){}}}},ft=Object(K.a)(dt,function(){var t=this.$createElement,e=this._self._c||t;return this.href?e("a",{attrs:{target:"_blank",href:this.href},on:{click:this.link}},[this._t("content")],2):e("div",[this._t("content")],2)},[],!1,null,"2b044bfb",null).exports,pt={props:{images:{type:Array,default:function(){return[]}},link:{type:String,default:function(){return""}},title:{type:String,default:function(){return""}},content:{type:String,default:function(){return""}},linkCallback:{type:Function,default:function(t){0}}},data:function(){return{imgList:(t=this.images,n=ot,e=1===t.length?nt:it,t.map(function(t){var i=lt(t);return Object(d.g)(Object(m.a)(i,e,n,{e:1,c:1}))}))};var t,e,n},methods:{linkMethods:function(){this.linkCallback(this.link)}},components:{Hyper:ft}},ht=(n(358),Object(K.a)(pt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"article-container"},[n("hyper",{attrs:{href:t.link,link:t.linkMethods}},[n("div",{attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"images-area"},t._l(t.imgList,function(e,i){return n("img",{class:"card-"+t.imgList.length,attrs:{src:e}})}),0),n("div",{staticClass:"text-area"},[n("div",{staticClass:"title",domProps:{textContent:t._s(t.title)}}),n("div",{staticClass:"content",domProps:{textContent:t._s(t.content)}})])])])],1)},[],!1,null,"3d352df6",null).exports),mt=n(22),gt="//api.bilibili.com/x/v2/history/toview/add",vt="//api.bilibili.com/x/v2/history/toview/del",bt="//api.bilibili.com/x/player/videoshot",yt="//api.bilibili.com/x/v2/dm/ajax";function _t(t){return Object(mt.a)({method:"post",url:vt,data:{jsonp:"jsonp",aid:t}}).catch(function(t){return Promise.resolve(t)})}var wt={data:function(){return{progress:0,loadStatus:!1,pic:"",x:0,y:0,size:0,width:203,data:null}},props:{aid:{required:!0},hit:{required:!0,default:!1},movex:{required:!0,default:0}},computed:{img:function(){return this.pic.replace(/^http:/,"")},show:function(){return this.hit&&this.data}},watch:{hit:function(){this.hit&&!this.loadStatus&&this.ajax()},movex:function(t){this.onMouseMove(t)}},methods:{ajax:function(){var t,e=this;(t=e.aid,Object(mt.a)({method:"get",url:bt,data:{aid:t,index:1}})).then(function(t){e.loadStatus=!0,0===t.code&&t.data&&(e.pic=t.data.image[0],e.data=t.data)}).catch(function(t){e.loadStatus=!0,console.error(t)})},onMouseMove:function(t){if(this.loadStatus&&this.data){var e=this.data.index.length,n=this.data.img_y_size/this.data.img_x_size*this.width;this.progress=Math.floor(t/this.width*100),this.size=this.width*this.data.img_x_len;var i=Math.floor(t/this.width*e);this.x=-i%this.data.img_x_len*this.width,this.y=-Math.floor(i/this.data.img_x_len)*n}}}},Ct=(n(359),Object(K.a)(wt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.show?"cover-preview-module show":"cover-preview-module"},[t.img?n("div",{staticClass:"cover",style:{backgroundImage:"url("+t.img+")",backgroundPosition:t.x+"px "+t.y+"px",backgroundSize:t.size+"px"}}):t._e(),n("div",{staticClass:"progress-bar"},[n("span",{style:{width:t.progress+"%"}})])])},[],!1,null,"5f843606",null).exports),xt={props:{aid:{required:!0},hit:{required:!0,default:!1}},data:function(){return{loadStatus:!1,timer:null,timeout:null,danmus:[],index:0,speed:5,dest:1.5}},watch:{hit:function(t){!t||this.loadStatus?t?this.start():(clearInterval(this.timer),clearTimeout(this.timeout)):this.ajax()}},destroyed:function(){clearInterval(this.timer),clearTimeout(this.timeout)},methods:{noop:function(){},ajax:function(){var t,e=this;(t=e.aid,Object(mt.a)({method:"get",url:yt,data:{aid:t}})).then(function(t){0===t.code&&(e.loadStatus=!0,e.danmus=t.data||[],e.start())}).catch(function(t){e.loadStatus=!0,console.log(t)})},start:function(){var t=this;this.$nextTick(function(){t.timer=setInterval(function(){if(t.index>t.danmus.length-1)clearInterval(t.timer),t.reset();else{var e=(t.$refs["dm"+t.index]||{})[0];if(!e)return;var n=e.offsetWidth;e.style.left=-n+"px",e.style.transition="left "+t.speed+"s linear",t.index++}},1e3*t.dest)})},reset:function(){var t=this;t.timeout=setTimeout(function(){t.index=0;for(var e=0;e<t.danmus.length;e++){var n=(t.$refs["dm"+e]||{})[0];if(!n)return;n.style.left="",n.style.transition=""}t.start(),clearTimeout(t.timeout)},1e3*t.speed-1e3*t.dest)}}},It=(n(360),Object(K.a)(xt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.hit?"danmu-module show":"danmu-module"},t._l(t.danmus,function(e,i){return n("p",{ref:"dm"+i,refInFor:!0,class:i%2==0?"dm":"dm row2",on:{mouseenter:function(e){return e.stopPropagation(),t.noop(e)},mouseleave:function(e){return e.stopPropagation(),t.noop(e)},mousemove:function(e){return e.stopPropagation(),t.noop(e)}}},[t._v(t._s(e))])}),0)},[],!1,null,"6fd25b85",null).exports);function kt(t,e,n,i,o,r,a){try{var s=t[r](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}var St,Ot,Pt={props:{image:{type:String,default:function(){return""}},title:{type:String,default:function(){return""}},content:{type:String,default:function(){return""}},aid:{type:Number,default:function(){return""}},duration:{type:Number,default:function(){return 0}},view:{type:Number,default:function(){return 0}},danmaku:{type:Number,default:function(){return 0}},link:{type:String,default:function(){return""}},linkCallback:{type:Function,default:function(t){0}},seeLaterCallback:{type:Function,default:function(t){0}},preview:{type:null,default:function(){return!1}},fromBiz:{type:Boolean},needPay:{type:Boolean},isCooperation:{type:Boolean}},data:function(){return{imageURL:st(this.image),danmakuNum:ct(this.danmaku),viewNum:ct(this.view),durationTime:(t=this.duration,n=Math.floor(t/3600),i=Math.floor((t-3600*n)/60),o=(t-3600*n)%60,e="".concat(ut(i),":").concat(ut(o)),n>0&&(e="".concat(ut(n),":").concat(e)),e),seeLaterStatus:0,tipsText:"",clickLocker:!1,hit:!1,movex:0,timeout:null};var t,e,n,i,o},computed:{canPreview:function(){return this.preview&&!this.needPay}},methods:{onMouseEnter:function(){if(this.canPreview){var t=this;clearTimeout(t.timeout),t.timeout=setTimeout(function(){t.hit||(t.hit=!0),clearTimeout(t.timeout)},500)}},onMouseLeave:function(){this.canPreview&&(clearTimeout(this.timeout),this.hit=!1,this.movex=0)},onMouseMove:function(t){this.canPreview&&(this.movex=t.layerX||0)},linkMethods:function(){this.linkCallback(this.link)},ChangeTipsText:function(t){this.tipsText=t},SeeLaterHover:function(){0===this.seeLaterStatus?this.tipsText="稍后再看":this.tipsText="移除"},SeeLaterClick:(St=c.a.mark(function t(){var e=this;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.i)();case 2:if(t.sent){t.next=5;break}return t.abrupt("return");case 5:if(!this.clickLocker){t.next=7;break}return t.abrupt("return");case 7:this.clickLocker=!0,this.seeLaterCallback(this.seeLaterStatus),0===this.seeLaterStatus?(n=this.aid,Object(mt.a)({method:"post",url:gt,data:{aid:n,jsonp:"jsonp"}}).catch(function(t){return Promise.resolve(t)})).then(function(t){e.clickLocker=!1,0===t.code?(e.tipsText="已加稍后再看",e.seeLaterStatus=1):e.tipsText=t.msg||"添加失败，请重试"}):1===this.seeLaterStatus&&_t(this.aid).then(function(t){e.clickLocker=!1,0===t.code?(e.tipsText="已从稍后再看列表中移除",e.seeLaterStatus=0):e.tipsText=t.msg||"移除失败，请重试"});case 10:case"end":return t.stop()}var n},t,this)}),Ot=function(){var t=this,e=arguments;return new Promise(function(n,i){var o=St.apply(t,e);function r(t){kt(o,n,i,r,a,"next",t)}function a(t){kt(o,n,i,r,a,"throw",t)}r(void 0)})},function(){return Ot.apply(this,arguments)})},components:{Hyper:ft,CoverPreview:Ct,DanmuPreview:It}},Tt=(n(361),Object(K.a)(Pt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"video-container",class:{"can-hover":!t.fromBiz}},[n("hyper",{attrs:{href:t.link,link:t.linkMethods}},[n("div",{staticClass:"video-wrap",attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"image-area",on:{mouseenter:t.onMouseEnter,mouseleave:t.onMouseLeave,mousemove:t.onMouseMove}},[!t.needPay&&t.isCooperation?n("div",{staticClass:"types",style:t.hit?"opacity: 0":""},[t._v("合作视频")]):t._e(),t.needPay||t.isCooperation?t._e():n("div",{staticClass:"types",style:t.hit?"opacity: 0":""},[t._v("投稿视频")]),t.needPay?n("div",{staticClass:"types need-pay",style:t.hit?"opacity: 0":""},[t._v("付费视频")]):t._e(),t.canPreview?n("cover-preview",{attrs:{aid:t.aid,hit:t.hit,movex:t.movex}}):t._e(),n("img",{attrs:{src:t.imageURL}}),n("div",{staticClass:"mask"},[n("span",{domProps:{textContent:t._s(t.durationTime)}})]),t.canPreview?n("danmu-preview",{attrs:{aid:t.aid,hit:t.hit}}):t._e(),t.fromBiz||t.needPay?t._e():n("div",{staticClass:"see-later",class:1===t.seeLaterStatus?"done":"",on:{mouseover:t.SeeLaterHover,mouseout:function(e){return t.ChangeTipsText("")},click:function(e){return e.preventDefault(),e.stopPropagation(),t.SeeLaterClick(e)}}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.tipsText,expression:"tipsText"}],staticClass:"tips",domProps:{textContent:t._s(t.tipsText)}})])],1),n("div",{staticClass:"text-area"},[n("div",{staticClass:"title",domProps:{textContent:t._s(t.title)}}),n("div",{staticClass:"content",domProps:{textContent:t._s(t.content)}}),n("div",{staticClass:"view-danmaku"},[n("div",[n("i",{staticClass:"bp-icon-font icon-play-a"}),n("span",{staticClass:"view",domProps:{textContent:t._s(t.viewNum)}})]),n("div",[n("i",{staticClass:"bp-icon-font icon-danmu-a"}),n("span",{staticClass:"danmaku",domProps:{textContent:t._s(t.danmakuNum)}})])])])])])],1)},[],!1,null,"3022fc8b",null).exports),Et={props:{link:{type:String,required:!0},coverUrl:{type:String,required:!0},viewNum:{type:String,required:!0},title:{type:String,required:!0},areaName:{type:String,required:!0},status:{type:String,required:!0},showViewNum:{type:Boolean,default:!0},linkCallback:{type:Function,default:function(){}}},data:function(){return{cover:st(this.coverUrl)}},components:{Hyper:ft}},jt=(n(362),Object(K.a)(Et,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"live-container"},[n("hyper",{attrs:{href:t.link,link:t.linkCallback}},[n("div",{staticClass:"live-wrap",attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"status"},[t._v(t._s(t.status))]),n("div",{staticClass:"image-area"},[n("img",{attrs:{src:t.cover}})]),n("div",{staticClass:"text-area"},[n("div",{staticClass:"title fs-16 tc-black"},[t._v(t._s(t.title))]),n("div",{staticClass:"bottom-text tc-slate fs-12"},[n("div",{staticClass:"section d-i-block"},[t._v(t._s(t.areaName))]),t.showViewNum?n("div",{staticClass:"view-num d-i-block"},[t._v(t._s(t.viewNum))]):t._e()])])])])],1)},[],!1,null,"cd55f010",null).exports),Lt={props:{image:{type:String,default:function(){return""}},title:{type:String,default:function(){return""}},content:{type:String,default:function(){return""}},view:{type:Number,default:function(){return 0}},danmaku:{type:Number,default:function(){return 0}},link:{type:String,default:function(){return""}},linkCallback:{type:Function,default:function(t){0}},fromBiz:{type:Boolean},tags:null,hideViewDanmaku:null},data:function(){return{imageURL:st(this.image),danmakuNum:ct(this.danmaku),viewNum:ct(this.view)}},computed:{tagInfo:function(){return!this.tags||this.tags.length<1?{}:this.tags[0]},tagText:function(){return this.tagInfo.name},tagStyle:function(){return"background-color: #".concat(this.tagInfo.color,";")}},methods:{linkMethods:function(){this.linkCallback(this.link)}},components:{Hyper:ft}},At=(n(363),Object(K.a)(Lt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bangumi-container",class:{"can-hover":!t.fromBiz}},[n("hyper",{attrs:{href:t.link,link:t.linkMethods}},[n("div",{attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"image-area"},[n("img",{attrs:{src:t.imageURL}}),t.tagText?n("div",{staticClass:"tag",style:t.tagStyle},[t._v(t._s(t.tagText))]):t._e()]),n("div",{staticClass:"text-area"},[n("div",{staticClass:"title",domProps:{textContent:t._s(t.title)}}),n("div",{staticClass:"content",domProps:{textContent:t._s(t.content)}}),t.hideViewDanmaku?t._e():n("div",{staticClass:"view-danmaku"},[n("div",[n("i",{staticClass:"bp-icon-font icon-play-a"}),n("span",{staticClass:"view",domProps:{textContent:t._s(t.viewNum)}})]),n("div",[n("i",{staticClass:"bp-icon-font icon-danmu-a"}),n("span",{staticClass:"danmaku",domProps:{textContent:t._s(t.danmakuNum)}})])])])])])],1)},[],!1,null,"4f42cff6",null).exports),Dt=(n(50),{props:{image:{type:String,default:""},link:{type:String,default:""},content:{type:String,default:""},desc:{type:String,default:""},tag:{type:Array,default:function(){return[]}},styleType:{type:String}},components:{Hyper:ft},computed:{imgStyle:function(){var t=this.hasImage?this.image:"//s1.hdslb.com/bfs/seed/bplus-common/dynamic-assets/img_loading.png";return"background-image: url(".concat(t,")")},hasImage:function(){return""!==this.image},hasDesc:function(){return""!==this.desc}}}),Mt=(n(364),Object(K.a)(Dt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"h5share-container bg-white pointer t-left",class:{"share-iframe-container":"share-iframe"===t.styleType}},[n("hyper",{attrs:{href:t.link}},[n("div",{attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"image-area f-left"},[n("div",{staticClass:"share-img w-100 h-100",class:{"bg-shrink":!t.hasImage},style:t.imgStyle})]),n("div",{staticClass:"text-area f-left",class:{"share-iframe-text":"share-iframe"===t.styleType}},[n("div",{staticClass:"text-content ff-yahei tc-black ls-0",class:{middle:!t.hasDesc}},[n("div",{staticClass:"text fs-14 line-clamp-1 break-all"},[t._v(t._s(t.content))]),t.tag[0]?n("span",{staticClass:"tag t-center fs-12",style:{background:"#"+t.tag[0].color}},[t._v(t._s(t.tag[0].name))]):t._e()]),t.hasDesc?n("div",{staticClass:"text-desc ff-yahei tc-slate fs-12 ls-0 line-clamp-1"},[t._v(t._s(t.desc))]):t._e()])])])],1)},[],!1,null,"47cded4d",null).exports),Nt={props:{cover:{type:String,default:""},link:{type:String,default:""},title:{type:String,default:""},author:{type:String,default:""},desc:{type:String,default:""},content:{type:String,default:""},tags:null},components:{Hyper:ft},computed:{imgStyle:function(){var t=this.cover||"//s1.hdslb.com/bfs/seed/bplus-common/dynamic-assets/img_loading.png";return"background-image: url(".concat(t,")")},tagInfo:function(){return!this.tags||this.tags.length<1?{}:this.tags[0]},tagText:function(){return this.tagInfo.name},tagStyle:function(){return"background-color: #".concat(this.tagInfo.color,";")}}},Rt=(n(365),Object(K.a)(Nt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"h5share-container bg-white pointer t-left p-rel"},[n("hyper",{attrs:{href:t.link}},[n("div",{attrs:{slot:"content"},slot:"content"},[t.tagText?n("div",{staticClass:"tag",style:t.tagStyle},[t._v(t._s(t.tagText))]):t._e(),n("div",{staticClass:"image-area f-left"},[n("div",{staticClass:"share-img w-100 h-100",style:t.imgStyle})]),n("div",{staticClass:"text-area f-left"},[n("div",{staticClass:"text-content ff-yahei fs-14 ls-0 line-clamp-1"},[t._v(t._s(t.title))]),n("div",{staticClass:"text-desc ff-yahei fs-12 ls-0 line-clamp-1"},[t._v(t._s(t.desc))]),n("div",{staticClass:"text-desc ff-yahei fs-12 ls-0 line-clamp-1"},[t._v(t._s(t.content))])])])])],1)},[],!1,null,"1509e9aa",null).exports),Bt={props:{image:{type:String,default:""},link:{type:String,default:""},content:{type:String,default:""},desc:{type:String,default:""},styleType:{type:String},linkCallback:{type:Function,default:function(){}}},components:{Hyper:ft},computed:{imgStyle:function(){var t=this.hasImage?this.image:"//s1.hdslb.com/bfs/seed/bplus-common/dynamic-assets/img_loading.png";return"background-image: url(".concat(t,")")},hasImage:function(){return""!==this.image},hasDesc:function(){return""!==this.desc}}},Ut=(n(367),Object(K.a)(Bt,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"music-container bg-white pointer t-left",class:{"share-iframe-container":"share-iframe"===t.styleType}},[i("hyper",{attrs:{href:t.link,link:t.linkCallback}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("div",{staticClass:"image-area f-left p-rel"},[i("div",{staticClass:"share-img w-100 h-100",class:{"bg-shrink":!t.hasImage},style:t.imgStyle}),i("img",{staticClass:"music-play-icon p-abs",attrs:{src:n(366)}})]),i("div",{staticClass:"text-area f-left",class:{"share-iframe-text":"share-iframe"===t.styleType}},[i("div",{staticClass:"text-content ff-yahei tc-black fs-14 ls-0 line-clamp-1",class:{middle:!t.hasDesc}},[t._v(t._s(t.content))]),t.hasDesc?i("div",{staticClass:"text-desc ff-yahei tc-slate fs-12 ls-0"},[t._v(t._s(t.desc))]):t._e()])])])],1)},[],!1,null,"7d9db8c7",null).exports),Ht={props:{image:{type:String,default:""},link:{type:String,default:""},content:{type:String,default:""},desc:{type:String,default:""}},components:{Hyper:ft},computed:{imgStyle:function(){return this.hasImage?"background-image: url(".concat(this.image,")"):"background: #DFF7FF url(".concat(n(368),") center/28px no-repeat;")},hasImage:function(){return""!==this.image},hasDesc:function(){return""!==this.desc}},methods:{onClick:function(){this.$emit("click")}}},$t=(n(369),Object(K.a)(Ht,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vote-container bg-white pointer t-left",on:{click:t.onClick}},[n("hyper",{attrs:{href:t.link}},[n("div",{attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"image-area f-left"},[n("div",{staticClass:"share-img w-100 h-100",class:{"bg-shrink":!t.hasImage},style:t.imgStyle})]),n("div",{staticClass:"text-area f-left"},[n("div",{staticClass:"text-content ff-yahei tc-black fs-14 ls-0 line-clamp-1",class:{middle:!t.hasDesc}},[t._v(t._s(t.content))]),t.hasDesc?n("div",{staticClass:"text-desc ff-yahei tc-slate fs-12 ls-0 line-clamp-1"},[t._v(t._s(t.desc))]):t._e(),n("div",{staticClass:"vote-btn-box"},[n("div",{staticClass:"vote-btn"},[t._v("投票")])])])])])],1)},[],!1,null,"9b0fce88",null).exports),Ft=n(298),Vt=n.n(Ft),zt={props:["cover","coverType","title","description","contentCount","link","linkCallback"],data:function(){return{}},computed:{coverBfsUrl:function(){var t="";return this.cover&&(t=Object(m.a)(this.cover.replace(/^http:|^https:/,""),null,127)),t},coverBoxStyle:function(){return this.coverBfsUrl?12!==this.coverType?"background-image: url(".concat(this.coverBfsUrl,")"):"background-image: url(".concat(this.coverBfsUrl,"); filter: blur(12px)"):"background-image: url(".concat(Vt.a,"); background-size: 34px 33px;")},coverImageStyle:function(){var t="";return 12===this.coverType&&(t="width: 127px; height: 127px; background-image: url(".concat(this.coverBfsUrl,")")),t},contentCountString:function(){return"".concat(this.contentCount,"个内容")}},watch:{},components:{Hyper:ft},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{linkMethods:function(){"function"==typeof this.linkCallback&&this.linkCallback(this.link)}}},Gt=(n(370),Object(K.a)(zt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"media-list"},[n("Hyper",{attrs:{href:t.link,link:t.linkMethods}},[n("div",{staticClass:"content",attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"cover-box-cliper"},[n("div",{staticClass:"cover-box",style:t.coverBoxStyle}),t.coverImageStyle?n("div",{staticClass:"cover-image",style:t.coverImageStyle}):t._e(),n("div",{staticClass:"media-list-icon"})]),n("div",{staticClass:"text-box"},[n("div",{staticClass:"title"},[t._v(t._s(t.title))]),n("div",{staticClass:"description"},[t._v(t._s(t.description))]),n("div",{staticClass:"count-box"},[t._v(t._s(t.contentCountString))])])])])],1)},[],!1,null,"bf1c912a",null).exports),Jt={props:{isUpdate:{type:null,default:function(){return!1}},image:{type:String,default:function(){return""}},title:{type:String,default:function(){return""}},subtitle:{type:String,default:function(){return""}},content:{type:String,default:function(){return""}},link:{type:String,default:function(){return""}},linkCallback:{type:Function,default:function(t){0}}},data:function(){return{imageURL:st(this.image)}},computed:{},methods:{linkMethods:function(){this.linkCallback(this.link)}},components:{Hyper:ft}},Wt=(n(371),Object(K.a)(Jt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"video-container",class:{"can-hover":t.link}},[n("hyper",{attrs:{href:t.link,link:t.linkMethods}},[n("div",{staticClass:"video-wrap",attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"image-area"},[n("div",{staticClass:"types"},[t._v("付费课程")]),n("img",{attrs:{src:t.imageURL}})]),n("div",{staticClass:"text-area"},[n("div",{staticClass:"title",domProps:{textContent:t._s(t.title)}}),n("div",{staticClass:"content",class:{"is-update":t.isUpdate},domProps:{textContent:t._s(t.content)}}),t.subtitle?n("div",{staticClass:"subtitle",class:{"is-update":t.isUpdate},domProps:{textContent:t._s(t.subtitle)}}):t._e()])])])],1)},[],!1,null,"54d7ed54",null).exports),Kt={props:{text:{type:String,default:""},clipText:{type:String,default:""},pureText:{type:String,default:""},type:{type:Number,default:1},isDetail:null,maxLines:{type:Number,default:4},lineHeight:{type:Number,default:22},clickLogHandler:{type:Function,default:function(){}},url:{type:String,default:function(){return""}}},data:function(){return{isMounted:!1,needClip:!1,isExpanded:!0,shouldShowContent:"undefined"==typeof window}},computed:{needShowMoreLines:function(){return this.type===y.a.REPOST||this.type===y.a.PIC||this.type===y.a.WORD},pureTextLength:function(){return Object(f.i)(this.pureText)}},watch:{text:function(){this.nextTickAttachAtHrefs()}},mounted:function(){var t=this;this.isMounted=!0,setTimeout(function(){t.calcClip()},0),this.nextTickAttachAtHrefs()},methods:{nextTickAttachAtHrefs:function(){var t=this;I.getIsNeedCardPopup()&&this.$nextTick(function(){t.attachAtHrefs(t.$refs.full)})},attachAtHrefs:function(t){if(t)for(var e=t.children,n=0;n<e.length;n++){var i=e[n];if("A"===i.nodeName){var o=i.href.match(/\/\/space\.bilibili\.com\/(\d+)/);if(o){var r=+o[1];r&&Object(p.a)(r,this.$refs.foldingText,i)}}}},mouseenter:function(t){this.$emit("mouseenter",t)},mouseleave:function(t){this.$emit("mouseleave",t)},click:function(t){var e=t.srcElement||t.originalTarget||t.target;t.target&&"A"===t.target.nodeName||e.getAttribute("click-href")?this.clickLogHandler():(this.url&&window.open(this.url),this.$emit("click",t))},calcClip:function(){if(this.shouldShowContent=!0,!this.isDetail&&this.$refs.full){var t=this.pureText.match(/[\n↵]/g);(this.pureTextLength>160||t&&t.length>5)&&(this.needClip=!0,this.isExpanded=!1,this.nextTickAttachAtHrefs())}},triggerExpand:function(){this.isExpanded=!this.isExpanded},stopPropagation:function(t){t.preventDefault(),t.stopPropagation()}}},Yt=(n(372),Object(K.a)(Kt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"foldingText",staticClass:"text p-rel"},[n("div",{staticClass:"content",class:{"visibility-hidden":!t.shouldShowContent},on:{mouseenter:t.mouseenter,mouseleave:t.mouseleave,click:t.click}},[t.isMounted&&t.needClip?n("div",{ref:"clip",staticClass:"content-ellipsis",class:{hidden:t.isExpanded},domProps:{innerHTML:t._s(t.clipText)}}):t._e(),n("div",{ref:"full",staticClass:"content-full",class:{hidden:!t.isExpanded},domProps:{innerHTML:t._s(t.text)}})]),t.needClip?n("div",{staticClass:"btns"},[n("div",{staticClass:"expand-btn",on:{click:function(e){return e.stopPropagation(),t.triggerExpand(e)}}},[t._v(t._s(t.isExpanded?"收起":"展开"))])]):t._e()])},[],!1,null,"77d7458b",null).exports),qt={props:["show","url","title"],data:function(){return{iframeShow:!1}},computed:{},watch:{show:function(){this.updateShowStatus()}},components:{},beforeCreate:function(){},created:function(){this.updateShowStatus()},beforeMount:function(){},mounted:function(){this.updateShowStatus()},beforeDestroy:function(){},destroyed:function(){},methods:{onClose:function(){this.$emit("close")},updateShowStatus:function(){var t=this;this.show?this.iframeShow=!0:setTimeout(function(){t.iframeShow=!1},500)}}},Qt=(n(373),Object(K.a)(qt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"backdrop",on:{click:t.onClose}},[n("transition",{attrs:{name:"slide"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"extension-wrapper",on:{click:function(t){t.stopPropagation()}}},[n("div",{staticClass:"title-box"},[n("div",{staticClass:"title-text"},[t._v(t._s(t.title))]),n("div",{staticClass:"close-button bp-icon-font icon-group-dynamic close-btn",on:{click:t.onClose}})]),t.iframeShow?n("iframe",{attrs:{src:t.url,frameborder:"0"}}):t._e()])])],1)])},[],!1,null,"21fef14f",null).exports),Xt={props:["content"],data:function(){return{}},computed:{},watch:{},components:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{}},Zt=(n(374),Object(K.a)(Xt,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"risk-tip"},[e("span",{staticClass:"tip-icon"}),e("span",{staticClass:"risk-tip-content"},[this._v("\n    "+this._s(this.content)+"\n  ")])])},[],!1,null,"3773de5c",null).exports),te={props:["itemInfo","cardInfo"],data:function(){return{}},computed:{bgStyle:function(){var t=this.toBfsImg(this.itemInfo.img);return"background-image: url(".concat(t,");")},jumpLink:function(){return this.itemInfo.jumpLink},hoverContent:function(){return"".concat(this.subTitle?"".concat(this.title,"\n"):this.title).concat(this.priceDesc?"".concat(this.subTitle,"\n"):this.subTitle).concat(this.priceDesc)},title:function(){return this.itemInfo.name||""},subTitle:function(){return this.itemInfo.brief||""},priceDesc:function(){return this.itemInfo.priceStr||""},shopCardId:function(){return this.itemInfo.itemsId}},watch:{},components:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{toBfsImg:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return Object(d.g)(Object(m.a)(t,e,n,{e:1,c:1}))},reportItemClick:function(){var t={item_id:this.shopCardId},e=S(this.cardInfo);Object(h.d)(y.d.SHOP_CARD_CLICK,Object.assign(e,t))}}},ee=(n(375),Object(K.a)(te,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"shop-item",style:this.bgStyle},[e("a",{staticClass:"shop-link",attrs:{href:this.jumpLink,target:"_blank",title:this.hoverContent},on:{click:this.reportItemClick}})])},[],!1,null,"b05d3040",null).exports),ne={props:["item-info","cardInfo"],data:function(){return{}},computed:{title:function(){return this.itemInfo.name||""},subTitle:function(){return this.itemInfo.brief||""},priceDesc:function(){return this.itemInfo.priceStr||""},btnText:function(){return this.itemInfo.jumpLinkDesc||"去看看"},jumpLink:function(){return this.itemInfo.jumpLink},shopCardId:function(){return this.itemInfo.itemsId}},watch:{},components:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{reportItemClick:function(){var t={item_id:this.shopCardId},e=S(this.cardInfo);Object(h.d)(y.d.SHOP_CARD_CLICK,Object.assign(e,t))}}},ie=(n(376),{props:["shopCardList","isRepost","cardInfo"],data:function(){return{}},computed:{cardCount:function(){return this.shopCardList.length},panelDesc:function(){return this.shopCardList[0].adMark||""},shopCardIds:function(){return this.shopCardList.map(function(t){return t.itemsId})}},watch:{},components:{ShopItem:ee,ShopDesc:Object(K.a)(ne,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a",{staticClass:"shop-desc",attrs:{href:t.jumpLink,target:"_blank"},on:{click:t.reportItemClick}},[n("div",{staticClass:"desc-box"},[n("div",{staticClass:"title"},[t._v(t._s(t.title))]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.subTitle,expression:"subTitle"}],staticClass:"sub-title"},[t._v(t._s(t.subTitle))]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.priceDesc,expression:"priceDesc"}],staticClass:"price-desc"},[t._v(t._s(t.priceDesc))])]),t.btnText?n("div",{staticClass:"btn-box"},[n("button",{staticClass:"jump-btn"},[t._v(t._s(t.btnText))])]):t._e()])},[],!1,null,"26ee0f48",null).exports},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){this.reportItemShow()},beforeDestroy:function(){},destroyed:function(){},methods:{reportItemShow:function(){var t={item_id:this.shopCardIds.join(",")},e=S(this.cardInfo);Object(h.d)(y.d.SHOP_CARD_SHOW,Object.assign(e,t))}}}),oe=(n(377),Object(K.a)(ie,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"shop-panel"},[n("div",{staticClass:"panel-desc"},[n("i",{staticClass:"shop-icon"}),n("span",[t._v(t._s(t.panelDesc))])]),n("div",{staticClass:"shop-list",class:{"is-repost":t.isRepost}},[t._l(t.shopCardList,function(e){return n("shop-item",{key:e.itemsId,attrs:{"card-info":t.cardInfo,"item-info":e}})}),1===t.cardCount?n("shop-desc",{attrs:{"card-info":t.cardInfo,"item-info":t.shopCardList[0]}}):t._e()],2)])},[],!1,null,"6ce6f18b",null).exports),re={props:["uid","dynamicId","likeInfo"],data:function(){return{}},computed:{likeUsersList:function(){return this.likeInfo&&this.likeInfo.like_users||[]},displayText:function(){return this.likeInfo&&this.likeInfo.like_display_text||"赞了"}},watch:{},components:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{}},ae=(n(378),Object(K.a)(re,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.likeUsersList.length,expression:"likeUsersList.length"}],staticClass:"like-users-panel"},[n("i",{staticClass:"like-icon"}),n("div",{staticClass:"users-box"},[t._l(t.likeUsersList,function(e,i){return[n("a",{key:e.uid,staticClass:"like-users-list",attrs:{href:"//space.bilibili.com/"+e.uid,title:e.uname,target:"_blank"}},[t._v(t._s(e.uname))]),i+1!==t.likeUsersList.length?[t._v("、")]:t._e()]})],2),n("span",{staticClass:"suffix-text"},[t._v("赞了")])])},[],!1,null,"9f189eb0",null).exports),se=(n(47),{playingVideo:null,autoplayWaitingStack:[]}),ce=function(t){if(se.autoplayWaitingStack.some(function(e){return e.videoId===t.videoId})||se.autoplayWaitingStack.push({videoId:t.videoId,player:t.player}),se.autoplayWaitingStack.length>0){var e=se.autoplayWaitingStack.pop();null!==se.playingVideo&&se.playingVideo.videoId===e.videoId||e.player.play()}},ue=function(t){se.autoplayWaitingStack=se.autoplayWaitingStack.filter(function(e){return e.videoId!==t})},le=function(t){null!==se.playingVideo&&se.playingVideo.player.pause(),se.playingVideo=t,se.autoplayWaitingStack.filter(function(e){return e.videoId!==t.videoId})},de=function(){if(se.playingVideo=null,se.autoplayWaitingStack.length>0){var t=se.autoplayWaitingStack.pop();null!==se.playingVideo&&se.playingVideo.videoId===t.videoId||t.player.play()}},fe=function(){return se.playingVideo};function pe(t,e,n,i,o,r,a){try{var s=t[r](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}function he(t){return function(){var e=this,n=arguments;return new Promise(function(i,o){var r=t.apply(e,n);function a(t){pe(r,i,o,a,s,"next",t)}function s(t){pe(r,i,o,a,s,"throw",t)}a(void 0)})}}var me,ge={props:{cardInfo:{type:Object,required:!0},cardData:{type:Object,required:!0},isFake:{type:Boolean,default:!1},isDetail:{type:Boolean,default:!1},currentType:{type:Number,default:0},myUid:null,popupDom:null,isGuest:null,spmPageTypeString:String},data:function(){return{card:Object(d.e)(this.cardInfo.card),originalCardInfo:{uid:0,name:"",face:"",url:"",type_desc:"",contentArray:""},originalCardInfoContent:"",clipOriginalCardInfoContent:"",repostContent:"",clipRepostContent:"",containerDOM:null,vcPlayer:null,inViewport:!1,vcError:!1,vcPlayed:!1,repostDescHovered:!1,originDescHovered:!1,hasFullScreen:!1,attentionList:f.t.getMyAttentionList(),TYPES:y.a,HOST:O.a,iframeInstance:null,iframeDom:null,justFocus:!1}},computed:{errorTips:function(){return this.card.item.tips},needRefresh:function(){var t=this.cardInfo.need_refresh;return!(!t||1!==t)},isRepost:function(){return this.cardInfo.desc.type===y.a.REPOST},isShareTag:function(){return 0===this.cardInfo.desc.r_type},isBangumiLike:function(){return-1!==[y.a.FILM,y.a.TV,y.a.DOCUMENTARY,y.a.BANGUMI].indexOf(this.originType)},showOriginUserFocusButton:function(){return!this.isBangumiLike},cardOrigin:function(){return this.isRepost?Object(d.e)(this.card.origin):this.card},originType:function(){return this.isRepost?this.cardInfo.desc.orig_type:this.cardInfo.desc.type},isSupportBizType:function(){return this.cardOrigin.sketch&&-1===[].indexOf(this.cardOrigin.sketch.biz_type)},isSupportCardType:function(){return this.originType===y.a.H5_SHARE||this.originType===y.a.COMIC_SHARE?this.isSupportBizType:-1!==Object.values(y.a).indexOf(this.originType)&&this.originalCardInfo&&(this.originalCardInfoContent||this.originalCardInfo.face||this.originalCardInfo.name||this.originalCardInfo.uid||this.originalCardInfo.url)},userName:function(){return this.cardInfo.desc.user_profile.info.uname},dynamicDetailUrl:function(){return this.isDetail?"":"".concat(O.a.T,"/").concat(this.cardInfo.desc.dynamic_id,"?tab=2")},originDynamicDetailUrl:function(){return!this.isDetail||this.isRepost||this.originType!==this.TYPES.NONE&&this.originType!==this.TYPES.WORD&&this.originType!==this.TYPES.PIC&&this.originType!==this.TYPES.H5_SHARE&&this.isSupportCardType?this.originalCardInfo.url:""},avatarStyle:function(){return{"background-image":"url(".concat(Object(m.a)(Object(d.g)(this.originalCardInfo.face),24,24),")")}},isFocus:function(){return this.attentionList.indexOf(this.originalCardInfo.uid)>-1||this.justFocus},repostRiskContent:function(){return this.cardData.riskTip&&this.cardData.riskTip.content},originRiskContent:function(){return this.originalCardInfo.riskTip&&this.originalCardInfo.riskTip.content},isSelf:function(){return this.originalCardInfo.uid===this.myUid},hasShopCard:function(){return this.shopCardList.length>0},shopCardList:function(){return this.originalCardInfo.shopCards||[]},likeInfo:function(){return this.cardInfo.display&&this.cardInfo.display.like_info||{}},likeUsersPanelShow:function(){return this.likeInfo.like_users&&this.likeInfo.like_users.length>0}},components:{ImagesBox:et,CardArticle:ht,CardVideo:Tt,CardLive:jt,CardBangumi:At,CardH5Share:Mt,CardComicShare:Rt,CardMusic:Ut,CardVote:$t,CardMediaList:Gt,FoldingText:Yt,RiskTip:Zt,CardCheese:Wt,ShopPanel:oe,LikeUsersPanel:ae},created:function(){var t=this;this.getRepostContent(),this.originalCardInfo=T(this.cardInfo,this.isFake),"server"===Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_ENV?this.originalCardInfoContent=Object(f.m)(this.originalCardInfo.contentArray,this.originalCardInfo.renderOpts):(Object(f.n)(this.originalCardInfo.contentArray,this.originalCardInfo.renderOpts).then(function(e){t.originalCardInfoContent=e}),Object(f.n)(this.originalCardInfo.clipContentArray,this.originalCardInfo.renderOpts).then(function(e){t.clipOriginalCardInfoContent=e}))},beforeDestroy:function(){b(window,"message",this.iframeChangeMessageHandler)},mounted:function(){this.containerDOM=this.findAncestor("card")||this.$el,this.originType===y.a.CLIP&&this.initVcPlayer(),I.getIsNeedCardPopup()&&(this.$refs.username&&Object(p.a)(this.originalCardInfo.uid,this.$refs.cardcontent,this.$refs.username),this.$refs.userhead&&Object(p.a)(this.originalCardInfo.uid,this.$refs.cardcontent,this.$refs.userhead)),f.b.$on(y.b.IFRAME_WRAPPER_CLICK,this.onWrapperClick),v(window,"message",this.iframeChangeMessageHandler,!1)},filters:{formatMinutes:function(t){var e=t%60;return e<10&&(e="0"+e),Math.floor(t/60).toString()+":"+e.toString()}},methods:{extendImageLogHandler:function(){Object(h.d)(y.d.CARD_BPM,Object.assign({like_show_area:this.likeUsersPanelShow?1:0},k(this.cardInfo)))},seeLaterLogHandler:function(t){t?Object(h.d)(y.d.CARD_WATCH_LATER_CANCEL,k(this.cardInfo)):Object(h.d)(y.d.CARD_WATCH_LATER,k(this.cardInfo))},originImageLogHandler:function(){Object(h.d)(y.d.CARD_ORIGINAL_PIC,k(this.cardInfo))},getRepostContent:function(){var t=this;if(this.card.item){var e=Object(f.q)(this.card.item.content,{ctrlJson:this.card.item.ctrl,extendCtrlJson:this.cardInfo.extend_json,dynamicId:this.cardInfo.desc.dynamic_id}),n=this.card.item.content;n=Object(f.i)(n)>160?Object(f.c)(n,160):Object(f.d)(n,6);var i=Object(f.q)(n,{ctrlJson:this.card.item.ctrl,extendCtrlJson:this.cardInfo.extend_json});"server"===Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_ENV?this.repostContent=Object(f.m)(e,{ctrlJson:this.card.item.ctrl,extendCtrlJson:this.cardInfo.extend_json,dynamicId:this.cardInfo.desc.dynamic_id,display:this.cardInfo.display}):(Object(f.n)(e,{ctrlJson:this.card.item.ctrl,extendCtrlJson:this.cardInfo.extend_json,dynamicId:this.cardInfo.desc.dynamic_id,display:this.cardInfo.display}).then(function(e){t.repostContent=e}),Object(f.n)(i,{ctrlJson:this.card.item.ctrl,extendCtrlJson:this.cardInfo.extend_json,dynamicId:this.cardInfo.desc.dynamic_id,display:this.cardInfo.display}).then(function(e){t.clipRepostContent=e}))}},findAncestor:function(t){for(var e=this.$el;e&&e.classList&&!e.classList.contains(t);)e=e.parentElement;return e},iframeChangeMessageHandler:function(t){var e=t.data;if(/^bp-dynamic-iframe-update:/.test(e)){var n=JSON.parse(e.replace(/^bp-dynamic-iframe-update:/,""));this.extensionIframeTitle=n.title}},initVcPlayer:function(){var t=this;if(this.$refs.vcCtnr)if(window.LinkPlayer)this.afterInitVcPlayer();else{l()("//s1.hdslb.com/bfs/static/player/live/link/player-1.4.5.min.js").then(function(){t.afterInitVcPlayer()})}},afterInitVcPlayer:function(){var t=this,e=window.LinkPlayer;this.vcPlayer=new e(this.$refs.vcCtnr,{videoId:this.cardOrigin.item.id,playurl:Object(d.g)(this.cardOrigin.item.video_playurl)+"&rand="+Math.floor(1e7*Math.random()),backupUrl:this.cardOrigin.item.backup_playurl||[],initTime:this.cardOrigin.item.video_time,endingType:1,danmakuSize:.7,autoPlay:!1,onInitialized:function(){},beforePlaying:function(){Object(h.d)(y.d.CARD_VC_PLAY,k(t.cardInfo)),le({videoId:t.cardOrigin.item.id,player:t.vcPlayer}),t.vcPlayed=!0},onPaused:function(){de()},onEnded:function(){de()},onError:function(){t.vcError=!0}}),this.vcPlayer.volume&&this.vcPlayer.volume(0),this.registerVcEvents()},playVc:function(){this.vcPlayer&&this.vcPlayer.play&&this.vcPlayer.play()},registerVcEvents:function(){var t=this;f.b.$on(y.b.SCROLL,function(){t.handleScroll()}),this.handleScroll()},isInViewport:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.$refs.vcCtnr;if(!e)return!1;var n=e.getBoundingClientRect().top,i=e.offsetHeight,o=window.innerHeight;return n+i+t<=o&&n-t>0},handleScroll:function(){var t=this;if("SafariMobile"!==Object(d.d)())if(this.isInViewport()&&!this.inViewport)this.inViewport=!0,setTimeout(function(){t.inViewport&&ce({videoId:t.cardOrigin.item.id,player:t.vcPlayer})},800);else if(!this.isInViewport()&&this.inViewport){var e=fe();this.inViewport=!1,null!==e&&e.videoId===this.cardOrigin.item.id&&setTimeout(function(){t.isFullscreen()||t.vcPlayer.pause()},100),ue(this.cardOrigin.item.id)}},isFullscreen:function(){return!!(document.fullscreen||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement)},originDescMouseEnter:function(){this.originalCardInfo.url&&this.originDynamicDetailUrl&&(this.originDescHovered=!0)},originDescMouseLeave:function(){this.originDescHovered=!1},repostDescMouseEnter:function(){this.dynamicDetailUrl&&this.dynamicDetailUrl&&(this.repostDescHovered=!0)},repostDescMouseLeave:function(){this.repostDescHovered=!1},detailLogHandler:function(){this.dynamicDetailUrl&&Object(h.d)(y.d.CARD_CLICK,Object.assign({like_show_area:this.likeUsersPanelShow?1:0,card_type:Object(h.a)(y.a.REPOST).card_type,card_id:this.cardInfo.desc.dynamic_id,tag_type:I.getCurrentType()},this.isGuest?{nologin:1}:{}))},focusHandler:(me=he(c.a.mark(function t(){var e=this;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.i)(function(){Object(h.d)(y.d.LOGIN_SUCCESS,{from:e.spmPageTypeString})});case 2:if(t.sent){t.next=5;break}return t.abrupt("return");case 5:if(!this.isFocus){t.next=8;break}return this.bpPopup({title:"取消关注",content:"真的要取消对 ".concat(this.originalCardInfo.name," 的关注吗？"),button:{confirm:"取消关注",cancel:"点错了~"}}).onConfirm(function(t){var n;e.bpapi({method:"post",url:"".concat(O.a.API_VC,"/feed/v1/feed/SetUserFollow"),data:{type:0,follow:e.originalCardInfo.uid}}).then(function(){e.justFocus=!1,f.t.deleteFromMyAttentionList(e.originalCardInfo.uid),e.linkMsg(t.confirmBtn,"取消了对 ".concat(e.originalCardInfo.name," 的关注"),"success"),t.close()},(n=he(c.a.mark(function n(i){return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e.linkMsg(e.$refs.follow,i.msg,i.type),t.close();case 2:case"end":return n.stop()}},n)})),function(t){return n.apply(this,arguments)}))}).onCancel(function(t){t.close()}),t.abrupt("return");case 8:this.bpapi({method:"post",url:"".concat(O.a.API_VC,"/feed/v1/feed/SetUserFollow"),data:{type:1,follow:this.originalCardInfo.uid}}).then(function(){e.justFocus=!0,f.t.insertToMyAttentionList(e.originalCardInfo.uid),e.linkMsg(e.$refs.follow,"关注成功","success")},function(){var t=he(c.a.mark(function t(n){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.linkMsg(e.$refs.follow,n.msg,n.type);case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 9:case"end":return t.stop()}},t,this)})),function(){return me.apply(this,arguments)}),repostLogHandler:function(){Object(h.d)(y.d.CARD_ATCLICK,k(this.cardInfo))},originNameLogHandler:function(){Object(h.d)(y.d.CARD_SHARE_NICKNAME,this.originalCardInfo.name)},originCardLogHandler:function(){this.originalCardInfo.url&&(Object(h.d)(y.d.CARD_CLICK,Object.assign({like_show_area:this.likeUsersPanelShow?1:0},k(this.cardInfo),this.isGuest?{nologin:1}:{})),this.currentType===y.a.HOT&&this.bpapi({method:"post",url:"".concat(O.a.API_VC,"/dynamic_report/v1/dynamic_report/rcmd_report"),data:{report_type:6,uid:f.t.getUid(),dynamic_id:this.cardInfo.desc.dynamic_id}}))},onWrapperClick:function(t,e){if(!e||e===this.cardInfo.desc.dynamic_id){var n=t.srcElement||t.originalTarget||t.target,i=n.getAttribute("click-href"),o=n.getAttribute("click-title"),r=n.getAttribute("shop-item-id");if(r){var a=k(this.cardInfo,{item_id:r});Object(h.d)(y.d.ITEM_CLICK,a),t.stopPropagation()}else i&&o&&(t.preventDefault(),t.stopPropagation(),this.showIframe(i,o))}},onVoteCardClick:function(){this.showIframe(this.originalCardInfo.voteInfo.url,"投票")},initIframe:function(){var t=new o.a({template:'<extension-iframe :show="extensionIframeShown" :url="extensionIframeUrl" :title="extensionIframeTitle" @close="closeIframe"></extension-iframe>',components:{ExtensionIframe:Qt},data:function(){return{extensionIframeUrl:"",extensionIframeShown:!1,extensionIframeTitle:""}},methods:{closeIframe:this.closeIframe}});this.iframeInstance=t},showIframe:function(t,e){this.initIframe();var n=this.popupDom||this.$refs.iframeDom,i=document.createElement("div");n.appendChild(i),this.iframeInstance.extensionIframeShown=!0,this.iframeInstance.extensionIframeUrl=t,this.iframeInstance.extensionIframeTitle=e,this.iframeDom=this.iframeInstance.$mount(i).$el,Object(h.d)(this.originalCardInfo.hasLottery?y.d.LOTTERY_RETWEET:this.originalCardInfo.voteInfo?y.d.POLLCLICK:void 0,k(this.cardInfo))},closeIframe:function(){var t=this;this.iframeInstance&&(this.iframeInstance.extensionIframeShown=!1,setTimeout(function(){t.iframeDom.parentNode.removeChild(t.iframeDom),t.iframeInstance.$destroy(),t.iframeInstance=null},200))},gotoDetail:function(){var t=this.dynamicDetailUrl;this.needRefresh&&(this.isDetail?location.reload(!0):window.open(t))}}},ve=(n(379),Object(K.a)(ge,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"cardcontent",staticClass:"card-content",on:{click:t.onWrapperClick}},[t.isRepost&&t.repostRiskContent?i("risk-tip",{attrs:{content:t.repostRiskContent}}):t._e(),i("folding-text",{directives:[{name:"show",rawName:"v-show",value:t.isRepost&&t.repostContent,expression:"isRepost && repostContent"}],staticClass:"description",class:{active:t.repostDescHovered},attrs:{text:t.repostContent,"clip-text":t.clipRepostContent,"pure-text":t.repostContent?t.card.item.content:"",type:t.TYPES.REPOST,"is-detail":t.isDetail,"click-log-handler":t.repostLogHandler,url:t.dynamicDetailUrl},on:{mouseenter:t.repostDescMouseEnter,mouseleave:t.repostDescMouseLeave,click:t.detailLogHandler}}),i("div",{staticClass:"post-content",class:{repost:t.isRepost},attrs:{"data-ori-did":t.cardInfo.desc.orig_dy_id}},[t.originType===t.TYPES.NONE?i("div",{staticClass:"deleted"},[i("p",{staticClass:"tc-slate p-rel"},[i("i",{staticClass:"bp-icon-font icon-gantan-01 deleted-icon"}),i("span",{staticClass:"deleted-text",on:{click:t.gotoDetail}},[t._v(t._s(t.errorTips))])])]):t.isSupportCardType?i("div",{staticClass:"original-card-content"},[t.isRepost&&!t.showOriginUserFocusButton?i("div",{staticClass:"original-poster"},[t.isBangumiLike?i("a",{staticClass:"username d-i-block",attrs:{href:t.originalCardInfo.title_url,target:"_blank"},on:{click:t.originNameLogHandler}},[t._v(t._s(t.originalCardInfo.name))]):i("a",{ref:"username",staticClass:"username d-i-block",attrs:{href:t.HOST.SPACE+"/"+t.originalCardInfo.uid+"/dynamic",target:"_blank"},on:{click:t.originNameLogHandler}},[t._v("@"+t._s(t.originalCardInfo.name)+":")])]):t._e(),t.isRepost&&t.showOriginUserFocusButton?i("div",{staticClass:"up-info"},[i("a",{ref:"userhead",staticClass:"up-info-avatar",style:t.avatarStyle,attrs:{href:t.HOST.SPACE+"/"+t.originalCardInfo.uid+"/dynamic",target:"_blank"},on:{click:t.originNameLogHandler}}),i("a",{ref:"username",staticClass:"username d-i-block up-info-name",attrs:{href:t.HOST.SPACE+"/"+t.originalCardInfo.uid+"/dynamic",target:"_blank"},on:{click:t.originNameLogHandler}},[t._v(t._s(t.originalCardInfo.name))]),i("div",{staticClass:"up-info-tip"},[t._v(t._s(t.originalCardInfo.type_desc))]),t.isSelf||!t.justFocus&&t.isFocus?t._e():i("button",{ref:"follow",staticClass:"up-focus-btn",class:{"is-focus":t.isFocus},on:{click:t.focusHandler}},[t._v(t._s(t.isFocus?"已关注":"关注"))])]):t._e(),t.originRiskContent?i("risk-tip",{attrs:{content:t.originRiskContent}}):t._e(),i("folding-text",{directives:[{name:"show",rawName:"v-show",value:!!t.originalCardInfoContent&&t.originalCardInfoContent,expression:"!!originalCardInfoContent && originalCardInfoContent"}],staticClass:"description",class:{active:t.originDescHovered},attrs:{text:t.originalCardInfoContent,"clip-text":t.clipOriginalCardInfoContent,"pure-text":t.originalCardInfo.pureText,type:t.originType,"is-detail":t.isDetail,"click-log-handler":t.repostLogHandler,url:t.originDynamicDetailUrl},on:{mouseenter:t.originDescMouseEnter,mouseleave:t.originDescMouseLeave,click:t.originCardLogHandler}}),[this.originType===t.TYPES.WORD&&t.originalCardInfo.voteInfo?i("card-vote",{attrs:{content:t.originalCardInfo.voteInfo.title,desc:t.originalCardInfo.voteInfo.desc},on:{click:t.onVoteCardClick}}):t._e(),t.originType===t.TYPES.PIC?i("images-box",{attrs:{"extend-callback":t.extendImageLogHandler,"origin-callback":t.originImageLogHandler,images:t.originalCardInfo.images,parentDOM:t.containerDOM,"show-img-tag":!0,"dynamic-id":t.cardInfo.desc.dynamic_id,"spm-page-type-string":t.spmPageTypeString}}):t.originType===t.TYPES.VIDEO?i("card-video",{attrs:{"see-later-callback":t.seeLaterLogHandler,"link-callback":t.originCardLogHandler,preview:!0,image:t.originalCardInfo.image,title:t.originalCardInfo.title,content:t.originalCardInfo.desc,aid:t.originalCardInfo.aid,duration:t.originalCardInfo.duration,view:t.originalCardInfo.view,danmaku:t.originalCardInfo.danmaku,link:t.originalCardInfo.url,"need-pay":t.originalCardInfo.needPay,"is-cooperation":t.originalCardInfo.isCooperation}}):t.originType===t.TYPES.CLIP?i("div",{staticClass:"p-rel vc-ctnr"},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.vcPlayed,expression:"!vcPlayed"}],staticClass:"vc-cover",style:{backgroundImage:"url("+t.originalCardInfo.cover+")"},on:{click:t.playVc}},[i("span",{staticClass:"duration"},[t._v(t._s(t._f("formatMinutes")(t.originalCardInfo.duration)))]),i("div",{staticClass:"play-area"},[i("img",{staticClass:"play-btn",attrs:{src:n(353)}})])]),i("div",{ref:"vcCtnr",staticClass:"vc-video"})]):t.originType===t.TYPES.ARTICLE?i("card-article",{attrs:{"link-callback":t.originCardLogHandler,images:t.originalCardInfo.images,title:t.originalCardInfo.title,content:t.originalCardInfo.desc,link:t.originalCardInfo.url}}):t.originType===t.TYPES.MUSIC?i("card-music",{attrs:{"link-callback":t.originCardLogHandler,link:t.originalCardInfo.url,image:t.originalCardInfo.cover,content:t.originalCardInfo.title,desc:t.originalCardInfo.desc}}):t.originType===t.TYPES.BANGUMI||t.originType===t.TYPES.FILM||t.originType===t.TYPES.TV||t.originType===t.TYPES.DOCUMENTARY?i("card-bangumi",{attrs:{"link-callback":t.originCardLogHandler,image:t.originalCardInfo.cover,title:t.originalCardInfo.title,view:t.originalCardInfo.play_count,danmaku:t.originalCardInfo.bullet_count,link:t.originalCardInfo.url,tags:t.originalCardInfo.tags}}):t.originType===t.TYPES.H5_SHARE&&t.isSupportBizType?i("card-h5-share",{attrs:{link:t.originalCardInfo.target_url,image:t.originalCardInfo.cover,content:t.originalCardInfo.title,desc:t.originalCardInfo.desc,tag:t.originalCardInfo.tag}}):t.originType===t.TYPES.COMIC_SHARE&&t.isSupportBizType?i("card-comic-share",{attrs:{link:t.originalCardInfo.target_url,cover:t.originalCardInfo.cover,title:t.originalCardInfo.title,content:t.originalCardInfo.tagsText,author:t.originalCardInfo.author,desc:t.originalCardInfo.desc,tags:t.originalCardInfo.tag}}):t.originType===t.TYPES.LIVE_ROOM||t.originType===t.TYPES.LIVE?i("card-live",{attrs:{link:t.originalCardInfo.url,"cover-url":t.originalCardInfo.cover,"show-view-num":t.originalCardInfo.show_view_num,"view-num":t.originalCardInfo.view_num,title:t.originalCardInfo.title,"area-name":t.originalCardInfo.area_name,status:t.originalCardInfo.status,"link-callback":t.originCardLogHandler}}):t.originType===t.TYPES.MEDIA_LIST?i("card-media-list",{attrs:{link:t.originalCardInfo.url,cover:t.originalCardInfo.cover,"cover-type":t.originalCardInfo.coverType,title:t.originalCardInfo.title,description:t.originalCardInfo.description,"content-count":t.originalCardInfo.contentCount,"link-callback":t.originCardLogHandler}}):t.originType===t.TYPES.CHEESE_SERIES||t.originType===t.TYPES.CHEESE_UPDATE?i("card-cheese",{attrs:{"link-callback":t.originCardLogHandler,image:t.originalCardInfo.image,title:t.originalCardInfo.title,subtitle:t.originalCardInfo.subtitle,content:t.originalCardInfo.desc,link:t.originalCardInfo.url,"is-update":t.originType===t.TYPES.CHEESE_UPDATE}}):t._e(),t.hasShopCard?i("shop-panel",{attrs:{"shop-card-list":t.shopCardList,"is-repost":t.isRepost,"card-info":t.cardInfo}}):t._e()]],2):i("div",{staticClass:"not-support"},[t._m(0)])]),t.likeUsersPanelShow?i("like-users-panel",{attrs:{uid:t.myUid,"dynamic-id":t.cardInfo.desc.dynamic_id,"like-info":t.likeInfo}}):t._e(),i("div",{ref:"iframeDom"})],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"tc-slate p-rel"},[e("i",{staticClass:"bp-icon-font icon-jinz-01 forbidden-icon"}),e("span",{staticClass:"forbidden-text"},[this._v("暂不支持此类动态显示")])])}],!1,null,"4671e8ec",null).exports);n(146);var be=n(67),ye=n(26),_e=n(68);function we(t,e,n,i,o,r,a){try{var s=t[r](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}var Ce,xe={data:function(){return{boxText:"",wordLength:0,maxLength:233,isExceed:!1,sendDynId:"",emojiBoxShown:!1,isChildForward:!1,isMounted:!1,atItems:[],contentAtItems:[],loginInfo:f.t.getMyLoginInfo(),userInfo:f.t.getMyUserInfo(),pageType:I.getPageType()}},props:{textareaWidth:{type:Number,default:0},forwInfo:{type:Object,default:function(){return{content:"",atUsers:[]}}},cardInfo:{type:Object},feedCurrentType:{type:Number,default:0}},components:{EmojiBox:be.a,AtPopup:_e.a},methods:{getAreaHeight:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:180,e=this.$refs.textarea,n=40,i=0;this.$nextTick(function(){e.style.cssText+="height: ".concat(n,"px;");var o=(i=e.scrollHeight>n?t>e.scrollHeight?e.scrollHeight:t:25)>=t?"auto":"hidden";e.style.cssText+="height: ".concat(i,"px; overflow: ").concat(o,";")})},sendMsg:function(){var t=this;if(Object(h.d)(y.d.CARD_SHARE_2,k(this.cardInfo)),this.loginInfo.isLogin&&!this.isExceed){var e=Object(ye.c)(this.boxText);0===e.length&&(e="转发动态");var n={uid:f.t.getUid(),dynamic_id:this.sendDynId,content:e,extension:JSON.stringify({emoji_type:1})},i=f.a.generateAtParams(e,this.contentAtItems,this.atItems),o=i.atUids,r=i.ctrl;n.at_uids=o,n.ctrl=r;var a={url:O.a.API_VC+"/dynamic_repost/v1/dynamic_repost/repost",method:"post",data:n};this.bpapi(a).then(function(n){if(0===n.data.result)t.atItems=[],t.contentAtItems=[],t.$nextTick(function(){f.b.$emit(y.b.INSERT_FORWARDING,{extend_json:JSON.stringify({from:{emoji_type:1}}),desc:{timestamp:Math.floor((new Date).getTime()/1e3),uid:f.t.getUid(),user_profile:{info:{uname:t.userInfo.card.name,face:t.userInfo.card.face}},dynamic_id:n.data.dynamic_id},card:JSON.stringify({item:{content:e}})},t.cardInfo.desc.dynamic_id,t.isChildForward)}),setTimeout(function(){t.linkMsg(t.$refs.submitbtn,"发送成功","success")},500),t.boxText="",t.feedCurrentType===y.a.HOT&&t.bpapi({method:"post",url:"".concat(O.a.API_VC,"/dynamic_report/v1/dynamic_report/rcmd_report"),data:{report_type:3,uid:f.t.getUid(),dynamic_id:t.cardInfo.desc.dynamic_id}}),f.b.$emit(y.b.SET_TOP,t.cardInfo.desc.dynamic_id);else{if(2===n.data.result)return Object(m.k)(t);t.linkMsg(t.$refs.submitbtn,n.data.errmsg,"caution")}},function(e){t.linkMsg(t.$refs.submitbtn,e.msg,e.type)})}},quickLogin:(Ce=function(t){return function(){var e=this,n=arguments;return new Promise(function(i,o){var r=t.apply(e,n);function a(t){we(r,i,o,a,s,"next",t)}function s(t){we(r,i,o,a,s,"throw",t)}a(void 0)})}}(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.i)();case 2:case"end":return t.stop()}},t)})),function(){return Ce.apply(this,arguments)}),textareaMove:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;if(e=e||0,n=n||0,t.createTextRange){var i=t.createTextRange();i.collapse(!0),i.moveStart("character",e),i.moveEnd("character",n),i.select()}else{var o=0===n?e:n;t.setSelectionRange(e,o),t.focus()}},forwardHandler:function(t,e){var n=this;if(e===this.cardInfo.desc.dynamic_id){this.isChildForward=t.isChildForward,this.boxText=t.comment,this.sendDynId=t.dynId,this.contentAtItems=t.atUsers;var i=this.$refs.textarea;if(!i)return;this.$nextTick(function(){n.textareaMove(i,0,0)})}},validate:function(){return!this.emojiBoxShown},selectHandler:function(t){var e=this.boxText,n=this.$refs.textarea.selectionEnd,i=e.substring(0,n),o=e.substring(n),r=i.lastIndexOf("@");i=i.substring(0,r+1),this.boxText="".concat(i).concat(t.uname," ").concat(o),this.atItems.push(t)},logHandler:function(){Object(h.d)(y.d.PUBLISH_AT_LIST_SHOW,k(this.cardInfo))}},watch:{boxText:function(){this.getAreaHeight(),this.wordLength=this.boxText.length,this.isExceed=this.wordLength>this.maxLength,0===this.wordLength&&(this.sendDynId=this.cardInfo.desc.dynamic_id,this.isChildForward=!1)}},mounted:function(){var t=this;this.isMounted=!0;var e=this.$refs.textarea;this.loginInfo.isLogin&&""===this.boxText&&this.cardInfo.desc.type===y.a.REPOST&&(this.boxText=this.forwInfo.content,this.contentAtItems=this.forwInfo.atUsers,this.$nextTick(function(){t.textareaMove(e,0,0)})),this.$nextTick(function(){e&&t.loginInfo.isLogin&&e.focus()}),this.sendDynId=this.cardInfo.desc.dynamic_id,this.getAreaHeight(),f.b.$on(y.b.FORWARD_DYNAMIC,this.forwardHandler)}},Ie=(n(380),Object(K.a)(xe,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"f-left textarea-container"},[t.loginInfo.isLogin?t._e():n("div",{staticClass:"comm-nologin",style:{width:t.textareaWidth+"px"}},[t._v("请先"),n("a",{staticClass:"loginBtn",on:{click:t.quickLogin}},[t._v("登录")]),t._v("后转发 (・ω・)")]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.boxText,expression:"boxText"}],ref:"textarea",staticClass:"textarea",style:{width:t.textareaWidth+"px"},attrs:{spellcheck:"false",placeholder:"请自觉遵守互联网相关的政策法规，严禁发布色情、暴力、反动的言论。"},domProps:{value:t.boxText},on:{input:function(e){e.target.composing||(t.boxText=e.target.value)}}}),t.isMounted?n("at-popup",{attrs:{"input-elm":t.$refs.textarea,"select-handler":t.selectHandler,validate:t.validate,"log-handler":t.logHandler}}):t._e(),n("div",{staticClass:"comm-tool f-clear"},[n("div",{ref:"emojiTrigger",staticClass:"comm-emoji f-left",class:{exceed:t.isExceed||!t.loginInfo.isLogin},on:{click:function(e){t.emojiBoxShown=t.loginInfo.isLogin&&!0}}},[n("i",{staticClass:"dynamic-comm-icon icon-face"}),n("span",{staticClass:"comm-text"},[t._v("表情")]),t.emojiBoxShown?n("emoji-box",{staticClass:"bp-emoji-box",attrs:{field:t.$refs.textarea,"frozen-elements":[t.$refs.textarea,t.$refs.emojiTrigger],"emoji-type":["kaomojis","dynamicEmojis"],"spm-type":t.pageType},on:{close:function(e){t.emojiBoxShown=!1}}}):t._e()],1),n("div",{ref:"submitbtn",staticClass:"comm-submit f-right",class:{exceed:t.isExceed||!t.loginInfo.isLogin},on:{click:t.sendMsg}},[t._v("转发")]),n("div",{staticClass:"comm-word f-right"},[n("span",{class:{exceed:t.isExceed}},[t._v(t._s(t.wordLength))]),n("span",[t._v("/"+t._s(t.maxLength))])])])],1)},[],!1,null,"5cacf363",null).exports),ke={data:function(){return{text:""}},props:{forwData:{type:Object,default:function(){return{}}},cardInfo:{type:Object},clickLogHandler:{type:Function,default:function(){}}},methods:{getUserInfoUrl:function(){return"".concat(O.a.SPACE,"/").concat(this.uid,"/dynamic")},onUserInfoClick:function(t){var e="head"===t?y.d.CARD_HEAD:y.d.CARD_NICKNAME,n=Object.assign(k(this.cardInfo),{jumpfrom:3});Object(h.d)(e,n)},toBfsImg:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"//static.hdslb.com/images/member/noface.gif",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return Object(d.g)(Object(m.a)(t,e,n))},forwardChildDynamic:function(){if(!f.t.getMyLoginInfo().isLogin)return Object(m.i)(),this.linkMsg(this.$refs.submitbtn,"请先登陆","info");var t={uid:this.uid,uname:this.uname},e=this.getAtUserList(this.comment,this.ctrl,t);f.b.$emit(y.b.FORWARD_DYNAMIC,{dynId:"".concat(this.dynamicId),comment:"//@".concat(this.uname,":").concat(this.comment),isChildForward:!0,atUsers:e},this.cardInfo.desc.dynamic_id)},getAtUserList:function(t,e,n){var i=[n];if(!e||""===e)return i;var o=Object(d.e)(e);return Array.isArray(o)||(o=[]),o.forEach(function(e){var n={uid:~~e.data,uname:t.substr(e.location+1,e.length-1)};0===i.filter(function(t){return t.uid===n.uid}).length&&i.push(n)}),i},click:function(t){t.target&&"A"===t.target.nodeName&&this.clickLogHandler()},initText:function(){var t=this,e=Object(d.e)(this.cardInfo.extend_json),n=Object(d.e)((this.forwData||{}).extend_json),i={vote:e.vote,lott:e.lott,from:n.from},o=JSON.stringify(i),r=Object(f.q)(this.comment,{ctrlJson:this.ctrl,extendCtrlJson:o,dynamicId:this.dynamicId});Object(f.n)(r,{ctrlJson:this.ctrl,extendCtrlJson:o,dynamicId:this.dynamicId}).then(function(e){t.text=e,I.getIsNeedCardPopup()&&t.$nextTick(function(){t.attachAtHrefs()})})},attachAtHrefs:function(){for(var t=this.$refs.text.children,e=0;e<t.length;e++){var n=t[e];if("A"===n.nodeName){var i=n.href.match(/\/\/space\.bilibili\.com\/(\d+)/);if(i){var o=+i[1];o&&Object(p.a)(o,this.$refs.wrap,n)}}}}},computed:{getPublishTime:function(){return C(this.forwData.desc.timestamp)},uid:function(){return this.forwData.desc.uid},uname:function(){return this.forwData.desc.user_profile.info.uname},ctrl:function(){return this.forwData.extend_json&&JSON.stringify(JSON.parse(this.forwData.extend_json).ctrl)||""},face:function(){return this.forwData.desc.user_profile.info.face},dynamicId:function(){return this.forwData.desc.dynamic_id},comment:function(){try{return JSON.parse(this.forwData.card).item.content||""}catch(t){return""}}},mounted:function(){this.initText(),I.getIsNeedCardPopup()&&(Object(p.a)(this.uid,this.$refs.wrap,this.$refs.userhead),Object(p.a)(this.uid,this.$refs.wrap,this.$refs.username))}},Se=(n(381),Object(K.a)(ke,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"wrap",staticClass:"dynamic-list-item-wrap f-clear"},[n("div",{staticClass:"f-left"},[n("div",{ref:"userhead",staticClass:"forw-face"},[n("a",{staticClass:"c-pointer",attrs:{href:t.getUserInfoUrl("head"),target:"_blank"},on:{click:function(e){return t.onUserInfoClick("head")}}},[n("img",{staticClass:"forw-head",attrs:{src:t.toBfsImg(t.face,32,32)}})])])]),n("div",{staticClass:"item-detail f-left"},[n("div",{staticClass:"item-user"},[n("a",{ref:"username",staticClass:"user-name c-pointer",attrs:{href:t.getUserInfoUrl("name"),target:"_blank"},on:{click:function(e){return t.onUserInfoClick("name")}}},[t._v(t._s(t.uname))])]),n("div",{ref:"text",staticClass:"text",domProps:{innerHTML:t._s(t.text)},on:{click:t.click}}),n("div",{staticClass:"info"},[n("span",{staticClass:"time"},[t._v(t._s(t.getPublishTime))]),t.dynamicId?n("a",{ref:"submitbtn",staticClass:"forw-submit f-right",on:{click:t.forwardChildDynamic}},[t._v("转发")]):t._e()])])])},[],!1,null,"78a08664",null).exports),Oe={},Pe=(n(382),Object(K.a)(Oe,function(){var t=this.$createElement;this._self._c;return this._m(0)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"comm-loading"},[e("span",{staticClass:"loading-icon"}),e("span",[this._v("加载中……")])])}],!1,null,"740f9d96",null).exports),Te=(n(383),{props:{pageType:{type:String,required:!0},cardInfo:{type:Object,default:function(){}},feedCurrentType:{type:Number,default:0},cardData:{type:Object,default:function(){}}},data:function(){return{isLoading:!1,isLoaded:!1,isLoadingMore:!1,offset:0,firstCount:5,forwInfo:{content:"",atUsers:[]},list:[],hasMore:!0,loginInfo:f.t.getMyLoginInfo(),userInfo:f.t.getMyUserInfo()}},components:{forwSendBox:Ie,loading:Pe,forwListItem:Se},methods:{toBfsImg:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"//static.hdslb.com/images/member/noface.gif",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return Object(d.g)(Object(m.a)(t,e,n))},getForwardingList:function(){var t=this;if(this.hasMore&&!this.isLoading&&!this.isLoadingMore){this.isLoading=!0;var e={url:O.a.API_VC+"/dynamic_repost/v1/dynamic_repost/repost_detail",method:"get",data:{dynamic_id:this.cardInfo.desc.dynamic_id,offset:this.offset||void 0}};this.bpapi(e).then(function(e){var n=e.data;n.items&&0!==n.total||(n.items=[]),0===t.offset&&(t.isDetailPage||(n.items.length>t.firstCount&&(n.has_more=!0),n.items=n.items.slice(0,t.firstCount))),t.offset=n.offset,t.list=t.list.concat(n.items),t.hasMore=n.has_more,t.isLoading=!1,t.isLoaded=!0,t.isLoadingMore=!1},function(e){t.linkMsg(t.$refs.foraArea,e.msg,e.type),t.isLoading=!1,t.isLoaded=!0,t.isLoadingMore=!1})}},loadMore:function(){if(this.hasMore&&!this.isLoading&&!this.isLoadingMore&&this.isLoaded){if(Object(h.d)(y.d.CARD_SHARE_3,k(this.cardInfo)),!this.isDetailPage)return window.open(this.cardData.more_forw_url);this.getForwardingList()}},getAtUserList:function(t,e,n){var i=[n];if(!e||""===e)return i;var o=Object(d.e)(e);return Array.isArray(o)||(o=[]),o.forEach(function(e){var n={uid:~~e.data,uname:t.substr(e.location+1,e.length-1)};0===i.filter(function(t){return t.uid===n.uid}).length&&i.push(n)}),i},clickLogHandler:function(){Object(h.d)(y.d.CARD_RT_ATCLICK,k(this.cardInfo))}},computed:{isDetailPage:function(){return this.pageType===y.c.DETAIL},isTagPage:function(){return this.pageType===y.c.TAG}},mounted:function(){var t=this;if(this.cardInfo.desc.type===y.a.REPOST){var e=Object(d.e)(this.cardInfo.card);if(e){var n=e.item.content,i={uid:this.cardInfo.desc.user_profile.info.uid,uname:this.cardInfo.desc.user_profile.info.uname};this.forwInfo.atUsers=f.a.generateAtUsers(n,e.item.ctrl,i),this.forwInfo.content="//@".concat(this.cardInfo.desc.user_profile.info.uname,":").concat(n)}}this.getForwardingList(this.offset),f.b.$on(y.b.INSERT_FORWARDING,function(e,n,i){t.cardInfo.desc.dynamic_id!==n||y.a.REPOST===t.cardInfo.desc.type&&!0===i||(t.list.unshift(e),_(t.cardInfo),f.b.$emit(y.b.STORAGE_UPDATE,t.cardInfo))}),f.b.$on(y.b.FORWARDING_SCROLL,function(){t.$refs.loadMore&&t.isDetailPage&&function(t){if("undefined"==typeof window)return!1;var e=t.getBoundingClientRect().top;return e+t.offsetHeight<=window.innerHeight&&e>0}(t.$refs.loadMore)&&t.loadMore()})},beforeDestroy:function(){f.b.$off(y.b.INSERT_FORWARDING),f.b.$off(y.b.FORWARDING_SCROLL)}}),Ee=(n(384),Object(K.a)(Te,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"foraArea",staticClass:"forw-area"},[t.isLoading?n("div",{staticClass:"forw-loading-box"},[n("loading")],1):t._e(),t.isLoaded?n("div",{staticClass:"forw-main"},[n("div",{staticClass:"forw-send f-clear"},[n("div",{staticClass:"f-left"},[n("div",{staticClass:"forw-face"},[n("img",{staticClass:"forw-head",attrs:{src:t.toBfsImg(t.userInfo.card.face,32,32)}})])]),n("forw-send-box",{attrs:{"textarea-width":470,"forw-info":t.forwInfo,"card-info":t.cardInfo,"feed-current-type":t.feedCurrentType}})],1),n("div",{staticClass:"forw-list"},t._l(t.list,function(e,i){return n("forw-list-item",{key:String(Math.random()),attrs:{"forw-data":e,"card-info":t.cardInfo,"click-log-handler":t.clickLogHandler}})}),1)]):t._e(),n("div",{staticClass:"forw-more",class:{"forw-more-tag":t.isTagPage}},[t.isLoadingMore?n("loading",[t._v("加载中...")]):[t.hasMore?n("a",{ref:"loadMore",staticClass:"more",on:{click:t.loadMore}},[t._v("查看更多转发")]):n("a",{class:{nomore:!t.hasMore}},[t._v("没有更多啦(〜￣△￣)〜")])]],2)])},[],!1,null,"d228cba2",null).exports),je=(n(438),n(439),n(56),n(51)),Le={props:{show:null,title:String,hideButton:Boolean,disabled:null},components:{BpPopup:je.a},methods:{onConfirm:function(t){this.$emit("onConfirm",t)},onCancel:function(t){this.$emit("onCancel",t)}}},Ae=(n(385),n(386),Object(K.a)(Le,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"im-popup-fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"im-popup"},[t.hideButton?t._e():n("bp-popup",{staticClass:"im-popup-shell",attrs:{show:t.show,title:t.title,onConfirm:t.onConfirm,onCancel:t.onCancel,disabled:t.disabled}},[n("div",{staticClass:"content"},[t._t("default")],2)]),t.hideButton?n("bp-popup",{staticClass:"im-popup-shell hide-button",staticStyle:{width:"auto !important",padding:"0",margin:"0"},attrs:{show:t.show,title:t.title,onConfirm:t.onConfirm,onCancel:t.onCancel,button:!1}},[n("div",{staticClass:"split-line"}),n("div",{staticClass:"content",staticStyle:{padding:"0"}},[t._t("default")],2)]):t._e()],1)])},[],!1,null,"5fddcd77",null).exports),De={props:["checked","value","name"],data:function(){return{}},computed:{},watch:{},components:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{onClick:function(t){this.$emit("click",t)}}},Me=(n(387),Object(K.a)(De,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"type-selector"},[n("input",{staticClass:"radio",attrs:{name:t.name,type:"radio"},domProps:{value:t.value,checked:t.checked},on:{click:t.onClick}}),t.checked?n("span",{staticClass:"radio-selected"}):t._e(),t.checked?t._e():n("span",{staticClass:"radio-default"}),t._t("default")],2)},[],!1,null,"1f7f31f2",null).exports),Ne={props:{show:null,types:Array,accusedUid:[String,Number],objectId:[String,Number]},data:function(){return{type:-1,reportContent:"",maxNum:60,reportTypeList:[{type:4,name:"垃圾广告"},{type:7,name:"话题不相关"},{type:8,name:"引战"},{type:1,name:"色情"},{type:5,name:"人身攻击"},{type:3,name:"违法信息"},{type:0,name:"其他"}]}},computed:{showList:function(){var t=this;return this.types?this.reportTypeList.filter(function(e){return t.types.includes(e.type)}):this.reportTypeList},tooMuch:function(){return this.reportContent.length>this.maxNum},active:function(){return!!(this.type&&this.type>0||0===this.type&&this.reportContent.trim())}},components:{ImPopup:Ae,ImRadio:Me},methods:{onConfirm:function(){this.active?this.reportIt():this.linkMsg(this.$refs.popup,"请输入举报内容","caution",!0)},onCancel:function(){this.$emit("cancel")},reportIt:function(){var t=this;return this.bpapi({url:"//api.vc.bilibili.com/bplus_report/v1/Report/add",data:{biz_code:this.bizCode||7,module:this.module||1202,accused_uid:this.accusedUid,object_id:this.objectId,reason_type:this.type,reason_desc:0===this.type?this.reportContent:void 0},method:"post"}).then(function(){t.linkMsg(t.$refs.popup,"举报成功","success",!0),t.$emit("success")},function(e){t.linkMsg(t.$refs.popup,"举报失败，".concat(e.msg),"error",!0)})}}},Re=(n(388),Object(K.a)(Ne,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("im-popup",{staticClass:"report-popup",attrs:{show:t.show,title:"我要举报",disabled:!t.active},on:{onConfirm:t.onConfirm,onCancel:t.onCancel}},[n("div",{ref:"popup",staticClass:"content-text"},[t._v("请选择举报的理由：")]),n("div",{staticClass:"selector-box"},t._l(t.showList,function(e){return n("im-radio",{key:e.type,class:{"other-reason":0===e.type},attrs:{checked:e.type===t.type,value:e.type,name:"report-type"},on:{click:function(n){t.type=e.type}}},[t._v(t._s(e.name))])}),1),n("div",{directives:[{name:"show",rawName:"v-show",value:0===t.type,expression:"type === 0"}],staticClass:"report-tip"},[t._v("为帮助审核人员更快处理，请补充问题类型和出现位置等详细信息")]),n("div",{directives:[{name:"show",rawName:"v-show",value:0===t.type,expression:"type === 0"}],staticClass:"input-box report-input"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.reportContent,expression:"reportContent"}],staticClass:"textarea",attrs:{maxlength:t.maxNum,autofocus:"autofocus",placeholder:"举报内容",max:"50"},domProps:{value:t.reportContent},on:{input:function(e){e.target.composing||(t.reportContent=e.target.value)}}}),n("div",{staticClass:"indicator"},[n("span",{class:{"too-much":t.tooMuch}},[t._v(t._s(t.reportContent.length))]),t._v("/"),n("span",[t._v(t._s(t.maxNum))])])])])},[],!1,null,"f55b66b8",null).exports);o.a.use(Object(r.a)()),o.a.use(a.a),o.a.use(mt.b);var Be=Re,Ue=(n(389),Object(K.a)({},function(){var t=this.$createElement;this._self._c;return this._m(0)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"skeleton"},[e("div",{staticClass:"skeleton-head"}),e("div",{staticClass:"skeleton-body"},[e("div",{staticClass:"first-line"},[e("div",{staticClass:"skeleton-user-name"}),e("div",{staticClass:"skeleton-focusbtn"})]),e("div",{staticClass:"skeleton-time"}),e("div",{staticClass:"skeleton-content"})])])}],!1,null,"17bb0413",null).exports),He=n(221),$e=n.n(He),Fe={props:{src:{type:String},id:{type:String,default:"svga-player"},autoplay:{type:Boolean,default:!0}},mounted:function(){this.playUrl(this.src)},watch:{src:function(t){this.playUrl(t)}},methods:{playUrl:function(t){var e=this;if(t){var n=new $e.a.Player("#"+this.id),i=new $e.a.Parser("#"+this.id);n.loops=1,i.load(t.replace(/^http:/,"https:"),function(t){e.$emit("start"),n.setVideoItem(t),e.autoplay&&n.startAnimation()}),n.onFinished(function(){e.$emit("finish")})}else this.$emit("finish")}}},Ve=(n(390),Object(K.a)(Fe,function(){var t=this.$createElement;return(this._self._c||t)("div",{directives:[{name:"show",rawName:"v-show",value:this.src,expression:"src"}],staticClass:"svga-player",attrs:{id:this.id}})},[],!1,null,null,null).exports);function ze(t,e,n,i,o,r,a){try{var s=t[r](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}function Ge(t){return function(){var e=this,n=arguments;return new Promise(function(i,o){var r=t.apply(e,n);function a(t){ze(r,i,o,a,s,"next",t)}function s(t){ze(r,i,o,a,s,"throw",t)}a(void 0)})}}var Je,We,Ke,Ye,qe,Qe={data:function(){return{showMorePanel:!1,isUnfocus:"undefined"==typeof window||this.cardInfo.isUnfocus,detailLink:"".concat(O.a.T,"/").concat(this.cardInfo.desc.dynamic_id,"?tab=2"),isTransmitHover:!1,isCommentHover:!1,isPraiseHover:!1,currentTop:0,showForwardingPanelData:!1,showCommentPanelData:!1,isInThisCard:!1,chromeScaleFix:!1,lazyLoaded:!1,emojiInited:!1,isShowLog:!1,attentionList:f.t.getMyAttentionList(),date:this.getNewDate(),reportPopupShow:!1,reportDid:"",reportUid:"",hasInitComment:!1,scrollContainer:null,canRender:!0,HOST:O.a,svgaPlayerShown:!1,svgaPlayerStart:!1,isLovedTemp:-1}},props:{cardInfo:{type:Object,required:!0},isSelf:{type:Boolean,required:!0},isDraft:{type:Boolean,default:!1},isNeedCardPopup:{type:Boolean,default:!0},idx:{type:Number,default:0},defaultTab:{type:Number},pageType:{type:String},scrollDom:{},currentType:{type:Number,default:0},topicName:{type:String},popupDom:null,disableLazyLoad:{type:Boolean,default:!1},foldItems:null,ifJumpAfterLogin:{type:Boolean,default:function(){return!0}}},components:{CardContent:ve,Forwarding:Ee,ReportPopup:Be,CardSkeleton:Ue,SvgaPlayer:Ve},created:function(){I.setCurrentType(this.currentType),I.setIsNeedCardPopup(this.isNeedCardPopup),I.setPageType(this.pageType)},watch:{currentType:function(t){I.setCurrentType(t)},lazyLoaded:function(t){t&&(this.initCardRich(),this.cardInfo.foldType&&Object(h.d)(y.d.FOLD_SHOW,this.cardInfo.foldType))},emojiInited:function(t){var e=this;t&&(this.canRender=!1,this.$nextTick(function(){e.canRender=!0}))}},mounted:function(){var t=this;this.scrollContainer=this.scrollDom||window,Object(f.k)().then(function(){t.emojiInited=!0}),window.devicePixelRatio>=1.1&&window.devicePixelRatio<=1.2&&(this.chromeScaleFix=!0),this.initBus(),this.initEvent(),this.lazyLoaded=this.isInViewport(),(this.isHotTab||this.isTagPage)&&(this.isUnfocus=-1===this.attentionList.indexOf(this.cardInfo.desc.uid)),1===this.defaultTab?this.onTransmitClick():2===this.defaultTab&&this.onCommentClick(),m.c.$on("ShowBvConfigUpdated",function(){t.canRender=!1,t.$nextTick(function(){t.canRender=!0})})},beforeDestroy:function(){f.b.$off(y.b.MORE_PANEL_CLOSE,this.morePanelClose)},methods:{numberFormat:m.h.autoParse,initCommentComponent:function(t){var e=this;if(!window._bp_comment_css_loaded){window._bp_comment_css_loaded=!0;var n=document.createElement("link");n.rel="stylesheet",n.href="//static.hdslb.com/phoenix/dist/css/comment.min.css?v=2",document.getElementsByTagName("head")[0].appendChild(n)}window.bbComment?this.commentComponentCallback():l()("//static.hdslb.com/phoenix/dist/js/comment.min.js?v=2").then(function(){e.commentComponentCallback()})},commentComponentCallback:function(){var t=this;this.hasInitComment=!0;var e=location.hash.match(/reply(\d+)/),n={oid:this.cardData.comment_oid,pageType:this.cardData.comment_id,noPage:!this.isDetailPage,dynamicRepost:!0,smallPager:!0,pageSize:10,jumpId:e&&e[1],contentMaxLength:233};if(window.bbComment){var i=new bbComment(this.$refs.bbcomment,n);i.on("commentSent",function(){Object(h.d)(y.d.CARD_COMMENT_2,k(t.cardInfo))}),i.on("pageLoaded",function(){Object(h.d)(y.d.CARD_COMMENT_3,k(t.cardInfo))}),i.on("clickSpace",function(e){var n="face"===e?y.d.CARD_HEAD:y.d.CARD_NICKNAME,i=Object.assign(k(t.cardInfo),{jumpfrom:2});Object(h.d)(n,i)}),this.isDetailPage||i.on("moreLinkClick",function(){window.open(t.cardData.more_comment_url)}),i.on("dynamicRepost",function(e){var n={url:O.a.API_VC+"/dynamic_repost/v1/dynamic_repost/reply",method:"post",data:{uid:f.t.getUid(),type:1,rid:t.cardInfo.desc.dynamic_id,content:e,repost_code:3e4,from:"create.comment",extension:JSON.stringify({emoji_type:1})}};t.bpapi(n).then(function(e){0===e.data.result?(t.boxText="",t.tranIsCheck=!1,t.feedCurrentType===y.a.HOT&&t.uid&&t.bpapi({method:"post",url:"".concat(O.a.API_VC,"/dynamic_report/v1/dynamic_report/rcmd_report"),data:{report_type:3,uid:f.t.getUid(),dynamic_id:t.cardInfo.desc.dynamic_id}}),i.trigger("repostSuc",e)):i.trigger("repostFail",e)},function(t){i.trigger("repostError",t)})})}},initCardRich:function(){var t=this;!this.isBangumiLike&&I.getIsNeedCardPopup()&&this.$nextTick(function(){t.$refs.username&&Object(p.a)(t.cardInfo.desc.uid,t.$refs.card,t.$refs.username),t.$refs.userhead&&Object(p.a)(t.cardInfo.desc.uid,t.$refs.card,t.$refs.userhead)})},inThisCard:function(){this.isInThisCard=!0},outThisCard:function(){this.isInThisCard=!1},morePanelClose:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=t!==this.cardInfo.desc.dynamic_id;e?this.showMorePanel=!1:this.onMoreClick()},initEvent:function(){var t=this;document.body.addEventListener("click",function(){t.showMorePanel=!1},!1),this.$refs.morePanel&&this.$refs.morePanel.addEventListener("click",function(t){t.stopPropagation()},!1),this.$refs.buttonArea&&this.$refs.buttonArea.addEventListener("click",function(e){f.b.$emit(y.b.MORE_PANEL_CLOSE,t.cardInfo.desc.dynamic_id,t.cardInfo.desc.type,t.cardInfo.desc.uid),e.stopPropagation()},!1),v(this.scrollContainer,"scroll",this.scrollHandler)},scrollHandler:function(){var t=this.scrollContainer.scrollTop;f.b.$emit(y.b.SCROLL,t,this.scrollContainer),f.b.$emit(y.b.FORWARDING_SCROLL),f.b.$emit(y.b.COMM_SCROLL)},isInViewport:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.$refs.card;if(!e)return!1;if(this.lazyLoaded)return!0;var n=e.getBoundingClientRect().top,i=window.innerHeight;return n<i+400+t},clickHeadLog:function(){Object(h.d)(y.d.CARD_HEAD,Object.assign(k(this.cardInfo),{jumpfrom:1}))},clickNameLog:function(){Object(h.d)(y.d.CARD_NICKNAME,Object.assign(k(this.cardInfo),{jumpfrom:1}))},onSetTopClick:function(){var t=this;this.cardData.isSetTop?(Object(h.d)(y.d.CARD_MORE_TOP,k(this.cardInfo)),this.bpapi({method:"get",url:O.a.API_VC+"/dynamic_mix/v1/dynamic_mix/space_top_rm",data:{dynamic_id:this.cardInfo.desc.dynamic_id}}).then(function(t){window.location.reload()},function(e){t.linkMsg(t.$refs.setTopRef,"取消置顶失败，请稍后重试",e.type)})):(Object(h.d)(y.d.CARD_MORE_UNTOP,k(this.cardInfo)),this.bpapi({method:"get",url:O.a.API_VC+"/dynamic_mix/v1/dynamic_mix/space_top_set",data:{dynamic_id:this.cardInfo.desc.dynamic_id}}).then(function(t){window.location.reload()},function(e){t.linkMsg(t.$refs.setTopRef,"置顶失败，请稍后重试",e.type)}))},onDeleteClick:function(){var t=this;this.bpPopup({title:"删除动态",content:"确定要删除此条动态吗？",button:{confirm:"删除",cancel:"我点错了"}}).onConfirm(function(e){t.bpapi({method:"post",url:"".concat(O.a.API_VC,"/dynamic_svr/v1/dynamic_svr/rm_dynamic"),data:{dynamic_id:t.isFakeCard?t.cardInfo.did:t.cardInfo.desc.dynamic_id},throttleInterval:5e3}).then(function(n){t.linkMsg(e.confirmBtn,"删除成功",n.type),e.close(),t.delete()},function(n){t.linkMsg(e.confirmBtn,n.msg,n.type)})}).onCancel(function(e){t.showMorePanel=!1,e.close()})},onUnfocusClick:(qe=Ge(c.a.mark(function t(e){var n,i=this;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.isHotTab&&Object(h.d)(y.d.HOTFOLLOW,Object.assign(k(this.cardInfo),this.isGuestPage?{nologin:1}:{})),this.isDetailPage&&Object(h.d)(y.d.DETAIL_FOLLOW_CLICK,Object.assign(k(this.cardInfo),this.isGuestPage?{nologin:1}:{})),t.next=4,Object(m.i)(function(){i.ifJumpAfterLogin?(Object(h.d)(y.d.LOGIN_SUCCESS,{from:i.spmPageTypeString}),window.location.replace("https://t.bilibili.com/".concat(i.cardInfo.desc.dynamic_id))):window.location.reload()});case 4:if(t.sent){t.next=7;break}return t.abrupt("return");case 7:n=e.target,this.isUnfocus?this.bpapi({method:"post",url:"".concat(O.a.API_VC,"/feed/v1/feed/SetUserFollow"),data:{type:1,follow:this.cardInfo.desc.uid}}).then(function(t){i.setUnfocusStatus(!1),i.linkMsg(n,"关注成功！",t.type),i.showMorePanel=!1,f.t.insertToMyAttentionList(i.cardInfo.desc.uid),i.isHotTab&&i.uid&&(Object(h.d)(y.d.HOTFOLLOW,Object.assign(k(i.cardInfo),i.isGuestPage?{nologin:1}:{})),i.bpapi({method:"post",url:"".concat(O.a.API_VC,"/dynamic_report/v1/dynamic_report/rcmd_report"),data:{report_type:5,uid:i.uid,dynamic_id:i.cardInfo.desc.dynamic_id,count:1}}))},function(t){i.showMorePanel=!1,i.linkMsg(n,t.msg,t.type)}):this.bpPopup({title:"取消关注",content:"真的要取消对 ".concat(this.cardInfo.desc.user_profile.info.uname," 的关注吗？"),button:{confirm:"取消关注",cancel:"点错了~"}}).onConfirm(function(t){i.bpapi({method:"post",url:"".concat(O.a.API_VC,"/feed/v1/feed/SetUserFollow"),data:{type:0,follow:i.cardInfo.desc.uid}}).then(function(e){i.setUnfocusStatus(!0),i.linkMsg(t.confirmBtn,"取消了对 ".concat(i.cardInfo.desc.user_profile.info.uname," 的关注"),e.type),i.showMorePanel=!1,t.close(),f.t.deleteFromMyAttentionList(i.cardInfo.desc.uid),i.isHotTab&&i.uid&&i.bpapi({method:"post",url:"".concat(O.a.API_VC,"/dynamic_report/v1/dynamic_report/rcmd_report"),data:{report_type:5,uid:i.uid,dynamic_id:i.cardInfo.desc.dynamic_id,count:-1}})},function(e){t.close(),i.linkMsg(t.confirmBtn,e.msg,e.type)})}).onCancel(function(t){i.showMorePanel=!1,t.close()});case 9:case"end":return t.stop()}},t,this)})),function(t){return qe.apply(this,arguments)}),setUnfocusStatus:function(t){f.b.$emit(y.b.UNFOCUS,this.cardInfo,t),this.updateAllStorage(this.cardInfo,t)},updateAllStorage:function(t,e){var n=this;y.e.forEach(function(i){var o="dynamic_cards_".concat(n.uid,"_").concat(i.type),r=f.s.get(o);if(r){var a=Object(d.e)(r)||[];a.forEach(function(n){n.desc.uid===t.desc.uid&&(n.isUnfocus=e)}),f.s.set(o,a)}})},unfocusHandler:function(t,e){t.desc.uid===this.cardInfo.desc.uid&&(this.cardInfo.isUnfocus=e,this.isUnfocus=e)},onReportClick:(Ye=Ge(c.a.mark(function t(){var e=this;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.i)(function(){e.ifJumpAfterLogin?(Object(h.d)(y.d.LOGIN_SUCCESS,{from:e.spmPageTypeString}),window.location.replace("https://t.bilibili.com")):window.location.reload()});case 2:if(t.sent){t.next=5;break}return t.abrupt("return");case 5:this.reportUid=this.cardInfo.desc.uid,this.reportDid=this.cardInfo.desc.dynamic_id,this.reportPopupShow=!0;case 8:case"end":return t.stop()}},t,this)})),function(){return Ye.apply(this,arguments)}),onReportSucess:function(){this.reportPopupShow=!1},onReportCancel:function(){this.reportPopupShow=!1},onMoreClick:function(){this.showMorePanel=!this.showMorePanel},onTransmitHover:function(){this.isTransmitHover=!0},onTransmitLeave:function(){this.isTransmitHover=!1},onCommentHover:function(){this.isCommentHover=!0},onCommentLeave:function(){this.isCommentHover=!1},onPraiseHover:function(){this.isPraiseHover=!0},onPraiseLeave:function(){this.isPraiseHover=!1},onTransmitClick:(Ke=Ge(c.a.mark(function t(){var e=this;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.showForwardingPanelData?Object(h.d)(y.d.CARD_SHARE_0,Object.assign(k(this.cardInfo),this.isGuestPage?{nologin:1}:{})):Object(h.d)(y.d.CARD_SHARE_1,Object.assign(k(this.cardInfo),this.isGuestPage?{nologin:1}:{})),!this.isGuestPage){t.next=7;break}return t.next=4,Object(m.i)(function(){e.ifJumpAfterLogin?(Object(h.d)(y.d.LOGIN_SUCCESS,{from:e.spmPageTypeString}),window.location.replace("https://t.bilibili.com/".concat(e.cardInfo.desc.dynamic_id,"?tab=1"))):window.location.reload()});case 4:if(t.sent){t.next=7;break}return t.abrupt("return");case 7:if(!this.isDeletedDyn){t.next=9;break}return t.abrupt("return",this.linkMsg(this.$refs.transmitRef,"禁止转发","caution"));case 9:this.showForwardingPanelData=!this.showForwardingPanelData,this.showCommentPanelData=!1;case 11:case"end":return t.stop()}},t,this)})),function(){return Ke.apply(this,arguments)}),onCommentClick:(We=Ge(c.a.mark(function t(){var e=this;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.showCommentPanelData?Object(h.d)(y.d.CARD_COMMENT_0,Object.assign(k(this.cardInfo),this.isGuestPage?{nologin:1}:{})):Object(h.d)(y.d.CARD_COMMENT_1,Object.assign(k(this.cardInfo),this.isGuestPage?{nologin:1}:{})),!this.isGuestPage){t.next=7;break}return t.next=4,Object(m.i)(function(){e.ifJumpAfterLogin?(Object(h.d)(y.d.LOGIN_SUCCESS,{from:e.spmPageTypeString}),window.location.replace("https://t.bilibili.com/".concat(e.cardInfo.desc.dynamic_id,"?tab=2"))):window.location.reload()});case 4:if(t.sent){t.next=7;break}return t.abrupt("return");case 7:this.showCommentPanelData=!this.showCommentPanelData,this.showForwardingPanelData=!1,this.hasInitComment||this.initCommentComponent();case 10:case"end":return t.stop()}},t,this)})),function(){return We.apply(this,arguments)}),onPraiseClick:(Je=Ge(c.a.mark(function t(){var e,n=this;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(e=1===this.isLoved)?Object(h.d)(y.d.CARD_LIKE_0,k(this.cardInfo)):Object(h.d)(y.d.CARD_LIKE_1,Object.assign(k(this.cardInfo),this.isGuestPage?{nologin:1}:{})),t.next=4,Object(m.i)(function(){n.ifJumpAfterLogin?(Object(h.d)(y.d.LOGIN_SUCCESS,{from:n.spmPageTypeString}),window.location.replace("https://t.bilibili.com/".concat(n.cardInfo.desc.dynamic_id))):window.location.reload()});case 4:if(t.sent){t.next=7;break}return t.abrupt("return");case 7:this.bpapi({method:"post",url:O.a.API_VC+"/dynamic_like/v1/dynamic_like/thumb",data:{uid:this.uid,dynamic_id:this.cardInfo.desc.dynamic_id,up:e?2:1}}).then(function(t){e?(n.cardInfo.desc.like=n.cardInfo.desc.like-1,n.isLovedTemp=0,n.isHotTab&&n.uid&&n.bpapi({method:"post",url:"".concat(O.a.API_VC,"/dynamic_report/v1/dynamic_report/rcmd_report"),data:{report_type:2,uid:n.uid,dynamic_id:n.cardInfo.desc.dynamic_id,count:-1}})):(n.loveAnimationUrl?n.svgaPlayerShown=!0:(n.cardInfo.desc.like=n.cardInfo.desc.like+1,n.isLovedTemp=1,n.linkMsg(n.$refs.praiseBtn,"点赞成功",t.type)),n.isHotTab&&n.uid&&n.bpapi({method:"post",url:"".concat(O.a.API_VC,"/dynamic_report/v1/dynamic_report/rcmd_report"),data:{report_type:2,uid:n.uid,dynamic_id:n.cardInfo.desc.dynamic_id,count:1}})),f.b.$emit(y.b.STORAGE_UPDATE,n.cardInfo)},function(t){n.linkMsg(n.$refs.praiseBtn,t.msg,t.type)});case 8:case"end":return t.stop()}},t,this)})),function(){return Je.apply(this,arguments)}),editDraft:function(){Object(h.d)(y.d.TIMER_EDIT,""),this.$emit("edit-draft")},sendDraft:function(){var t=this;Object(h.d)(y.d.TIMER_PUBLISH,""),this.bpapi({method:"post",url:"".concat(O.a.API_VC,"/dynamic_draft/v1/dynamic_draft/publish_now"),data:{draft_id:this.cardInfo.desc.draft_id},throttleInterval:5e3}).then(function(e){t.linkMsg(t.$refs.sendNowBtn,"发送成功",e.type),t.delete()},function(e){t.linkMsg(t.$refs.sendNowBtn,e.msg,e.type)})},deleteDraft:function(){var t=this;Object(h.d)(y.d.TIMER_DELETE,""),this.bpPopup({title:"删除动态",content:"确认删除此定时发布的动态吗？",button:{confirm:"删除",cancel:"我点错了"}}).onConfirm(function(e){t.bpapi({method:"post",url:"".concat(O.a.API_VC,"/dynamic_draft/v1/dynamic_draft/rm_draft"),data:{draft_id:t.cardInfo.desc.draft_id},throttleInterval:5e3}).then(function(n){t.linkMsg(e.confirmBtn,"删除成功",n.type),e.close(),t.delete()},function(n){t.linkMsg(e.confirmBtn,n.msg,n.type)})}).onCancel(function(t){t.close()})},initBus:function(){var t=this,e=function(){var e=window.innerHeight;if(t.lazyLoaded=t.isInViewport(e),t.isInViewport(e)&&!t.isShowLog&&t.lazyLoaded){var n=[],i=k(t.cardInfo);(t.cardData.hasLottery||t.originCardData.hasLottery)&&n.push("lottery_retweet"),(t.cardData.hasVote||t.originCardData.hasVote)&&n.push("poll");var o=n.join(","),r=Object.assign({like_show_area:t.likeUsersPanelShow?1:0},i,t.isGuestPage?{nologin:1}:{});if(o&&(r=Object.assign(r,{card_content:o})),t.isTagPage&&(r=Object.assign(r,{tagname:t.topicName})),t.cardInfo.desc.dynamic_id&&"-1"!==t.cardInfo.desc.dynamic_id){if(Object(h.d)(y.d.CARD_SHOW,r),t.cardInfo.desc.type===y.a.REPOST){var a=S(t.cardInfo);Object(h.d)(y.d.CARD_SHOW,Object.assign(r,a))}t.isHotTab&&t.uid&&t.bpapi({method:"post",url:"".concat(O.a.API_VC,"/dynamic_report/v1/dynamic_report/rcmd_report"),data:{report_type:1,uid:t.uid,dynamic_id:t.cardInfo.desc.dynamic_id}})}t.isShowLog=!0}};f.b.$on(y.b.SCROLL,e),f.b.$on(y.b.SET_TOP,function(e){e===t.cardInfo.desc.dynamic_id&&(t.currentTop=t.$el.getBoundingClientRect().top)}),f.b.$on(y.b.LOCATE_CARD_EL,function(e){e===t.cardInfo.desc.dynamic_id&&(document.documentElement.scrollTop=Object(f.j)(t.$el)-t.currentTop)}),f.b.$on(y.b.UNFOCUS,this.unfocusHandler),f.b.$on(y.b.STORAGE_UPDATE,this.storageUpdateHandler),f.b.$on(y.b.MORE_PANEL_CLOSE,this.morePanelClose),f.b.$on(y.b.LOAD_NOTICE,this.updatePublishTime),f.b.$on(y.b.REMOVE_SCROLL,function(){f.b.$off(y.b.SCROLL,e),b(t.scrollContainer,"scroll",t.scrollHandler)}),(this.isHotTab||this.isTagPage)&&f.b.$on(y.b.ATTENTION_LIST_UPDATE,function(){t.attentionList=f.t.getMyAttentionList(),t.isUnfocus=-1===t.attentionList.indexOf(t.cardInfo.desc.uid)})},delete:function(){var t=this;y.e.forEach(function(e){e.type!==y.a.ALL&&e.type!==t.cardInfo.desc.type||f.s.delete("dynamic_cards_".concat(t.uid,"_").concat(e.type),t.cardInfo)}),this.$emit("delete",this.cardInfo)},getNewDate:function(){return new Date},storageUpdateHandler:function(t){var e=this;this.cardInfo.desc.dynamic_id===t.desc.dynamic_id&&y.e.forEach(function(n){n.type!==y.a.ALL&&n.type!==t.desc.type||f.s.replace("dynamic_cards_".concat(e.uid,"_").concat(n.type),t)})},updatePublishTime:function(){this.date=this.getNewDate()},onWrapperClick:function(t){f.b.$emit(y.b.IFRAME_WRAPPER_CLICK,t,this.cardInfo.desc.dynamic_id)},onUnfold:function(){Object(h.d)(y.d.FOLD_CLICK,this.cardInfo.foldType),this.$emit("unfold",{index:this.idx,ids:this.cardInfo.allIds||[]})},getFoldUserAvatarStyle:function(t){var e=t.face||"//static.hdslb.com/images/member/noface.gif";return{backgroundImage:"url(".concat(Object(m.a)(e,30,30).replace(/^http:/,""),")")}},onSvgaStart:function(){var t=this;setTimeout(function(){t.svgaPlayerStart=!0},0)},onSvgaFinish:function(){this.svgaPlayerShown=!1,this.svgaPlayerStart=!1,this.cardInfo.desc.like=this.cardInfo.desc.like+1,this.isLovedTemp=1,this.linkMsg(this.$refs.praiseBtn,"点赞成功","success")}},computed:{isRealSelf:function(){return this.cardInfo.desc.type===y.a.CHEESE_SERIES||this.cardInfo.desc.type===y.a.CHEESE_UPDATE?this.uid===this.cardData.uid:this.isSelf},isShowCard:function(){return this.disableLazyLoad||this.lazyLoaded},isShowButtonBar:function(){return this.cardData.comment_id>0&&!this.isDraft},cardData:function(){return this.canRender?function(t){var e={name_url:"",name:"",detail_url:"",face:"//static.hdslb.com/images/member/noface.gif",comment_count:0,detail_comment_url:"",more_comment_url:"",more_forw_url:"".concat(O.a.T,"/").concat(t.desc.dynamic_id,"?tab=1"),comment_id:0,comment_oid:0,hasVote:!1,hasLottery:!1,isSetTop:!1},n=Object(d.e)(t.card),i={},o={},r=Object(m.f)(t.desc.rid,t.desc.bvid||t.desc.origin&&t.desc.origin.bvid);switch(t.extra&&(e.isSetTop=1==t.extra.is_space_top),t.desc.type){case y.a.REPOST:e.name_url="".concat(O.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(O.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face,e.comment_count=n.item.reply,e.more_comment_url="".concat(O.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.comment_id=17,e.comment_oid="".concat(t.desc.dynamic_id),o=P(n.item.ctrl,t.extend_json),e.hasVote=o.hasVote,e.hasLottery=o.hasLottery,e.riskTip=o.riskTip;break;case y.a.PIC:e.name_url="".concat(O.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(O.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face,e.comment_count=n.item.reply,e.detail_comment_url="".concat(O.a.T,"/").concat(t.desc.orig_dy_id||t.desc.dynamic_id,"?tab=2"),e.more_comment_url="".concat(O.a.T,"/").concat(t.desc.orig_dy_id||t.desc.dynamic_id,"?tab=2"),e.comment_id=11,e.comment_oid="".concat(n.item.id),o=P(n.item.at_control,t.extend_json),e.hasVote=o.hasVote,e.hasLottery=o.hasLottery,e.riskTip=o.riskTip;break;case y.a.WORD:e.name_url="".concat(O.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(O.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face,e.comment_count=n.item.reply,e.more_comment_url="".concat(O.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.comment_id=17,e.comment_oid="".concat(t.desc.dynamic_id),o=P(n.item.ctrl,t.extend_json),e.hasVote=o.hasVote,e.hasLottery=o.hasLottery,e.riskTip=o.riskTip;break;case y.a.VIDEO:e.name_url="".concat(O.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(O.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face,e.comment_count=n.stat.reply,e.detail_comment_url=r,e.more_comment_url=r,e.comment_id=1,e.comment_oid="".concat(n.aid),e.needPay=n.rights&&!!n.rights.ugc_pay,e.isCooperation=n.rights&&!!n.rights.is_cooperation,o=P(n.ctrl,t.extend_json),e.hasLottery=o.hasLottery,e.riskTip=o.riskTip;break;case y.a.CHEESE_SERIES:case y.a.CHEESE_UPDATE:e.name_url="".concat(O.a.SPACE,"/").concat(n.up_id,"/dynamic"),e.uid=n.up_id,e.name=n.up_info.name,e.detail_url="".concat(O.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=n.up_info.avatar,e.comment_count=n.new_ep?n.new_ep.reply:0,e.detail_comment_url=n.url,e.more_comment_url=n.url,e.comment_id=33,e.comment_oid=n.new_ep?"".concat(n.new_ep.id):0,o=P(n.ctrl,t.extend_json),e.riskTip=o.riskTip;break;case y.a.CLIP:e.name_url="".concat(O.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(O.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face,e.comment_count=n.item.reply,e.detail_comment_url="".concat(O.a.VC,"/video/").concat(n.item.id),e.more_comment_url="".concat(O.a.VC,"/video/").concat(n.item.id),e.comment_id=5,e.comment_oid="".concat(n.item.id),o=P(n.item.at_control,t.extend_json),e.hasVote=o.hasVote,e.hasLottery=o.hasLottery,e.riskTip=o.riskTip;break;case y.a.ARTICLE:e.name_url="".concat(O.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(O.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face,e.comment_count=n.stats.reply,e.detail_comment_url="".concat(O.a.MAIN,"/read/cv").concat(n.id),e.more_comment_url="".concat(O.a.MAIN,"/read/cv").concat(n.id),e.comment_id=12,e.comment_oid="".concat(n.id),o=P(n.ctrl,t.extend_json),e.riskTip=o.riskTip;break;case y.a.MUSIC:e.name_url="".concat(O.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(O.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face,e.comment_count=n.replyCnt,e.detail_comment_url="".concat(O.a.MAIN,"/audio/au").concat(n.id,"?type=7"),e.more_comment_url="".concat(O.a.MAIN,"/audio/au").concat(n.id,"?type=7"),e.comment_id=14,e.comment_oid="".concat(n.id),o=P(n.ctrl,t.extend_json),e.riskTip=o.riskTip;break;case y.a.BANGUMI:case y.a.PGC_BANGUMI:case y.a.GUOCHUANG:i=n.apiSeasonInfo||n.season||{},e.name_url="".concat(O.a.BANGUMI,"/anime/").concat(t.desc.uid),e.name=i.title,e.face=i.cover,e.comment_count=n.reply_count,e.detail_comment_url=n.url,e.more_comment_url=n.url,e.comment_id=1,e.comment_oid="".concat(n.aid),4===i.bgm_type?(e.bangumi_desc="国创",e.tags=[{name:"国创"}]):(e.bangumi_desc="番剧",e.bangumi_url="".concat(O.a.BANGUMI,"/anime/timeline"),e.tags=[{name:"番剧"}]),o=P(n.ctrl,t.extend_json),e.riskTip=o.riskTip;break;case y.a.COMIC_SHARE:case y.a.H5_SHARE:e.name_url="".concat(O.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(O.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face,e.comment_count=t.desc.comment,e.more_comment_url="".concat(O.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.comment_id=17,e.comment_oid="".concat(t.desc.dynamic_id),o=P(n.ctrl,t.extend_json),e.riskTip=o.riskTip;break;case y.a.FILM:e.name_url="".concat(O.a.BANGUMI,"/anime/").concat(t.desc.uid),e.name=n.apiSeasonInfo.title,e.face=n.cover,e.comment_count=n.reply_count,e.detail_comment_url=n.url,e.more_comment_url=n.url,e.comment_id=1,e.comment_oid="".concat(n.aid),e.bangumi_desc="电影",e.tags=[{name:"电影"}],o=P(n.ctrl,t.extend_json),e.riskTip=o.riskTip;break;case y.a.TV:i=n.apiSeasonInfo||n.season||{},e.name_url="".concat(O.a.BANGUMI,"/anime/").concat(t.desc.uid),e.name=i.title,e.face=n.cover,e.comment_count=n.reply_count,e.detail_comment_url=n.url,e.more_comment_url=n.url,e.comment_id=1,e.comment_oid="".concat(n.aid),e.bangumi_desc=i.type_name||"电视剧",e.tags=[{name:i.type_name||"电视剧"}],o=P(n.ctrl,t.extend_json),e.riskTip=o.riskTip;break;case y.a.DOCUMENTARY:i=n.apiSeasonInfo||n.season||{},e.name_url="".concat(O.a.BANGUMI,"/anime/").concat(t.desc.uid),e.name=i.title,e.face=i.cover||n.cover,e.comment_count=n.reply_count,e.detail_comment_url=n.url,e.more_comment_url=n.url,e.comment_id=1,e.comment_oid="".concat(n.aid),"26484"===String(i.season_id)||"26481"===String(i.season_id)?e.bangumi_desc="":(e.bangumi_desc="纪录片",e.tags=[{name:"纪录片"}]),o=P(n.ctrl,t.extend_json),e.riskTip=o.riskTip;break;case y.a.LIVE:case y.a.LIVE_ROOM:e.name_url="".concat(O.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(O.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face,e.comment_count=t.desc.comment,e.more_comment_url="".concat(O.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.comment_id=17,e.comment_oid="".concat(t.desc.dynamic_id),o=P(n.ctrl,t.extend_json),e.riskTip=o.riskTip;break;default:t.desc.user_profile?(e.name_url="".concat(O.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(O.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face):e.name="未知",o=P(n.ctrl,t.extend_json),e.riskTip=o.riskTip}return e}(this.cardInfo):{}},originCardData:function(){return T(this.cardInfo)},uid:function(){return f.t.getMyLoginInfo().isLogin?f.t.getMyLoginInfo().mid:0},card:function(){return Object(d.e)(this.cardInfo.card)},isHotTab:function(){return this.currentType===y.a.HOT},cardStyle:function(){return{"min-height":this.lazyLoaded?"":"150px","margin-top":0!==this.idx||this.isDetailPage?"8px":"0",border:this.isGamePage&&0===this.idx||this.isMainPage?"":"1px solid #eee"}},showForwardingPanel:function(){return 1===this.defaultTab&&!this.showCommentPanelData&&!this.isDeletedDyn||this.showForwardingPanelData},showCommentPanel:function(){return 2===this.defaultTab&&!this.showForwardingPanelData||this.showCommentPanelData},isDeletedDyn:function(){var t=this.cardInfo.desc.type===y.a.REPOST?this.card.item.orig_type:this.cardInfo.desc.type;return y.a.NONE===t},isCheeseSeries:function(){var t=this.cardInfo.desc.type===y.a.REPOST?this.card.item.orig_type:this.cardInfo.desc.type;return y.a.CHEESE_SERIES===t},isCheeseUpdate:function(){var t=this.cardInfo.desc.type===y.a.REPOST?this.card.item.orig_type:this.cardInfo.desc.type;return y.a.CHEESE_UPDATE===t},userHead:function(){return Object(m.a)(Object(d.g)(this.cardData.face),48,48)},isDetailPage:function(){return this.pageType===y.c.DETAIL},isMainPage:function(){return this.pageType===y.c.MAIN},isSpacePage:function(){return this.pageType===y.c.SPACE},isTagPage:function(){return this.pageType===y.c.TAG},isGamePage:function(){return this.pageType===y.c.GAME},isGuestPage:function(){return this.pageType===y.c.GUEST},isLivePage:function(){return this.pageType===y.c.LIVE},setTopText:function(){return this.cardData.isSetTop?"取消置顶":"置顶"},attentionText:function(){return this.isUnfocus?"关注":"取消关注"},spmPageTypeString:function(){return this.isGuestPage?"nologin":this.isDetailPage?"dt":this.isSpacePage?"space":this.isTagPage?"topic":this.isLivePage?"live":""},isPersonalIdentity:function(){return this.cardInfo.desc&&this.cardInfo.desc.user_profile&&this.cardInfo.desc.user_profile.card&&this.cardInfo.desc.user_profile.card.official_verify&&0===this.cardInfo.desc.user_profile.card.official_verify.type},isCompanyIdentity:function(){return this.cardInfo.desc&&this.cardInfo.desc.user_profile&&this.cardInfo.desc.user_profile.card&&this.cardInfo.desc.user_profile.card.official_verify&&1===this.cardInfo.desc.user_profile.card.official_verify.type},isBigVip:function(){return this.cardInfo.desc.user_profile&&this.cardInfo.desc.user_profile.vip&&this.cardInfo.desc.user_profile.vip.vipType>0&&1===this.cardInfo.desc.user_profile.vip.vipStatus},userDecoratorStyle:function(){var t=this.cardInfo.desc.user_profile;return t&&t.pendant&&t.pendant.image?"background-image: url(".concat(t.pendant.image.replace(/^http?:/,""),");"):""},isBigCardDecorator:function(){var t=this.cardInfo.desc.user_profile;return!(!t||!t.decorate_card)&&!!(t.decorate_card.card_url&&t.decorate_card.fan&&t.decorate_card.fan.is_fan&&3===t.decorate_card.item_type)},fansCardNumText:function(){if(!this.isBigCardDecorator)return"";var t=this.cardInfo.desc.user_profile.decorate_card.fan.number;return this.cardInfo.desc.user_profile.decorate_card.fan.num_desc||""||"000000".concat(t).substring(String(t).length)},fansCardTextColorStyle:function(){if(!this.isBigCardDecorator)return"";var t=this.cardInfo.desc.user_profile.decorate_card.fan.color;return"color: ".concat(t,";")},cardDecoratorStyle:function(){var t=this.cardInfo.desc.user_profile;if(!t||!t.decorate_card||!t.decorate_card.card_url)return"";var e="";this.showFocusButton&&(e="right: 107px;"),this.isBigCardDecorator&&(e="".concat(e," width: 146px; height: 44px;"));var n=t.decorate_card.card_url;return"background-image: url(".concat(n.replace(/^http?:/,""),"); ").concat(e,";")},cardDecoratorTitle:function(){var t=this.cardInfo.desc.user_profile;return t&&t.decorate_card&&t.decorate_card.name?t.decorate_card.name:""},showFocusButton:function(){return(this.isHotTab||this.isTagPage)&&!this.isRealSelf&&!this.isCheeseUpdate},showSetTopButton:function(){return this.isSelf&&this.pageType==y.c.SPACE},showMoreButton:function(){return(this.showDeleteButton||this.showAttentionButton||this.showReportButton||this.showSetTopButton)&&!this.isDraft},showDeleteButton:function(){var t=this.cardInfo.desc.type;return this.isRealSelf&&!this.isHotTab&&(t===y.a.REPOST||t===y.a.WORD||t===y.a.PIC||t===y.a.H5_SHARE||t===y.a.CLIP||t===y.a.COMIC_SHARE)},showAttentionButton:function(){return!(this.isRealSelf||this.isHotTab||this.pageType!==y.c.MAIN||this.isBangumiLike||this.showFocusButton||this.isCheeseUpdate)},showReportButton:function(){var t=this.cardInfo.desc.type;return!this.isRealSelf&&-1===[y.a.DRAMA,y.a.BANGUMI,y.a.PGC_BANGUMI,y.a.FILM,y.a.TV,y.a.GUOCHUANG,y.a.DOCUMENTARY,y.a.HOT].indexOf(t)},disabledDraftButton:function(){return 1===this.cardInfo.desc.draft_status},publishTime:function(){var t=this.date,e=Object(f.f)(t,"yyyy-MM-dd"),n=t.getTime(),i=1e3*this.cardInfo.desc.timestamp,o=new Date(i);if(this.isDraft)return Object(f.f)(o,"yyyy-MM-dd")===e?"今天 "+Object(f.f)(o,"hh:mm"):Object(f.f)(o,"MM-dd hh:mm");var r=n-i,a=Math.floor(r/6e4),s=Math.floor(a/60),c=new Date(e+" 00:00:00").getTime()-864e5,u=new Date(Object(f.f)(t,"yyyy")+"-01-01").getTime();return s<1&&a<=1?"刚刚":s<1&&a>1&&a<60?"".concat(a," 分钟前"):s>=1&&s<24?"".concat(s," 小时前"):i>=c?"昨天 "+Object(f.f)(o,"hh:mm"):i>=u?Object(f.f)(o,"MM-dd"):Object(f.f)(o,"yyyy-MM-dd")},isBangumi:function(){return-1!==[y.a.BANGUMI,y.a.PGC_BANGUMI].indexOf(this.cardInfo.desc.type)},isBangumiLike:function(){return-1!==[y.a.FILM,y.a.TV,y.a.DOCUMENTARY,y.a.BANGUMI,y.a.PGC_BANGUMI,y.a.GUOCHUANG].indexOf(this.cardInfo.desc.type)},isFakeCard:function(){return this.cardInfo.desc.dynamic_id<0},focusButtonStyle:function(){return this.showMoreButton?"right: 48px":"right: 16px"},morePanelStyle:function(){return this.isTagPage?"right: -9px":"right: 5px"},showFoldUsers:function(){return 2===this.cardInfo.foldType},foldAllIds:function(){return this.cardInfo.allIds},foldUserList:function(){var t=this,e={},n=[];return this.foldAllIds.forEach(function(n){var i=t.foldItems[n].desc.user_profile;e[i.info.uid]=i}),Object.keys(e).forEach(function(t){n.push(e[t])}),n},showFoldUserInfoList:function(){var t=this.foldUserList.slice(0,4),e=[];return t.forEach(function(t){e.push(t.info)}),e},foldText:function(){var t="",e=this.foldAllIds;switch(this.cardInfo.foldType){case 1:e.length>1&&(t="展开".concat(e.length-1,"条相关动态"));break;case 2:var n=this.showFoldUserInfoList.length;t=n>1?"等".concat(n,"人转发了此动态"):"转发了此动态";break;case 3:t="展开".concat(e.length-1,"条相关动态")}return t},isLoved:function(){return this.isLovedTemp>-1?this.isLovedTemp:this.cardInfo.desc.is_liked},extendJsonLikeIcon:function(){return Object(d.e)(this.cardInfo.extend_json).like_icon||{}},notLovedIconUrl:function(){return this.extendJsonLikeIcon.start_url||""},lovedIconUrl:function(){return this.extendJsonLikeIcon.end_url||""},loveAnimationUrl:function(){return this.extendJsonLikeIcon.action_url||""},customLikeIconStaticStyle:function(){return this.isPraiseHover?this.lovedIconUrl?"background-image: url(".concat(this.lovedIconUrl,");"):"":this.isLoved?this.lovedIconUrl?"background-image: url(".concat(this.lovedIconUrl,");"):"":this.notLovedIconUrl?"background-image: url(".concat(this.notLovedIconUrl,");"):""},likeUsersPanelShow:function(){return this.cardInfo.display&&this.cardInfo.display.like_info&&this.cardInfo.display.like_info.like_users&&this.cardInfo.display.like_info.like_users.length>0}}},Xe=(n(391),n(392),Object(K.a)(Qe,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"card",staticClass:"card",class:{"chrome-scale-1-1":t.chromeScaleFix},style:t.cardStyle,attrs:{"data-did":t.cardInfo.desc.dynamic_id},on:{click:t.onWrapperClick,mouseenter:t.inThisCard,mouseleave:t.outThisCard}},[t.isShowCard?n("a",{ref:"userhead",staticClass:"user-head c-pointer",style:{backgroundImage:"url("+t.userHead+")","border-radius":t.isBangumiLike?"12px":"50%"},attrs:{href:t.cardData.name_url,target:"_blank"},on:{click:t.clickHeadLog}},[t.userDecoratorStyle?n("div",{staticClass:"user-decorator",style:t.userDecoratorStyle}):t._e(),t.isPersonalIdentity?n("i",{staticClass:"verify-icon verify-personal"}):t._e(),t.isCompanyIdentity?n("i",{staticClass:"verify-icon verify-company"}):t._e(),!t.isBigVip||t.isPersonalIdentity||t.isCompanyIdentity?t._e():n("i",{staticClass:"verify-icon big-vip"})]):t._e(),t.isShowCard?t._e():n("card-skeleton"),t.isShowCard&&t.canRender?n("div",{staticClass:"main-content",style:{"padding-bottom":t.isShowButtonBar?"0":"24px"}},[t.isBangumiLike&&t.cardData.bangumi_desc?[t.cardData.bangumi_url?n("a",{staticClass:"d-i-block type-label c-pointer",attrs:{href:t.cardData.bangumi_url,target:"_blank"}},[t._v(t._s(t.cardData.bangumi_desc))]):n("div",{staticClass:"d-i-block type-label c-default"},[t._v(t._s(t.cardData.bangumi_desc))])]:t._e(),n("div",{staticClass:"user-name fs-16 ls-0 d-i-block",class:{"big-vip":t.isBigVip}},[n("a",{ref:"username",staticClass:"c-pointer",attrs:{href:t.cardData.name_url,target:"_blank"},on:{click:t.clickNameLog}},[t._v(t._s(t.cardData.name))])]),n("div",{staticClass:"time fs-12 ls-0 tc-slate"},[t.isBangumiLike||t.isDetailPage||t.isFakeCard?n("span",[t._v(t._s(t.publishTime))]):n("a",{staticClass:"detail-link tc-slate",attrs:{href:t.cardData.detail_url,target:"_blank"}},[t._v(t._s(t.publishTime))]),n("span",[t._v(t._s(t.isBangumiLike?" 更新了":""))])]),n("card-content",{ref:"cardContent",attrs:{"card-info":t.cardInfo,"card-data":t.cardData,"is-fake":t.isFakeCard,"my-uid":t.uid,"is-detail":t.isDetailPage,"current-type":t.currentType,"popup-dom":t.popupDom,"is-guest":t.isGuestPage,"spm-page-type-string":t.spmPageTypeString}}),t.isDraft&&t.cardInfo.desc.error_msg?n("div",{staticClass:"error-msg fs-14 ls-0"},[n("i",{staticClass:"icon-error"},[t._v("​")]),t._v("定时发布失败，"+t._s(t.cardInfo.desc.error_msg))]):t._e(),!t.isFakeCard&&t.isShowButtonBar?n("div",{staticClass:"button-bar tc-slate"},[n("div",{staticClass:"single-button c-pointer",on:{click:t.onTransmitClick,mouseenter:t.onTransmitHover,mouseleave:t.onTransmitLeave}},[n("span",{staticClass:"text-bar",class:{selected:t.showForwardingPanel||t.isTransmitHover}},[n("i",{staticClass:"bp-svg-icon single-icon",class:{transmit:!t.showForwardingPanel,"transmit-hover":t.showForwardingPanel||t.isTransmitHover}}),n("span",{ref:"transmitRef",staticClass:"text-offset"},[t._v(t._s(t.cardInfo.desc.repost?t.numberFormat(t.cardInfo.desc.repost):"转发"))])])]),n("div",{staticClass:"single-button c-pointer",on:{click:t.onCommentClick,mouseenter:t.onCommentHover,mouseleave:t.onCommentLeave}},[n("span",{staticClass:"text-bar",class:{selected:t.showCommentPanel||t.isCommentHover}},[n("i",{staticClass:"bp-svg-icon single-icon",class:{comment:!t.showCommentPanel,"comment-hover":t.showCommentPanel||t.isCommentHover}}),n("span",{staticClass:"text-offset"},[t._v(t._s(t.cardData.comment_count?t.numberFormat(t.cardData.comment_count):"评论"))])])]),n("div",{ref:"praiseBtn",staticClass:"single-button c-pointer p-rel",on:{click:t.onPraiseClick,mouseenter:t.onPraiseHover,mouseleave:t.onPraiseLeave}},[n("span",{staticClass:"text-bar",class:{selected:1===t.isLoved||t.isPraiseHover}},[t.customLikeIconStaticStyle?t._e():n("i",{staticClass:"custom-like-icon",class:{zan:!t.isLoved,"zan-hover":1===t.isLoved,"zan-a-hover":t.isPraiseHover,"icon-hidden":t.svgaPlayerStart}}),t.customLikeIconStaticStyle?n("i",{staticClass:"custom-like-icon",class:{"icon-hidden":t.svgaPlayerShown},style:t.customLikeIconStaticStyle}):t._e(),n("span",{staticClass:"text-offset"},[t._v(t._s(t.cardInfo.desc.like<1?"赞":t.numberFormat(t.cardInfo.desc.like)))])]),t.svgaPlayerShown?n("svga-player",{staticClass:"svga-position",attrs:{src:t.loveAnimationUrl,id:"svga-"+t.cardInfo.desc.dynamic_id},on:{start:t.onSvgaStart,finish:t.onSvgaFinish}}):t._e()],1)]):t._e(),t.isFakeCard&&!t.isDraft?n("div",{staticClass:"button-bar tc-slate"},[t._m(0),t._m(1),t._m(2)]):t._e()],2):t._e(),t.cardDecoratorStyle?n("div",{staticClass:"card-decorator",style:t.cardDecoratorStyle,attrs:{title:t.cardDecoratorTitle}},[t.isBigCardDecorator?n("div",{staticClass:"fans-card-text",style:t.fansCardTextColorStyle},[t._v(t._s(t.fansCardNumText))]):t._e()]):t._e(),t.showFocusButton&&t.isShowCard?n("div",{staticClass:"focus-btn p-abs c-pointer",style:t.focusButtonStyle,on:{click:t.onUnfocusClick}},[t.isUnfocus?n("div",{staticClass:"unfocus t-center w-100 h-100"},[n("p",{staticClass:"unfocus-text fs-14"},[t._v("+ 关注")])]):n("div",{staticClass:"focus t-center w-100 h-100"},[n("p",{staticClass:"focus-text fs-14"},[t._v("已关注")])])]):t._e(),t.showMoreButton?[n("div",{ref:"buttonArea",staticClass:"button-area c-pointer"},[n("div",{staticClass:"more-button bp-icon-font icon-more-1"})]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showMorePanel,expression:"showMorePanel"}],ref:"morePanel",staticClass:"more-panel fs-14 ls-0",style:t.morePanelStyle},[t.showSetTopButton?n("p",{ref:"setTopRef",staticClass:"child-button c-pointer",on:{click:t.onSetTopClick}},[t._v(t._s(t.setTopText))]):t._e(),t.showDeleteButton?n("p",{ref:"deleteRef",staticClass:"child-button c-pointer",on:{click:t.onDeleteClick}},[t._v("删除")]):t._e(),t.showAttentionButton?n("p",{staticClass:"child-button c-pointer",on:{click:t.onUnfocusClick}},[t._v(t._s(t.attentionText))]):t._e(),t.showReportButton?n("p",{ref:"reportRef",staticClass:"child-button c-pointer",on:{click:t.onReportClick}},[t._v("举报")]):t._e()])]:t._e(),t.isDraft?[n("div",{staticClass:"button-group fs-12 ls-0 t-center"},[n("p",{staticClass:"draft-button",on:{click:t.editDraft}},[t._v("编辑")]),n("p",{ref:"sendNowBtn",staticClass:"draft-button",on:{click:t.sendDraft}},[t._v(t._s(t.disabledDraftButton?"发送中":"立即发送"))]),n("p",{staticClass:"draft-button",on:{click:t.deleteDraft}},[t._v("删除")]),t.disabledDraftButton?n("div",{staticClass:"disabled"}):t._e()])]:t._e(),n("report-popup",{attrs:{show:t.reportPopupShow,"object-id":t.reportDid,"accused-uid":t.reportUid},on:{success:t.onReportSucess,cancel:t.onReportCancel}}),t.showForwardingPanel&&!t.isFakeCard?n("div",{staticClass:"panel-area"},[n("forwarding",{attrs:{"page-type":t.pageType,"feed-current-type":t.currentType,"card-info":t.cardInfo,"card-data":t.cardData}})],1):t._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showCommentPanel&&!t.isFakeCard,expression:"showCommentPanel && !isFakeCard"}],ref:"bbcomment",staticClass:"panel-area"}),t.foldText?n("div",{staticClass:"fold-box"},[n("div",{staticClass:"fold-hoverable",on:{click:t.onUnfold}},[t.showFoldUsers?n("div",{staticClass:"fold-users"},t._l(t.showFoldUserInfoList,function(e){return n("div",{staticClass:"fold-user-avatar",style:t.getFoldUserAvatarStyle(e),attrs:{title:e.uname}})}),0):t._e(),n("span",{staticClass:"fold-text"},[t._v(t._s(t.foldText))]),n("span",{staticClass:"fold-arrow"})])]):t._e()],2)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"single-button"},[e("i",{staticClass:"bp-svg-icon transmit-disable single-icon"}),e("span",[this._v("--")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"single-button"},[e("i",{staticClass:"bp-svg-icon comment-disable single-icon"}),e("span",[this._v("--")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"single-button"},[e("i",{staticClass:"bp-svg-icon zan-disable single-icon"}),e("span",[this._v("--")])])}],!1,null,"62336402",null).exports);n(393);o.a.use(Object(r.a)()),o.a.use(a.a),o.a.use(mt.b);e.a=Xe},,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i=n(78);n.n(i).a},function(t,e,n){"use strict";var i=n(79);n.n(i).a},function(t,e,n){"use strict";var i=n(80);n.n(i).a},function(t,e,n){},function(t,e,n){t.exports=n.p+"static/img/auth.fb6a43d9.png"},,function(t,e,n){"use strict";var i=n(81);n.n(i).a},function(t,e,n){"use strict";var i=n(82);n.n(i).a},function(t,e,n){},function(t,e,n){"use strict";var i=n(83);n.n(i).a},function(t,e,n){"use strict";var i=n(84);n.n(i).a},function(t,e,n){"use strict";var i=n(85);n.n(i).a},function(t,e,n){"use strict";var i=n(86);n.n(i).a},function(t,e,n){"use strict";var i=n(87);n.n(i).a},function(t,e,n){"use strict";var i=n(88);n.n(i).a},function(t,e,n){},function(t,e,n){"use strict";var i=n(89);n.n(i).a},function(t,e,n){"use strict";var i=n(90);n.n(i).a},function(t,e,n){"use strict";var i=n(91);n.n(i).a},function(t,e,n){"use strict";var i=n(92);n.n(i).a},function(t,e,n){"use strict";var i=n(93);n.n(i).a},function(t,e,n){"use strict";var i=n(94);n.n(i).a},function(t,e,n){"use strict";var i=n(95);n.n(i).a},function(t,e,n){"use strict";var i=n(96);n.n(i).a},function(t,e,n){"use strict";var i=n(97);n.n(i).a},function(t,e,n){"use strict";var i=n(98);n.n(i).a},function(t,e,n){"use strict";var i=n(99);n.n(i).a},function(t,e,n){"use strict";var i=n(100);n.n(i).a},function(t,e,n){"use strict";var i=n(101);n.n(i).a},function(t,e,n){},function(t,e,n){"use strict";var i=n(102);n.n(i).a},function(t,e,n){"use strict";var i=n(103);n.n(i).a},function(t,e,n){"use strict";var i=n(104);n.n(i).a},function(t,e,n){"use strict";var i=n(105);n.n(i).a},function(t,e,n){"use strict";var i=n(106);n.n(i).a},function(t,e,n){"use strict";var i=n(107);n.n(i).a},function(t,e,n){"use strict";var i=n(108);n.n(i).a},function(t,e,n){"use strict";var i=n(109);n.n(i).a},function(t,e,n){"use strict";var i=n(110);n.n(i).a},function(t,e,n){},function(t,e,n){"use strict";var i=n(111);n.n(i).a},function(t,e,n){"use strict";var i=n(112);n.n(i).a},function(t,e,n){"use strict";var i=n(113);n.n(i).a},function(t,e,n){"use strict";var i=n(114);n.n(i).a},function(t,e,n){"use strict";var i=n(115);n.n(i).a},function(t,e,n){"use strict";var i=n(116);n.n(i).a},function(t,e,n){"use strict";var i=n(117);n.n(i).a},function(t,e,n){"use strict";var i=n(118);n.n(i).a},function(t,e,n){"use strict";var i=n(119);n.n(i).a},function(t,e,n){"use strict";var i=n(120);n.n(i).a},function(t,e,n){"use strict";var i=n(121);n.n(i).a},function(t,e,n){"use strict";var i=n(122);n.n(i).a},function(t,e,n){"use strict";var i=n(123);n.n(i).a},function(t,e,n){"use strict";var i=n(124);n.n(i).a},function(t,e,n){"use strict";var i=n(125);n.n(i).a},function(t,e,n){"use strict";var i=n(126);n.n(i).a},function(t,e,n){"use strict";var i=n(127);n.n(i).a},function(t,e,n){"use strict";var i=n(128);n.n(i).a},function(t,e,n){"use strict";var i=n(129);n.n(i).a},function(t,e,n){"use strict";var i=n(130);n.n(i).a},function(t,e,n){"use strict";var i=n(131);n.n(i).a},function(t,e,n){"use strict";var i=n(132);n.n(i).a},function(t,e,n){"use strict";var i=n(133);n.n(i).a},function(t,e,n){"use strict";var i=n(134);n.n(i).a},function(t,e,n){},function(t,e,n){"use strict";n(398),n(24),n(14),n(10),n(16);var i=n(9),o=n.n(i);Sentry.init({dsn:"https://d340547ea5594fd68a13559a8c3c577e@api.bilibili.com/x/traceback/26",release:Object({NODE_ENV:"production",BASE_URL:"/"}).COMMIT_ID,sampleRate:.1,beforeSend:function(t){try{if(t.exception.values[0].stacktrace.frames.every(function(t){return t.filename.indexOf("-extension://")<0}))return t}catch(e){return t}},integrations:[new Sentry.Integrations.InboundFilters({ignoreErrors:[/Network Error/,/(SECURITY_ERR|SecurityError|Illegal invocation|The operation is)/,/网络/,/Error: 您没登陆，想干撒子/,/\$ is not a function/,/share_ipad/,/(hw-|hw_)/,/Invalid or unexpected/,/UnhandledRejection/,/-8888/,/AbortError/,/__bp_defaultMsgObj/,/QuotaExceededError/,/(\$UCBrowser|postMessage|YoukuAntiAds)/,/Can't find variable:/,/(WindVaneAvailableInteractedTime|-extension)/,/MyAppGet/,/Cannot read property '(tagName|className|style)' of null/,/is not an object \(evaluating/,/__tv_keydown/,/Failed to execute 'removeChild' on 'Node': The node to be removed is not a child of this node./,/WebViewJavascriptBridge/,/timeout of 0ms exceeded/]}),new Sentry.Integrations.Vue({Vue:o.a,attachProps:!0})]}),"function"==typeof window.onLoginInfoLoaded&&window.onLoginInfoLoaded(function(t){if(t.isLogin)try{Sentry.configureScope(function(e){e.setUser(t)})}catch(t){}})},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABCCAYAAADuSnCvAAAAAXNSR0IArs4c6QAACMhJREFUeAHtm2lsFVUUx+3rgtC0BSvCB1SKLA2FLo/lA8pS0ASjLEqMcSeKCcgShUSJfjAqagigokEjbiCJKCgxEaLgwpIgfmhfFwpUGkrY92Jbu9NXf2d8M5k3zExnpu9BH+1N7rv3nnvuuef8737vvLibIuDa2triA4HAOML+CQkJB3Nzcw9EQGy7IoqLi4cGg8HsuLi4i62trXtHjx7d0m6hdhh87eQ7ygaMFYCxB+ZNV65cKSssLHzNUcEOMFHHAur6G0A2A8ZOQPm0A+K0ohEBBDDu1yQSIb0MhV/W0yIZpwHmUsdHeplGHfR5buIRAYTWKTFWioLLUXyxkd7RNDKfQ/bHRjnoUGykeUlHBBAUfInKjxgVoDuvwoCFRrrXdEFBwTPU9Rk+Ti8DME75fL55eprXeJhgr0Kk3P79+29vamraTTTDRM4LTHifmNAdkxiCT8D8NWAYG/FMfHz8xLy8vArHwmwYjcJtWO2zRo4ceYJWyofruJGTFlyDQc8b6U7TlH0UINabgHEOGZMjBYboE7EeohpXWlo6qLm5WXrKAJUmIaC0ETw7atSodZJ26hhysxh638KfoC+DvAv0jPxIL/ER6yGqstnZ2ZUom48/rdIkDI37L2jtJ/V0u3hRUdEMwNgITxgYpC8hb0qkwRBdHPUQ6arMEWlSwKljj5BJuW34PoYyrYA1OzExcZuBHpakl02E7zvKJ+kzoNWRnk75Ij3dLo6sIHNYtR2PmmcJCK2TS+vIEid7jDvwiWqhGA3r0buSeW4L4Zd+v/+YmR1XAVJRUZFaXV29CuY5ZgVuBBq9rBk73gSU5cSv6G0KA+TAgQP9GxoadsKQqWe6UeOA8UtqaurMIUOGNKk2apMqm560xsbG37sKGAIA08HUmpqa7wm1jqEBAlofkDFcRaqrhNj8ICvfItVeBRkIk8mQ3tFVXT2r1rCcnJyTyvoOGK84QYJedAreWie8nYinL7qkt6NPr5aWlgXwLI2TSxa5V7ArABA/4RdaLVV2Za93Hg0oNuawhVhHPMdKH+y7jH39EgBjqhWT0GH8GcYZhLL1jjkX0ruYRWMcypfhM8yMAKw+TB0jZVLNN2NQaTAujlUwVBskZKdaz6bsVT3NGMfWMQKI3Z7jDILKjQVjNc1h8A873Wn4gQLIrVZMMBy2yotFOqvIefSusdIde/v4+LnFigF62LbWhi+WsuxsSvMxbrTNWSxZFQ1dBYtuMAzIdgNiAMR4E2XI7niSE3QSJ+gRbI3Py9bYi0S5kqitrc1ic1Uiy6cXGU7LRBSQo0eP3sxdSjaK+/GjUMLPCXoEYRKva0sJlztVTM+HzPGkt+Jb2WCVsxAEiIsvTE5OLs7MzIzYccIzICjWi3VdbtX8KKYYf+nSJTkth8lkooKkHLVzlYiHHwDIDcmJp3gW8SzCp0RUXV1dG7rI9kABSEL0KuIm/h/Jd+vClHdSmMrfRcHp8GbS6o7nIIzIcyLfgseyLHLlxD4s5B+T8jSSgCSX3du55Z8vNKfOsUGqQCrJQInheFdlKTekpKQkWZXjJqQuV70rBNJd1GF6brGr25VRIgjDHN926ysWAOlR2Xqak7hMqNQ5yAmvCY9rXV0PGQxz/KiMIfI2U4hXxndKSorr70Z4QmikTjmRK/NUKHTU8m50Ra7iXAPCBzFFXKao5fXhcRIBTpSFABGAr5DnTXlq7JDLyspqRsCOkFdk8TrYh2sLPwbLhK5O6oNJy3yiOS+92TUgckDi3mAflZ+iZrX1A+wPLmqaRDnC6+BlqpArT+3aM7RXyQuBJL1pGPc4R9yq4hoQqYCZe5zbiqLNz1NCDXXsDnnP1bmeVD3XFCMFuwExNFQ3IN2AGBAwJLt7SGcERB7ZOXukGXS7LklPy64bTdkXyFfOX0mYlpY2L7Q8aiLIu5P7klIIZ7k+yMnIyGjUMolw/slgI/gem6wClvu39XnRiEd9yPDhjWyW5Kj+OPca3xDXGkEujziZbiIvFT+0qqoq7EvFQ4cOpbMjlS+NZlJuGZuvHsSj6jTlolVLjx49KukBsouV544H6BHbAWkJW/xqLo9WQxur1o3Rsxk6VaRXkj+cu441xOVoLy6g/47jf1Lkf6PeQziLVHFhMxPVG0R9jJ7MqVfOQ5XEpwmN4SDnFdUtJnKanvMboQrGSeIPqQzRDKMOiCjP7dVeWnwK0UoTY04AyN3kP0L4rzEf2p/cx07grHTcmBeNdNSHjKo0B619zBk5DJ+50Cbh5evCv/AfkidDqoBX+lLmjAXERwCEDJ2t5G0g3kr8mrhrBohYw/CRHrAy5IUU5vju9DCERWHEa5yQp8yY/MwhGjiBRVCeMuVuwdSRJ7fcN5qzs6lGJtULNhYPtsmLuSzZ16C05Y5YOocMGRm3Vm6A7BStMmONXl9fP6EdnY8LILvsmJj1V9jlx0qe7IrpAe/Y6cs9cIGPTdMOOyaEzOIOdQO7y952fJ05D90HstzL10N2X0vV8ixaotxSY/AuDJ9oZ5TMwPAcJKy14+tseeh8GzrJo5Wtw67VHB5fVPYhFJJhYQsIPDIBjyC0FRyLmYDRzHCRc9VNYqR8oScnys0S76LuDZ5XjortCiBKxOebT6gQJd2F3C6OB9pnGhogEC9wwMqn+xzrQmDs7dmz5zRs1s5KGiACAqAcYyyNheGHGxkU7Ati36r09PR7Q+crzVxlldFSughL1STuJOYwicpDs+zwYtoBgqwGp7FnC9cJa5kzyswMsgREz1xeXp7CK3xflUb8deJPq2l9SMUlVPiwnhatOHqsR/Y9FvJ/TEpKWiJ5XEgFe/fufdZ4X2tWztHxP/QNl7b/YN+yA6RNAYG+R/6qalZZpGlcN+5EphUgv3rRI2wOcaowc81GePea8J9jYn7LhB4VErf4K+mRVy0C0kuZLD/3UqknQKgw2K9fv/uoUJarMtLy98/1eLDyX/CiiJcy8qRB3WPwa6m7gvAQ/n224OND35W4Fvsfl7KGlCwvH7sAAAAASUVORK5CYII="},function(t,e){t.exports=function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=42)}([function(t,e,n){"use strict";var i=n(5),o=n(20),r=Object.prototype.toString;function a(t){return"[object Array]"===r.call(t)}function s(t){return null!==t&&"object"==typeof t}function c(t){return"[object Function]"===r.call(t)}function u(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),a(t))for(var n=0,i=t.length;n<i;n++)e.call(null,t[n],n,t);else for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.call(null,t[o],o,t)}t.exports={isArray:a,isArrayBuffer:function(t){return"[object ArrayBuffer]"===r.call(t)},isBuffer:o,isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:s,isUndefined:function(t){return void 0===t},isDate:function(t){return"[object Date]"===r.call(t)},isFile:function(t){return"[object File]"===r.call(t)},isBlob:function(t){return"[object Blob]"===r.call(t)},isFunction:c,isStream:function(t){return s(t)&&c(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:u,merge:function t(){var e={};function n(n,i){"object"==typeof e[i]&&"object"==typeof n?e[i]=t(e[i],n):e[i]=n}for(var i=0,o=arguments.length;i<o;i++)u(arguments[i],n);return e},deepMerge:function t(){var e={};function n(n,i){"object"==typeof e[i]&&"object"==typeof n?e[i]=t(e[i],n):e[i]="object"==typeof n?t({},n):n}for(var i=0,o=arguments.length;i<o;i++)u(arguments[i],n);return e},extend:function(t,e,n){return u(e,function(e,o){t[o]=n&&"function"==typeof e?i(e,n):e}),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(t,e,n){var i=n(40);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals),(0,n(43).default)("13beddba",i,!0,{hmr:!1})},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(e){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?t.exports=i=function(t){return n(t)}:t.exports=i=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":n(t)},i(e)}t.exports=i},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,n){"use strict";var i=n(36),o=n(37),r=n(14);t.exports={formats:r,parse:o,stringify:i}},function(t,e,n){"use strict";t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];return t.apply(e,n)}}},function(t,e,n){"use strict";var i=n(0);function o(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,n){if(!e)return t;var r;if(n)r=n(e);else if(i.isURLSearchParams(e))r=e.toString();else{var a=[];i.forEach(e,function(t,e){null!=t&&(i.isArray(t)?e+="[]":t=[t],i.forEach(t,function(t){i.isDate(t)?t=t.toISOString():i.isObject(t)&&(t=JSON.stringify(t)),a.push(o(e)+"="+o(t))}))}),r=a.join("&")}if(r){var s=t.indexOf("#");-1!==s&&(t=t.slice(0,s)),t+=(-1===t.indexOf("?")?"?":"&")+r}return t}},function(t,e,n){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,n){"use strict";(function(e){var i=n(0),o=n(26),r={"Content-Type":"application/x-www-form-urlencoded"};function a(t,e){!i.isUndefined(t)&&i.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var s,c={adapter:(void 0!==e&&"[object process]"===Object.prototype.toString.call(e)?s=n(9):"undefined"!=typeof XMLHttpRequest&&(s=n(9)),s),transformRequest:[function(t,e){return o(e,"Accept"),o(e,"Content-Type"),i.isFormData(t)||i.isArrayBuffer(t)||i.isBuffer(t)||i.isStream(t)||i.isFile(t)||i.isBlob(t)?t:i.isArrayBufferView(t)?t.buffer:i.isURLSearchParams(t)?(a(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):i.isObject(t)?(a(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],function(t){c.headers[t]={}}),i.forEach(["post","put","patch"],function(t){c.headers[t]=i.merge(r)}),t.exports=c}).call(this,n(25))},function(t,e,n){"use strict";var i=n(0),o=n(27),r=n(6),a=n(29),s=n(30),c=n(10);t.exports=function(t){return new Promise(function(e,u){var l=t.data,d=t.headers;i.isFormData(l)&&delete d["Content-Type"];var f=new XMLHttpRequest;if(t.auth){var p=t.auth.username||"",h=t.auth.password||"";d.Authorization="Basic "+btoa(p+":"+h)}if(f.open(t.method.toUpperCase(),r(t.url,t.params,t.paramsSerializer),!0),f.timeout=t.timeout,f.onreadystatechange=function(){if(f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in f?a(f.getAllResponseHeaders()):null,i={data:t.responseType&&"text"!==t.responseType?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:n,config:t,request:f};o(e,u,i),f=null}},f.onabort=function(){f&&(u(c("Request aborted",t,"ECONNABORTED",f)),f=null)},f.onerror=function(){u(c("Network Error",t,null,f)),f=null},f.ontimeout=function(){u(c("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",f)),f=null},i.isStandardBrowserEnv()){var m=n(31),g=(t.withCredentials||s(t.url))&&t.xsrfCookieName?m.read(t.xsrfCookieName):void 0;g&&(d[t.xsrfHeaderName]=g)}if("setRequestHeader"in f&&i.forEach(d,function(t,e){void 0===l&&"content-type"===e.toLowerCase()?delete d[e]:f.setRequestHeader(e,t)}),t.withCredentials&&(f.withCredentials=!0),t.responseType)try{f.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&f.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(t){f&&(f.abort(),u(t),f=null)}),void 0===l&&(l=null),f.send(l)})}},function(t,e,n){"use strict";var i=n(28);t.exports=function(t,e,n,o,r){var a=new Error(t);return i(a,e,n,o,r)}},function(t,e,n){"use strict";var i=n(0);t.exports=function(t,e){e=e||{};var n={};return i.forEach(["url","method","params","data"],function(t){void 0!==e[t]&&(n[t]=e[t])}),i.forEach(["headers","auth","proxy"],function(o){i.isObject(e[o])?n[o]=i.deepMerge(t[o],e[o]):void 0!==e[o]?n[o]=e[o]:i.isObject(t[o])?n[o]=i.deepMerge(t[o]):void 0!==t[o]&&(n[o]=t[o])}),i.forEach(["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"],function(i){void 0!==e[i]?n[i]=e[i]:void 0!==t[i]&&(n[i]=t[i])}),n}},function(t,e,n){"use strict";function i(t){this.message=t}i.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},i.prototype.__CANCEL__=!0,t.exports=i},function(t,e,n){"use strict";var i=Object.prototype.hasOwnProperty,o=Array.isArray,r=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),a=function(t,e){for(var n=e&&e.plainObjects?Object.create(null):{},i=0;i<t.length;++i)void 0!==t[i]&&(n[i]=t[i]);return n};t.exports={arrayToObject:a,assign:function(t,e){return Object.keys(e).reduce(function(t,n){return t[n]=e[n],t},t)},combine:function(t,e){return[].concat(t,e)},compact:function(t){for(var e=[{obj:{o:t},prop:"o"}],n=[],i=0;i<e.length;++i)for(var r=e[i],a=r.obj[r.prop],s=Object.keys(a),c=0;c<s.length;++c){var u=s[c],l=a[u];"object"==typeof l&&null!==l&&-1===n.indexOf(l)&&(e.push({obj:a,prop:u}),n.push(l))}return function(t){for(;t.length>1;){var e=t.pop(),n=e.obj[e.prop];if(o(n)){for(var i=[],r=0;r<n.length;++r)void 0!==n[r]&&i.push(n[r]);e.obj[e.prop]=i}}}(e),t},decode:function(t,e,n){var i=t.replace(/\+/g," ");if("iso-8859-1"===n)return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch(t){return i}},encode:function(t,e,n){if(0===t.length)return t;var i="string"==typeof t?t:String(t);if("iso-8859-1"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,function(t){return"%26%23"+parseInt(t.slice(2),16)+"%3B"});for(var o="",a=0;a<i.length;++a){var s=i.charCodeAt(a);45===s||46===s||95===s||126===s||s>=48&&s<=57||s>=65&&s<=90||s>=97&&s<=122?o+=i.charAt(a):s<128?o+=r[s]:s<2048?o+=r[192|s>>6]+r[128|63&s]:s<55296||s>=57344?o+=r[224|s>>12]+r[128|s>>6&63]+r[128|63&s]:(a+=1,s=65536+((1023&s)<<10|1023&i.charCodeAt(a)),o+=r[240|s>>18]+r[128|s>>12&63]+r[128|s>>6&63]+r[128|63&s])}return o},isBuffer:function(t){return!(!t||"object"!=typeof t||!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t)))},isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},merge:function t(e,n,r){if(!n)return e;if("object"!=typeof n){if(o(e))e.push(n);else{if(!e||"object"!=typeof e)return[e,n];(r&&(r.plainObjects||r.allowPrototypes)||!i.call(Object.prototype,n))&&(e[n]=!0)}return e}if(!e||"object"!=typeof e)return[e].concat(n);var s=e;return o(e)&&!o(n)&&(s=a(e,r)),o(e)&&o(n)?(n.forEach(function(n,o){if(i.call(e,o)){var a=e[o];a&&"object"==typeof a&&n&&"object"==typeof n?e[o]=t(a,n,r):e.push(n)}else e[o]=n}),e):Object.keys(n).reduce(function(e,o){var a=n[o];return i.call(e,o)?e[o]=t(e[o],a,r):e[o]=a,e},s)}}},function(t,e,n){"use strict";var i=String.prototype.replace,o=/%20/g;t.exports={default:"RFC3986",formatters:{RFC1738:function(t){return i.call(t,o,"+")},RFC3986:function(t){return t}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},function(t,e,n){t.exports=n(19)},function(t,e,n){var i=n(38);function o(e,n,r){return function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?t.exports=o=Reflect.construct:t.exports=o=function(t,e,n){var o=[null];o.push.apply(o,e);var r=new(Function.bind.apply(t,o));return n&&i(r,n.prototype),r},o.apply(null,arguments)}t.exports=o},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}},function(t,e,n){var i,o;void 0===(o="function"==typeof(i=function(t,e){"use strict";var n=5e3,i="callback";function o(t){try{delete window[t]}catch(e){window[t]=void 0}}function r(t){var e=document.getElementById(t);e&&document.getElementsByTagName("head")[0].removeChild(e)}e.exports=function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=t,s=e.timeout||n,c=e.jsonpCallback||i,u=void 0;return new Promise(function(n,i){var l=e.jsonpCallbackFunction||"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random()),d=c+"_"+l;window[l]=function(t){n({ok:!0,json:function(){return Promise.resolve(t)}}),u&&clearTimeout(u),r(d),o(l)},a+=-1===a.indexOf("?")?"?":"&";var f=document.createElement("script");f.setAttribute("src",""+a+c+"="+l),e.charset&&f.setAttribute("charset",e.charset),f.id=d,document.getElementsByTagName("head")[0].appendChild(f),u=setTimeout(function(){i(new Error("JSONP request to "+t+" timed out")),o(l),r(d),window[l]=function(){o(l)}},s),f.onerror=function(){i(new Error("JSONP request to "+t+" failed")),o(l),r(d),u&&clearTimeout(u)}})}})?i.apply(e,[e,t]):i)||(t.exports=o)},function(t,e,n){"use strict";var i=n(0),o=n(5),r=n(21),a=n(11);function s(t){var e=new r(t),n=o(r.prototype.request,e);return i.extend(n,r.prototype,e),i.extend(n,e),n}var c=s(n(8));c.Axios=r,c.create=function(t){return s(a(c.defaults,t))},c.Cancel=n(12),c.CancelToken=n(34),c.isCancel=n(7),c.all=function(t){return Promise.all(t)},c.spread=n(35),t.exports=c,t.exports.default=c},function(t,e){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&null!=t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}},function(t,e,n){"use strict";var i=n(0),o=n(6),r=n(22),a=n(23),s=n(11);function c(t){this.defaults=t,this.interceptors={request:new r,response:new r}}c.prototype.request=function(t){"string"==typeof t?(t=arguments[1]||{}).url=arguments[0]:t=t||{},(t=s(this.defaults,t)).method=t.method?t.method.toLowerCase():"get";var e=[a,void 0],n=Promise.resolve(t);for(this.interceptors.request.forEach(function(t){e.unshift(t.fulfilled,t.rejected)}),this.interceptors.response.forEach(function(t){e.push(t.fulfilled,t.rejected)});e.length;)n=n.then(e.shift(),e.shift());return n},c.prototype.getUri=function(t){return t=s(this.defaults,t),o(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},i.forEach(["delete","get","head","options"],function(t){c.prototype[t]=function(e,n){return this.request(i.merge(n||{},{method:t,url:e}))}}),i.forEach(["post","put","patch"],function(t){c.prototype[t]=function(e,n,o){return this.request(i.merge(o||{},{method:t,url:e,data:n}))}}),t.exports=c},function(t,e,n){"use strict";var i=n(0);function o(){this.handlers=[]}o.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},o.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},o.prototype.forEach=function(t){i.forEach(this.handlers,function(e){null!==e&&t(e)})},t.exports=o},function(t,e,n){"use strict";var i=n(0),o=n(24),r=n(7),a=n(8),s=n(32),c=n(33);function u(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return u(t),t.baseURL&&!s(t.url)&&(t.url=c(t.baseURL,t.url)),t.headers=t.headers||{},t.data=o(t.data,t.headers,t.transformRequest),t.headers=i.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),i.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e]}),(t.adapter||a.adapter)(t).then(function(e){return u(t),e.data=o(e.data,e.headers,t.transformResponse),e},function(e){return r(e)||(u(t),e&&e.response&&(e.response.data=o(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},function(t,e,n){"use strict";var i=n(0);t.exports=function(t,e,n){return i.forEach(n,function(n){t=n(t,e)}),t}},function(t,e){var n,i,o=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(t){n=r}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(t){i=a}}();var c,u=[],l=!1,d=-1;function f(){l&&c&&(l=!1,c.length?u=c.concat(u):d=-1,u.length&&p())}function p(){if(!l){var t=s(f);l=!0;for(var e=u.length;e;){for(c=u,u=[];++d<e;)c&&c[d].run();d=-1,e=u.length}c=null,l=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function m(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new h(t,e)),1!==u.length||l||s(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,n){"use strict";var i=n(0);t.exports=function(t,e){i.forEach(t,function(n,i){i!==e&&i.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[i])})}},function(t,e,n){"use strict";var i=n(10);t.exports=function(t,e,n){var o=n.config.validateStatus;!o||o(n.status)?t(n):e(i("Request failed with status code "+n.status,n.config,null,n.request,n))}},function(t,e,n){"use strict";t.exports=function(t,e,n,i,o){return t.config=e,n&&(t.code=n),t.request=i,t.response=o,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},t}},function(t,e,n){"use strict";var i=n(0),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,n,r,a={};return t?(i.forEach(t.split("\n"),function(t){if(r=t.indexOf(":"),e=i.trim(t.substr(0,r)).toLowerCase(),n=i.trim(t.substr(r+1)),e){if(a[e]&&o.indexOf(e)>=0)return;a[e]="set-cookie"===e?(a[e]?a[e]:[]).concat([n]):a[e]?a[e]+", "+n:n}}),a):a}},function(t,e,n){"use strict";var i=n(0);t.exports=i.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(t){var i=t;return e&&(n.setAttribute("href",i),i=n.href),n.setAttribute("href",i),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=o(window.location.href),function(e){var n=i.isString(e)?o(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return!0}},function(t,e,n){"use strict";var i=n(0);t.exports=i.isStandardBrowserEnv()?{write:function(t,e,n,o,r,a){var s=[];s.push(t+"="+encodeURIComponent(e)),i.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),i.isString(o)&&s.push("path="+o),i.isString(r)&&s.push("domain="+r),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,n){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,n){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,n){"use strict";var i=n(12);function o(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(t){e=t});var n=this;t(function(t){n.reason||(n.reason=new i(t),e(n.reason))})}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var t;return{token:new o(function(e){t=e}),cancel:t}},t.exports=o},function(t,e,n){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,n){"use strict";var i=n(13),o=n(14),r=Object.prototype.hasOwnProperty,a={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},s=Array.isArray,c=Array.prototype.push,u=function(t,e){c.apply(t,s(e)?e:[e])},l=Date.prototype.toISOString,d={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:i.encode,encodeValuesOnly:!1,formatter:o.formatters[o.default],indices:!1,serializeDate:function(t){return l.call(t)},skipNulls:!1,strictNullHandling:!1},f=function t(e,n,o,r,a,c,l,f,p,h,m,g,v){var b=e;if("function"==typeof l?b=l(n,b):b instanceof Date?b=h(b):"comma"===o&&s(b)&&(b=b.join(",")),null===b){if(r)return c&&!g?c(n,d.encoder,v):n;b=""}if("string"==typeof b||"number"==typeof b||"boolean"==typeof b||i.isBuffer(b))return c?[m(g?n:c(n,d.encoder,v))+"="+m(c(b,d.encoder,v))]:[m(n)+"="+m(String(b))];var y,_=[];if(void 0===b)return _;if(s(l))y=l;else{var w=Object.keys(b);y=f?w.sort(f):w}for(var C=0;C<y.length;++C){var x=y[C];a&&null===b[x]||(s(b)?u(_,t(b[x],"function"==typeof o?o(n,x):n,o,r,a,c,l,f,p,h,m,g,v)):u(_,t(b[x],n+(p?"."+x:"["+x+"]"),o,r,a,c,l,f,p,h,m,g,v)))}return _};t.exports=function(t,e){var n,i=t,c=function(t){if(!t)return d;if(null!==t.encoder&&void 0!==t.encoder&&"function"!=typeof t.encoder)throw new TypeError("Encoder has to be a function.");var e=t.charset||d.charset;if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=o.default;if(void 0!==t.format){if(!r.call(o.formatters,t.format))throw new TypeError("Unknown format option provided.");n=t.format}var i=o.formatters[n],a=d.filter;return("function"==typeof t.filter||s(t.filter))&&(a=t.filter),{addQueryPrefix:"boolean"==typeof t.addQueryPrefix?t.addQueryPrefix:d.addQueryPrefix,allowDots:void 0===t.allowDots?d.allowDots:!!t.allowDots,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:d.charsetSentinel,delimiter:void 0===t.delimiter?d.delimiter:t.delimiter,encode:"boolean"==typeof t.encode?t.encode:d.encode,encoder:"function"==typeof t.encoder?t.encoder:d.encoder,encodeValuesOnly:"boolean"==typeof t.encodeValuesOnly?t.encodeValuesOnly:d.encodeValuesOnly,filter:a,formatter:i,serializeDate:"function"==typeof t.serializeDate?t.serializeDate:d.serializeDate,skipNulls:"boolean"==typeof t.skipNulls?t.skipNulls:d.skipNulls,sort:"function"==typeof t.sort?t.sort:null,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:d.strictNullHandling}}(e);"function"==typeof c.filter?i=(0,c.filter)("",i):s(c.filter)&&(n=c.filter);var l,p=[];if("object"!=typeof i||null===i)return"";l=e&&e.arrayFormat in a?e.arrayFormat:e&&"indices"in e?e.indices?"indices":"repeat":"indices";var h=a[l];n||(n=Object.keys(i)),c.sort&&n.sort(c.sort);for(var m=0;m<n.length;++m){var g=n[m];c.skipNulls&&null===i[g]||u(p,f(i[g],g,h,c.strictNullHandling,c.skipNulls,c.encode?c.encoder:null,c.filter,c.sort,c.allowDots,c.serializeDate,c.formatter,c.encodeValuesOnly,c.charset))}var v=p.join(c.delimiter),b=!0===c.addQueryPrefix?"?":"";return c.charsetSentinel&&("iso-8859-1"===c.charset?b+="utf8=%26%2310003%3B&":b+="utf8=%E2%9C%93&"),v.length>0?b+v:""}},function(t,e,n){"use strict";var i=n(13),o=Object.prototype.hasOwnProperty,r={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:i.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},a=function(t){return t.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(parseInt(e,10))})},s=function(t,e,n){if(t){var i=n.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,r=/(\[[^[\]]*])/g,a=/(\[[^[\]]*])/.exec(i),s=a?i.slice(0,a.index):i,c=[];if(s){if(!n.plainObjects&&o.call(Object.prototype,s)&&!n.allowPrototypes)return;c.push(s)}for(var u=0;null!==(a=r.exec(i))&&u<n.depth;){if(u+=1,!n.plainObjects&&o.call(Object.prototype,a[1].slice(1,-1))&&!n.allowPrototypes)return;c.push(a[1])}return a&&c.push("["+i.slice(a.index)+"]"),function(t,e,n){for(var i=e,o=t.length-1;o>=0;--o){var r,a=t[o];if("[]"===a&&n.parseArrays)r=[].concat(i);else{r=n.plainObjects?Object.create(null):{};var s="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,c=parseInt(s,10);n.parseArrays||""!==s?!isNaN(c)&&a!==s&&String(c)===s&&c>=0&&n.parseArrays&&c<=n.arrayLimit?(r=[])[c]=i:r[s]=i:r={0:i}}i=r}return i}(c,e,n)}};t.exports=function(t,e){var n=function(t){if(!t)return r;if(null!==t.decoder&&void 0!==t.decoder&&"function"!=typeof t.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new Error("The charset option must be either utf-8, iso-8859-1, or undefined");var e=void 0===t.charset?r.charset:t.charset;return{allowDots:void 0===t.allowDots?r.allowDots:!!t.allowDots,allowPrototypes:"boolean"==typeof t.allowPrototypes?t.allowPrototypes:r.allowPrototypes,arrayLimit:"number"==typeof t.arrayLimit?t.arrayLimit:r.arrayLimit,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:r.charsetSentinel,comma:"boolean"==typeof t.comma?t.comma:r.comma,decoder:"function"==typeof t.decoder?t.decoder:r.decoder,delimiter:"string"==typeof t.delimiter||i.isRegExp(t.delimiter)?t.delimiter:r.delimiter,depth:"number"==typeof t.depth?t.depth:r.depth,ignoreQueryPrefix:!0===t.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof t.interpretNumericEntities?t.interpretNumericEntities:r.interpretNumericEntities,parameterLimit:"number"==typeof t.parameterLimit?t.parameterLimit:r.parameterLimit,parseArrays:!1!==t.parseArrays,plainObjects:"boolean"==typeof t.plainObjects?t.plainObjects:r.plainObjects,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:r.strictNullHandling}}(e);if(""===t||null==t)return n.plainObjects?Object.create(null):{};for(var c="string"==typeof t?function(t,e){var n,s={},c=e.ignoreQueryPrefix?t.replace(/^\?/,""):t,u=e.parameterLimit===1/0?void 0:e.parameterLimit,l=c.split(e.delimiter,u),d=-1,f=e.charset;if(e.charsetSentinel)for(n=0;n<l.length;++n)0===l[n].indexOf("utf8=")&&("utf8=%E2%9C%93"===l[n]?f="utf-8":"utf8=%26%2310003%3B"===l[n]&&(f="iso-8859-1"),d=n,n=l.length);for(n=0;n<l.length;++n)if(n!==d){var p,h,m=l[n],g=m.indexOf("]="),v=-1===g?m.indexOf("="):g+1;-1===v?(p=e.decoder(m,r.decoder,f),h=e.strictNullHandling?null:""):(p=e.decoder(m.slice(0,v),r.decoder,f),h=e.decoder(m.slice(v+1),r.decoder,f)),h&&e.interpretNumericEntities&&"iso-8859-1"===f&&(h=a(h)),h&&e.comma&&h.indexOf(",")>-1&&(h=h.split(",")),o.call(s,p)?s[p]=i.combine(s[p],h):s[p]=h}return s}(t,n):t,u=n.plainObjects?Object.create(null):{},l=Object.keys(c),d=0;d<l.length;++d){var f=l[d],p=s(f,c[f],n);u=i.merge(u,p,n)}return i.compact(u)}},function(t,e){function n(e,i){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,i)}t.exports=n},function(t,e,n){"use strict";var i=n(1);n.n(i).a},function(t,e,n){(t.exports=n(41)(!1)).push([t.i,"li[data-v-59a0e5c6] {\n  list-style: none;\n  color: #222;\n}\na[data-v-59a0e5c6] {\n  text-decoration: none;\n  -webkit-transition: color 0.2s;\n  transition: color 0.2s;\n}\n.nav-item[data-v-59a0e5c6] {\n  float: left;\n  text-align: center;\n  line-height: 42px;\n  height: 42px;\n  position: relative;\n  background-color: rgba(255, 255, 255, 0);\n  -webkit-transition: all 0.3s;\n  transition: all 0.3s;\n}\n.nav-item[data-v-59a0e5c6]:hover {\n  background-color: rgba(255, 255, 255, 0.3);\n}\n.t[data-v-59a0e5c6] {\n  color: inherit;\n  height: 100%;\n  display: block;\n  padding: 0 11px;\n}\n.num[data-v-59a0e5c6] {\n  height: 12px;\n  line-height: 12px;\n  color: #FFF;\n  background-color: #F25D8E;\n  border-radius: 10px;\n  position: absolute;\n  padding: 1px 2px;\n  font-size: 12px;\n  top: 1px;\n  right: -4px;\n  min-width: 16px;\n  z-index: 30;\n  text-align: center;\n}\n.red_point[data-v-59a0e5c6] {\n  height: 8px;\n  width: 8px;\n  border-radius: 100%;\n  position: absolute;\n  right: 6px;\n  top: 7px;\n  background-color: #F25D8E;\n}\n.notify-float[data-v-59a0e5c6] {\n  /*border: 1px solid #F25D8E;*/\n  -webkit-box-shadow: 0 1px 4px 0 #f25d8e;\n          box-shadow: 0 1px 4px 0 #f25d8e;\n  background: #FFF;\n  position: absolute;\n  border-radius: 4px;\n  line-height: 36px;\n  text-align: left;\n  padding: 0px 15px;\n  top: 52px;\n  left: -8px;\n  white-space: nowrap;\n}\n.notify-float .tri[data-v-59a0e5c6] {\n  width: 12px;\n  height: 12px;\n  position: absolute;\n  top: -6px;\n  background-color: white;\n  left: 22px;\n  -webkit-transform: rotate(45deg);\n          transform: rotate(45deg);\n}\n.notify-float .float_msg > div[data-v-59a0e5c6] {\n  display: inline-block;\n  margin-right: 30px;\n}\n.notify-float .float_msg > div span[data-v-59a0e5c6] {\n  cursor: pointer;\n  color: #00A1D6;\n}\n.notify-float .float_msg > div span[data-v-59a0e5c6]:hover {\n  color: #F25D8E;\n}\n.notify-float .float_msg > i[data-v-59a0e5c6] {\n  float: none;\n  cursor: pointer;\n  background-position: -472px -536px;\n  width: 16px;\n  height: 16px;\n}\n.b-icon[data-v-59a0e5c6] {\n  display: inline-block;\n  vertical-align: middle;\n  width: 12px;\n  height: 12px;\n  background: url(//static.hdslb.com/images/base/icons.png) no-repeat;\n}\n.slide-fade-enter-active[data-v-59a0e5c6],\n.slide-fade-leave-active[data-v-59a0e5c6] {\n  -webkit-transition: all 0.3s;\n  transition: all 0.3s;\n}\n.slide-fade-enter[data-v-59a0e5c6],\n.slide-fade-leave-to[data-v-59a0e5c6] {\n  -webkit-transform: translateY(5px);\n          transform: translateY(5px);\n  opacity: 0;\n}\n.i-frame[data-v-59a0e5c6] {\n  position: absolute;\n  width: 110px;\n  height: 210px;\n  top: 100% !important;\n  left: 0 !important;\n  left: calc(50% -  55px) !important;\n  background: #FFF;\n  -webkit-box-shadow: rgba(0, 0, 0, 0.16) 0px 2px 4px;\n          box-shadow: rgba(0, 0, 0, 0.16) 0px 2px 4px;\n  border-radius: 0 0 4px 4px;\n  overflow: hidden;\n}\n",""])},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=function(t,e){var n,i,o,r=t[1]||"",a=t[3];if(!a)return r;if(e&&"function"==typeof btoa){var s=(n=a,i=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),"/*# ".concat(o," */")),c=a.sources.map(function(t){return"/*# sourceURL=".concat(a.sourceRoot).concat(t," */")});return[r].concat(c).concat([s]).join("\n")}return[r].join("\n")}(e,t);return e[2]?"@media ".concat(e[2],"{").concat(n,"}"):n}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},o=0;o<this.length;o++){var r=this[o][0];null!=r&&(i[r]=!0)}for(var a=0;a<t.length;a++){var s=t[a];null!=s[0]&&i[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="(".concat(s[2],") and (").concat(n,")")),e.push(s))}},e}},function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",{staticClass:"nav-item",on:{click:t.emitClick,mouseleave:function(e){return t.hideDropBox("message")}}},[n("a",{staticClass:"t",attrs:{href:"//message.bilibili.com",target:"_blank",title:"消息"},on:{mouseenter:function(e){return t.showDropBox("message")}}},[t.notify.num&&0===t.notify.type?n("div",{staticClass:"num",domProps:{textContent:t._s(t.notify.num>99?"99+":t.notify.num)}}):t._e(),t.notify.num&&1===t.notify.type?n("div",{staticClass:"red_point"}):t._e(),t._v("\n    消息\n  ")]),t.floatMessage?n("div",{staticClass:"notify-float"},[n("div",{staticClass:"tri"}),n("ul",{staticClass:"float_msg"},[n("div",[t._v("\n        "+t._s(t.floatMessage.message.replace("%s"," "+t.floatMessage.count+" "))+"\n        "),n("span",{on:{click:function(e){return t.clearFloatMsgStore()}}},[t._v("查看详情")])]),n("i",{staticClass:"b-icon",on:{click:function(e){return t.closeFloatMsg()}}})])]):t._e(),n("transition",{attrs:{name:"slide-fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.navDropBox.message.show,expression:"navDropBox.message.show"}],staticClass:"i-frame"},[n("iframe",{attrs:{src:"//message.bilibili.com/pages/nav/index_new_sync",frameborder:"0",width:"100%",height:"100%"}})])])],1)};i._withStripped=!0;var o=n(2),r=n.n(o),a={_support:!("undefined"==typeof window||!window||!window.localStorage||"object"!=r()(window.localStorage)),getItem:function(t){return this._support?window.localStorage.getItem(t):null},setItem:function(t,e){this._support&&window.localStorage.setItem(t,e)},removeItem:function(t){this.getItem(t)&&window.localStorage.removeItem(t)}},s=n(15),c=n.n(s).a.create({timeout:"undefined"==typeof window?1e3:0}),u=n(3),l=n.n(u),d=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"对不起，服务器开小差了~ (ಥ﹏ಥ)",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"error",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-8888,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};if(l()(this,t),"object"===r()(o)){var u="对不起，服务器开小差了~ (ಥ﹏ಥ)";o.response?u="".concat(o.response.statusText," ").concat(o.response.status):"ECONNABORTED"===o.code&&(u="接口超时，稍后再试试吧~ (ಥ﹏ಥ)"),this.msg=u}else this.msg=o;this.type=a,this.code=s,this.data=c,this.url=n,this.payload=i,this.cost=e},f=function(t){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null};!function(){try{var t=document.createElement("canvas");t.getContext&&t.getContext("2d")&&t.toDataURL("image/webp").indexOf("data:image/webp")}catch(t){return!1}}();var p="undefined"!=typeof window?window.navigator.userAgent:"",h={myBrowser:"unknown",behaviors:[function(){return!!p.match(/Firefox\/\d.*/)&&"Firefox"},function(){return!(!p.match(/AppleWebKit\/\d.*.Chrome\/\d.*.Safari\/\d/)||"Google Inc."!==window.navigator.vendor||!window.chrome)&&"Chrome"},function(){return!!p.match(/Opera.\d.*.Presto\/\d/)&&"Opera Presto"},function(){return!!p.match(/OPR\/\d{2}/)&&"Opera Modern"},function(){return!!p.match(/MSIE [6-8].+/)&&"IE Legacy"},function(){return!(!p.match(/MSIE [9].+/)||"function"!=typeof window.ScriptEngine||"JScript"!==window.ScriptEngine())&&"IE 9"},function(){return!(!p.match(/MSIE [10].+/)||"function"!=typeof window.ScriptEngine||"JScript"!==window.ScriptEngine())&&"IE 10"},function(){return!(!p.match(/Trident\/[7].*.rv:11/)||"function"!=typeof window.ScriptEngine||"JScript"!==window.ScriptEngine())&&"IE 11"},function(){return!(!p.match(/Edge\/\d+\.\d+/)||"function"!=typeof window.StyleMedia)&&"Edge"},function(){return!!p.match(/Maxthon\/[4]/)&&"Maxthon 4"},function(){return!(!p.match(/AppleWebKit\/\d.*.Safari\/\d+/)||"Apple Computer, Inc."!==window.navigator.vendor)&&"Safari"}]},m="undefined"==typeof window?"":(h.behaviors.some(function(t){var e=t();return h.myBrowser=e||"unknown",e}),h.myBrowser),g="IE 9"===m||"IE Legacy"===m,v=g||"IE 10"===m||"IE 11"===m,b={},y={},_=function(){var t=Math.random();return y[t]=Date.now(),t},w=function(t){if(!t)return 0;if(y[t]){var e=Date.now()-y[t];return delete y[t],e}return 0},C=function(t,e){var n=new RegExp("[?&]".concat(e,"=([^&#]+)"));return(t.match(n)||[])[1]||""},x={API_LIVE:"//api.live.bilibili.com",API_VC:"//api.vc.bilibili.com",API_MAIN:"//api.bilibili.com",MAIN:"//www.bilibili.com",SPACE:"//space.bilibili.com",PASSPORT:"//passport.bilibili.com",BANGUMI:"//bangumi.bilibili.com",DATA:"//data.bilibili.com",T:"//t.bilibili.com",H:"//h.bilibili.com",VC:"//vc.bilibili.com",APP:"//app.bilibili.com",MESSAGE:"//message.bilibili.com",LINK:"//link.bilibili.com",M:"//m.bilibili.com",LIVE:"//live.bilibili.com"},I=n(4),k=n.n(I),S=function(t){return t.replace(/("\w*":)\s*(\d{16}\d*)/g,'$1"$2"').replace(/(\\"\w*\\":)\s*(\d{16}\d*)/g,'$1\\"$2\\"').replace(/("\w*":)\s*(\[\s*(\d{16}\d*)\s*(,\s*(\d{16}\d*)\s*)*])/g,function(t,e,n){return"".concat(e).concat(n.trim().replace(/\[\s*/,'["').replace(/\s*]\s*/,'"]').replace(/\s*,\s*/g,'","'))}).replace(/(\\"\w*\\":)\s*(\[\s*(\d{16}\d*)\s*(,\s*(\d{16}\d*)\s*)*])/g,function(t,e,n){return"".concat(e).concat(n.trim().replace(/\[\s*/,'[\\"').replace(/\s*]/,'\\"]').replace(/\s*,\s*/g,'\\",\\"'))})};function O(t){if("string"==typeof t){var e=S(t);try{t=JSON.parse(e)}catch(t){}}return t}function P(t,e,n,i,o){var r=t.data;return new Promise(function(t,a){var s,c,u=function(){return 0===r[s]};new RegExp(x.SPACE).test(e)?(s="status",c="result",u=function(){return!0===r[s]}):new RegExp(x.BANGUMI).test(e)?(s="code",c="result"):new RegExp(x.PASSPORT).test(e)?(s="code",c="access_info"):(s="code",c="data"),void 0===r||void 0===r[s]?a(new d(o,e,n)):u()?t(new d(o,e,n,"请求成功","success",0,i?r:r[c])):a(new d(o,e,n,r.message||r.msg||"电波无法到达~ ".concat(r.message||r.msg||r.code),"caution",r[s],r[c]))})}var T=n(16),E=n.n(T);function j(t,e,n){for(var i=arguments.length,o=new Array(i>3?i-3:0),r=3;r<i;r++)o[r-3]=arguments[r];return Promise.reject(E()(d,[t,e,n].concat(o)))}var L=n(17),A=n.n(L),D=36e4,M=new(function(){function t(){l()(this,t),this.store={};var e={},n={};if("undefined"!=typeof window&&window.localStorage)try{e=JSON.parse(window.localStorage.getItem("bpapi_cache"))||e}catch(t){}var i=(new Date).getTime();Object.keys(e).forEach(function(t){var o=e[t];o&&i-o.ts<o.ttl&&i-o.ts<D&&(n[t]=o)}),n.uniqueKey=e.uniqueKey,this.store=n,this.setLocalCache()}return A()(t,[{key:"set",value:function(t,e,n,i,o){var r=this;return(!o||this.store.uniqueKey!==o||"0"===o)&&n>0&&(this.clearCache(),this.store={}),o&&(this.uniqueKey=o,this.store.uniqueKey=o),new Promise(function(a,s){try{var c={};c.response=e,c.ttl=n>0?n:0,c.ts=(new Date).getTime(),r.store[t]=c,i&&n>0&&o&&"0"!==o&&r.setLocalCache(),a({status:"success"})}catch(t){s({status:"failed",data:t})}})}},{key:"get",value:function(t,e,n){var i=this;return(!n||this.store.uniqueKey!==n||"0"===n)&&e>0&&(this.clearCache(),this.store={}),n&&(this.uniqueKey=n,this.store.uniqueKey=n),new Promise(function(n,o){try{var r=i.store[t],a=(new Date).getTime();r&&a-r.ts<(e>0?e:0)&&a-r.ts<D?n({status:"success",data:r.response}):o({status:"failed",data:r})}catch(t){o({status:"failed",data:t})}})}},{key:"clearCache",value:function(){"undefined"!=typeof window&&window.localStorage&&window.localStorage.removeItem("bpapi_cache")}},{key:"setLocalCache",value:function(){this.uniqueKey&&(this.store.uniqueKey=this.uniqueKey),"undefined"!=typeof window&&window.localStorage&&this.uniqueKey&&window.localStorage.setItem("bpapi_cache",JSON.stringify(this.store))}}]),t}());var N=n(18),R=n.n(N);c.interceptors.request.use(function(t){var e=t.method,n=t.url,i=t.data;t.withCredentials=!0;var o=i||{},r="string"==typeof e&&"post"===e.toLowerCase();if(r){var a=f("bili_jct")||"",s=new RegExp(x.API_VC),c=new RegExp(x.API_LIVE);o[s.test(n)||c.test(n)?"csrf_token":"csrf"]=a}if(!("undefined"!=typeof FormData&&o instanceof FormData)){var u={};if("undefined"!=typeof window){var l=C(window.location.href,"lang");if(l){var d="iphone";(/Android/i.test(navigator.userAgent)||/Linux/i.test(navigator.userAgent))&&(d="android"),u.lang=l,u.mobi_app="".concat(d,"_i")}}o=Object.assign(u,o),r?t.data=Object(I.stringify)(o):(t.params=o,v&&(t.params._=(new Date).getTime()),delete t.data)}return t});var B=function(t){"undefined"==typeof window||window.Promise||console.warn("No window.Promise. @bplus-common/components.bpapi need a promise polyfill.");var e=(t.method||"get").toLowerCase(),n=g&&!function(t){if("undefined"==typeof window)return!1;var e=t.replace(/^(https?:)?(\/\/)?/,"").match(window.location.hostname);return e&&0===e.index}(t.url),i="jsonp"===e;return!i&&n?j(t.url,t.data,"少年啊，你的浏览器太老了辣","caution",-8889):(t.method=e,t.transformResponse=t.transformResponse||[O],i?function(t){var e=_("jsonp"),n=0,i=t.url,o=/^(http:|https:)?\/\/api\.(live)|(vc)/.test(i),r=t.data&&"[object Object]"===t.data.toString();t.jsonpCallback||!r||"type"in t.data||"jsonp"in t.data?t.jsonpCallback||r||(t.data={type:"jsonp",jsonp:"jsonp"}):(t.data.type="jsonp",t.data.jsonp="jsonp");var a=t.data||{},s={},c="zh_CN";if("undefined"!=typeof window&&(c=C(window.location.href,"lang"))){s.lang=c;var u="iphone";(/Android/i.test(navigator.userAgent)||/Linux/i.test(navigator.userAgent))&&(u="android"),"zh_CN"!==c&&(s.mobi_app="".concat(u,"_i"))}a=Object.assign(s,a);var l=t.data&&t.jsonpCallback||(o?"_cb":"callback"),d=k.a.stringify(a),f=d.length>0?"".concat(i,"?").concat(d):"".concat(i),p=i+JSON.stringify(t.data||"");return M.get(p,t.ttl,String(t.cache_key||"")).then(function(o){return n=w(e),P({data:o.data},i,t.data,t.needOriginal,n)}).catch(function(){return R()(f,{jsonpCallback:l}).then(function(o){return o.ok?o.json().then(function(o){return M.set(p,o,t.ttl,t.localCache,String(t.cache_key||"")).then(function(){return n=w(e),P({data:o},i,t.data,t.needOriginal,n)})},function(){n=w(e);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return j.apply(void 0,[n,t.url,t.data].concat(o))}):j(n=w(e),t.url,t.data)},function(){n=w(e);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return j.apply(void 0,[n,t.url,t.data].concat(o))})})}(t):function(t){var e=_(),n=0,i=t.url+JSON.stringify(t.data||"");return M.get(i,t.ttl,String(t.cache_key||"")).then(function(i){return n=w(e),P(i.data,t.url,t.data,t.needOriginal,n)}).catch(function(){return function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return function(){if(b[t]&&i>0)return b[t];setTimeout(function(){b[t]=null},i);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return b[t]=e.apply(n,r),b[t]}}(i,c,t.throttleInterval)(t).then(function(o){return M.set(i,o,t.ttl,t.localCache,String(t.cache_key||"")).then(function(){return n=w(e),P(o,t.url,t.data,t.needOriginal,n)})},function(){n=w(e);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return j.apply(void 0,[n,t.url,t.data].concat(o))})})}(t))},U={props:{uid:{required:!0,default:function(){return 0}}},data:function(){return{host:{isDynamic:!1,isMessage:!1},floatMessage:null,navDropBox:{message:{show:!1}},notify:{num:0,type:0},hoverTimer:null}},mounted:function(){this.onInit()},methods:{loadPromisePolyfill:function(t){var e,n,i;window._bp_promise_loading=!0,e=function(){window._bp_promise_loading=!1,t&&t()},n=document.createElement("script"),i=document.getElementsByTagName("script")[0],n.async=1,i.parentNode.insertBefore(n,i),n.onload=n.onreadystatechange=function(t,i){(i||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n=void 0,i||e&&e())},n.src="//s1.hdslb.com/bfs/seed/bplus-common/promise/promise.polyfill.min.js"},onInit:function(){if(void 0!==window.Promise){if(this.dealHost(),function(){var t,e,n;if(void 0!==document.hidden)t="hidden",n="visibilitychange",e="visibilityState";else if(void 0!==document.mozHidden)t="mozHidden",n="mozvisibilitychange",e="mozVisibilityState";else if(void 0!==document.msHidden)t="msHidden",n="msvisibilitychange",e="msVisibilityState";else{if(void 0===document.webkitHidden)return;t="webkitHidden",n="webkitvisibilitychange",e="webkitVisibilityState"}document.addEventListener(n,function(){window._im_visiable=!(document[e]===t)},!1),window._im_visiable=!(document[e]===t)}(),this.startGetMessage(),this.host.isDynamic)return;this.getFloatMessage(),setInterval(this.getFloatMessage,6e4)}else window._bp_promise_loading?setTimeout(this.onInit,1e3):this.loadPromisePolyfill(this.onInit)},emitClick:function(t){this.$emit("click",t)},dealHost:function(){switch(window.location.hostname){case"message.bilibili.com":this.host.isMessage=!0;break;case"t.bilibili.com":this.host.isDynamic=!0}},startGetMessage:function(){var t=this;window.addEventListener("message",function(e){e.data.type&&"nav-im-update"===e.data.type&&(t.notify.num=e.data.count,t.notify.type=e.data.notifyType)})},getFloatMessage:function(){if(window._im_visiable){var t=this,e=(new Date).getTime(),n={ts:0};try{n=JSON.parse(a.getItem("im_floatmsg_"+t.uid))||n}catch(t){}if(e-n.ts<6e4&&n.uid===t.uid){var i=n.res;if(0===i.data.length)return;var o=a.getItem("biliMSFCount-100_"+t.uid)||0;i.data[0].count>o&&(t.floatMessage=i.data[0])}else B({url:"//message.bilibili.com/api/tooltip/query.list.do",method:"get"}).then(function(n){var i=n,o={};if(o.res=i,o.ts=e,o.uid=t.uid,a.setItem("im_floatmsg_"+t.uid,JSON.stringify(o)),0!==i.data.length){var r=a.getItem("biliMSFCount-100_"+t.uid)||0;i.data[0].count>r&&(t.floatMessage=i.data[0])}})}},closeFloatMsg:function(){a.setItem("biliMSFCount-100_"+this.uid,this.floatMessage.count),this.floatMessage=null},clearFloatMsgStore:function(){var t=this;B({url:"//message.bilibili.com/api/tooltip/clear.do",method:"get",data:{mc:this.floatMessage.mc}}).then(function(e){if(0===e.code){var n=document.createElement("a");n.setAttribute("href","//member.bilibili.com/v2#/charge"),n.setAttribute("target","_blank"),n.click(),a.removeItem("biliMSFCount-100_"+t.uid),t.closeFloatMsg()}})},showDropBox:function(t){var e=this;clearTimeout(this.hoverTimer),this.hoverTimer=setTimeout(function(){e.navDropBox[t].show=!0},300)},hideDropBox:function(t){var e=this;clearTimeout(this.hoverTimer),this.hoverTimer=setTimeout(function(){e.navDropBox[t].show=!1},200)}}};n(39);var H=function(t,e,n,i,o,r,a,s){var c,u="function"==typeof t?t.options:t;if(e&&(u.render=e,u.staticRenderFns=[],u._compiled=!0),u._scopeId="data-v-"+r,c)if(u.functional){u._injectStyles=c;var l=u.render;u.render=function(t,e){return c.call(e),l(t,e)}}else{var d=u.beforeCreate;u.beforeCreate=d?[].concat(d,c):[c]}return{exports:t,options:u}}(U,i,0,0,0,"59a0e5c6");H.options.__file="packages/component.im-nav-new-sync/src/components/im-root.vue";var $=H.exports;e.default=$},function(t,e,n){"use strict";function i(t,e){for(var n=[],i={},o=0;o<e.length;o++){var r=e[o],a=r[0],s={id:t+":"+o,css:r[1],media:r[2],sourceMap:r[3]};i[a]?i[a].parts.push(s):n.push(i[a]={id:a,parts:[s]})}return n}n.r(e),n.d(e,"default",function(){return h});var o="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!o)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var r={},a=o&&(document.head||document.getElementsByTagName("head")[0]),s=null,c=0,u=!1,l=function(){},d=null,f="data-vue-ssr-id",p="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function h(t,e,n,o){u=n,d=o||{};var a=i(t,e);return m(a),function(e){for(var n=[],o=0;o<a.length;o++){var s=a[o];(c=r[s.id]).refs--,n.push(c)}for(e?m(a=i(t,e)):a=[],o=0;o<n.length;o++){var c;if(0===(c=n[o]).refs){for(var u=0;u<c.parts.length;u++)c.parts[u]();delete r[c.id]}}}}function m(t){for(var e=0;e<t.length;e++){var n=t[e],i=r[n.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](n.parts[o]);for(;o<n.parts.length;o++)i.parts.push(v(n.parts[o]));i.parts.length>n.parts.length&&(i.parts.length=n.parts.length)}else{var a=[];for(o=0;o<n.parts.length;o++)a.push(v(n.parts[o]));r[n.id]={id:n.id,refs:1,parts:a}}}}function g(){var t=document.createElement("style");return t.type="text/css",a.appendChild(t),t}function v(t){var e,n,i=document.querySelector("style["+f+'~="'+t.id+'"]');if(i){if(u)return l;i.parentNode.removeChild(i)}if(p){var o=c++;i=s||(s=g()),e=_.bind(null,i,o,!1),n=_.bind(null,i,o,!0)}else i=g(),e=function(t,e){var n=e.css,i=e.media,o=e.sourceMap;if(i&&t.setAttribute("media",i),d.ssrId&&t.setAttribute(f,e.id),o&&(n+="\n/*# sourceURL="+o.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,i),n=function(){i.parentNode.removeChild(i)};return e(t),function(i){if(i){if(i.css===t.css&&i.media===t.media&&i.sourceMap===t.sourceMap)return;e(t=i)}else n()}}var b,y=(b=[],function(t,e){return b[t]=e,b.filter(Boolean).join("\n")});function _(t,e,n,i){var o=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=y(e,o);else{var r=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(r,a[e]):t.appendChild(r)}}}]).default},function(t,e,n){"use strict";n(13),n(10),n(29);var i=n(11),o=n.n(i),r=(n(40),n(6)),a=n(4),s=n(8),c=n(7),u=n(299),l=n.n(u),d=n(197),f=n(51),p=n(5),h=n(0);function m(t,e,n,i,o,r,a){try{var s=t[r](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}var g,v,b={data:function(){return{isShowPanel:!1,isShowBackdrop:!1,canLottery:!1,draftCount:0}},components:{ImNav:l.a,BpPopup:f.a,PublishPanel:d.a},props:{loginInfo:{type:Object,default:function(){return{mid:0,face:"",isLogin:!1}}},pageType:{type:String}},computed:{bfsUserHead:function(){return Object(r.g)(Object(s.a)(this.loginInfo.face))}},watch:{isShowBackdrop:function(t){t?document.body.classList.add("bp-stop-scroll"):document.body.classList.remove("bp-stop-scroll")}},mounted:function(){this.fetchLotteryRight(),this.getDraftCount()},methods:{fetchLotteryRight:function(){var t=this;this.bpapi({url:"".concat(p.a.API_VC,"/dynamic_repost/v1/dynamic_repost/pre_judge"),method:"get",data:{uid:this.loginInfo.mid}}).then(function(e){t.canLottery=!!e.data.lottery_right})},getDraftCount:function(){var t=this;this.bpapi({url:p.a.API_VC+"/dynamic_draft/v1/dynamic_draft/get_draft_cnt",method:"get",data:{}}).then(function(e){t.draftCount=e.data.draft_count||0})},onMousedown:function(t){(t||window.event).preventDefault()},onImClick:function(){Object(c.d)(h.d.NAV_IM)},onHomeClick:function(){Object(c.d)(h.d.NAV_INDEX),this.pageType===h.c.DETAIL?window.location.href=p.a.T:(window.location.reload(),document.documentElement.scrollTop=document.body.scrollTop=0)},onHeadClick:function(){Object(c.d)(h.d.NAV_HEAD),window.open("".concat(p.a.SPACE,"/").concat(this.loginInfo.mid,"/dynamic"))},onLoginClick:(g=o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(s.i)(function(){Object(c.d)(h.d.LOGIN_SUCCESS,{nologin:1}),window.location.reload()});case 2:case"end":return t.stop()}},t)}),v=function(){var t=this,e=arguments;return new Promise(function(n,i){var o=g.apply(t,e);function r(t){m(o,n,i,r,a,"next",t)}function a(t){m(o,n,i,r,a,"throw",t)}r(void 0)})},function(){return v.apply(this,arguments)}),onRegisterClick:function(){window.location.href="".concat(p.a.PASSPORT,"/register/phone.html")},onPublishClick:function(){var t=this;this.isShowBackdrop=!0,setTimeout(function(){t.isShowPanel=!0},200),Object(c.d)(h.d.NAV_PUBLISH)},afterPublished:function(t){a.b.$emit("PUBLISH_SUCCEED",t),this.onCancel(),t.isScheduled&&this.draftCount++},onCancel:function(){var t=this;this.isShowPanel=!1,setTimeout(function(){t.isShowBackdrop=!1},200)}}},y=(n(400),n(2)),_=Object(y.a)(b,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sticky-bar"},[i("div",{staticClass:"bar-content"},[i("a",{staticClass:"f-left c-pointer",on:{click:t.onHomeClick}},[i("img",{staticClass:"title-icon f-left",attrs:{src:n(399)}}),i("span",{staticClass:"title fs-14 ls-0 f-left"},[t._v("动态首页")])]),t.loginInfo.isLogin?i("div",{staticClass:"f-right"},[i("div",{staticClass:"send-button c-pointer f-right",on:{click:t.onPublishClick,mousedown:t.onMousedown}},[i("span",{staticClass:"send-text",on:{mousedown:t.onMousedown}},[t._v("发布动态")])]),i("im-nav",{staticClass:"message fs-12 ls-0 c-pointer f-right",attrs:{uid:t.loginInfo.mid},on:{click:t.onImClick}},[t._v("消息")]),i("img",{staticClass:"head f-right c-pointer",attrs:{src:t.bfsUserHead},on:{click:t.onHeadClick}})],1):i("div",{staticClass:"not-login-panel tc-slate fs-12 ls-0 f-right"},[i("div",{staticClass:"login-button f-right c-pointer",on:{click:t.onLoginClick}},[t._v("登录")]),i("div",{staticClass:"register-button f-right c-pointer",on:{click:t.onRegisterClick}},[t._v("注册")])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowBackdrop,expression:"isShowBackdrop"}],staticClass:"backdrop"},[i("div",{staticClass:"position-box"},[i("bp-popup",{staticClass:"dynamic-specification-popup",attrs:{show:t.isShowPanel,width:632,title:"发布动态",button:!1,"on-cancel":t.onCancel}},[i("publish-panel",{attrs:{"login-uid":t.loginInfo.mid,"store-input":!0,"can-vote":!0,"can-lottery":t.canLottery,"can-be-scheduled":!0,"scheduled-count":t.draftCount,"is-popup-panel":!0},on:{succeed:t.afterPublished}})],1)],1)])])},[],!1,null,"224187b8",null);e.a=_.exports},,function(t,e,n){"use strict";n(47),n(49),n(12),n(31);var i=[/iPhone/i,/iPod/i,/iPad/i,/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,/Android/i,/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,/Windows Phone/i,/(?=.*\bWindows\b)(?=.*\bARM\b)/i,/BlackBerry/i,/BB10/i,/Opera Mini/i,/(CriOS|Chrome)(?=.*\bMobile\b)/i,/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i")];function o(){var t=window.navigator.userAgent;return i.some(function(e){return e.test(t)})}n.d(e,"a",function(){return o})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){},,,,,,,,,,,,,,,,,,,,,function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA0CAMAAADomgtXAAAA0lBMVEX///8AAAAAAAD///8AAAACAgIAAAAAAAAAAAACAgL09PT///////8CAgK6urr////e3t4AAAD////////////////7+/sCAgL8/Pz////////////o6OjMzMwAAAD9/f39/f3////////////////w8PDOzs6ysrKwsLCXl5d+fn7////////t7e3b29vm5ualpaWRkZHPz88AAAD////////////////h4eHi4uK9vb3V1dXExMQtLS3IyMj///////////////////////+JiYnv39IJAAAARnRSTlNLAALbBQoQCBIMWVZUGTuTNhZZXU5mYx5gUmtpSzoacVzWhHlnV0EpIRkPy7hSSjwxLiUUxaiPdFRFQisiIhnPvq+fl4ocGYilIQAAAkFJREFUSMed1ul2qjAUBeBUISEit0UmrfNQ26teq3Ye7/z+r9QTtlLFooT9RznJlyxWIIGd7KakcpIjLM2Qr4qZEF0Mw1A/qSJq2ZB6rNhEGFu9YjZ5j+kh+P7ARt9N9No483XQZMI4BA3x6jF2Dpm4qy5joZkJS3En/qOWSNydvGoyVruWqKThuhdBF1IKw1AFETvv6UYmY23BtRLClNyJYvlfmiZdm3DzyOXSpLGANzBmwpyszijt9nhYJXmGPNEodnfcbquL1YQwpIJgL2HQqyINRqlt/W+sG3pB+AIKSE7aHsuVel2SVBAurLGcqUICyuvcDiujIDnBR0wjARckFZSXng70LuUGtnwd6LfWUPALppULLhQ0TF5J38Xsn38AVrhpfA3vy+XbYRF4WqbMRkehtQ/j3PUyoJUNkf5pQx8i00EBiPzqFoDI71AfIv2hPkQGxeDtAysCfw58VgD2/zYKLcedV+gBmDULPXJTLIIu7N/77Cjkadid/rHzvMjaW0cCdTcrwJLgutsjF+vt0Q10YOAm+6o11jkCxtYGCu7Wq7ld6OIIOImndHr1fK5eceIJ18ccyUUYeFi8hr0XPOm2F4QLcgIQkrudt+VzTzU/ftvLo60me16+dVwO93mUc8t1onnTt8+jqNNxttLpRFHX9kfzyHEt/nmUkwSlWZ1Fq61aU6Ex262lQ7OBlVKfK0StG1LUvBOqqwaq736u7FCZfM4koUuycocBIugDtBc0QO1AUATNR+qASfZZZv0Dm7Yy8miU9cIAAAAASUVORK5CYII="},function(t,e,n){},function(t,e,n){"use strict";var i=n(153);n.n(i).a},function(t,e,n){"use strict";var i=n(154);n.n(i).a},function(t,e,n){"use strict";var i=n(155);n.n(i).a},function(t,e,n){"use strict";var i=n(156);n.n(i).a},function(t,e,n){"use strict";var i=n(157);n.n(i).a},function(t,e,n){"use strict";var i=n(158);n.n(i).a},function(t,e,n){"use strict";var i=n(159);n.n(i).a},function(t,e,n){"use strict";var i=n(160);n.n(i).a},function(t,e,n){"use strict";var i=n(161);n.n(i).a},function(t,e,n){"use strict";var i=n(162);n.n(i).a},function(t,e,n){"use strict";var i=n(163);n.n(i).a},function(t,e,n){t.exports=n.p+"static/img/icon-music.6ffed546.png"},function(t,e,n){"use strict";var i=n(164);n.n(i).a},function(t,e,n){t.exports=n.p+"static/img/icon-vote.324976be.svg"},function(t,e,n){"use strict";var i=n(165);n.n(i).a},function(t,e,n){"use strict";var i=n(166);n.n(i).a},function(t,e,n){"use strict";var i=n(167);n.n(i).a},function(t,e,n){"use strict";var i=n(168);n.n(i).a},function(t,e,n){"use strict";var i=n(169);n.n(i).a},function(t,e,n){"use strict";var i=n(170);n.n(i).a},function(t,e,n){"use strict";var i=n(171);n.n(i).a},function(t,e,n){"use strict";var i=n(172);n.n(i).a},function(t,e,n){"use strict";var i=n(173);n.n(i).a},function(t,e,n){"use strict";var i=n(174);n.n(i).a},function(t,e,n){"use strict";var i=n(175);n.n(i).a},function(t,e,n){"use strict";var i=n(176);n.n(i).a},function(t,e,n){"use strict";var i=n(177);n.n(i).a},function(t,e,n){"use strict";var i=n(178);n.n(i).a},function(t,e,n){},function(t,e,n){"use strict";var i=n(179);n.n(i).a},function(t,e,n){"use strict";var i=n(180);n.n(i).a},function(t,e,n){"use strict";var i=n(181);n.n(i).a},function(t,e,n){"use strict";var i=n(182);n.n(i).a},function(t,e,n){"use strict";var i=n(183);n.n(i).a},function(t,e,n){"use strict";var i=n(184);n.n(i).a},function(t,e,n){"use strict";var i=n(185);n.n(i).a},function(t,e,n){"use strict";var i=n(186);n.n(i).a},function(t,e,n){"use strict";var i=n(187);n.n(i).a},function(t,e,n){},,,,,,function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAOCAYAAADwikbvAAAAAXNSR0IArs4c6QAAAONJREFUKBVjYEACKuueh6qsfVaAJARnqqx7VgiShwsAGUzInP9MbCcYGP/XKG94K4ssDuH/rwbLI0kwGp/5z/rx0Yvm/wz/4xj+/5dEksPOZGR8zsjAuIhfTqKWEeiUDqBGPcb/7Gl3goWfYNeBEFVZ+1bmP+PPWUADLjEqr3v2DKjRjBiNMCOgBpxiUF779D9MkBQapA8lwGCagRK3YGwQjc6HyWHVDJRUhSmA0uh8sDAuzWh6sXNxab6NphydD5GmLMCAkQ4KejSb8HLB6oH6mECpBRTpxBoAjWNQIllEUfIEAL7CZEeEoUL3AAAAAElFTkSuQmCC"},function(t,e,n){"use strict";var i=n(190);n.n(i).a},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i=n(332);n.n(i).a},,,,,,,,,function(t,e,n){"use strict";n.r(e);n(14);var i=n(22),o=n(6),r=n(199),a=n(9),s=n.n(a),c=n(42),u=n(37),l=(n(319),n(205)),d=n(300),f=n(150),p=n(198),h=n(7),m=n(4),g=n(302),v=n(5),b=n(0),y={data:function(){return{cardInfo:void 0,defaultTab:2,pageType:b.c.DETAIL,isInit:!1,isMobile:Object(g.a)(),styleString:"",myLoginInfo:void 0}},components:{StickyBar:d.a,Card:l.a,BackTop:f.a,CheckLogin:p.a},mounted:function(){var t=this;this.isMobile&&this.adaptMobile(),this.getLoginInfo().then(function(){m.t.getUid()?t.getMyUserInfo().then(t.getAttentionList).then(t.getCardInfo):t.getCardInfo(),t.isInit=!0,Object(h.c)("444.42","000391","000502",t.isGuest?{nologin:1}:{})})},methods:{getLoginInfo:function(){var t=this;return this.bpapi({method:"get",url:"".concat(v.a.API_MAIN,"/x/web-interface/nav")}).then(function(e){m.t.setMyLoginInfo(e.data),t.myLoginInfo=m.t.getMyLoginInfo()},function(){return m.t.resetMyLoginInfo(),t.myLoginInfo=m.t.getMyLoginInfo(),0})},getMyUserInfo:function(){return this.bpapi({url:v.a.API_MAIN+"/x/web-interface/card",method:"get",data:{mid:m.t.getUid(),photo:!0}}).then(function(t){m.t.setMyUserInfo(t.data)},function(){return m.t.resetMyUserInfo(),0})},getAttentionList:function(){return this.bpapi({method:"get",url:"".concat(v.a.API_VC,"/feed/v1/feed/get_attention_list"),data:{uid:m.t.getUid()}}).then(function(t){m.t.setMyAttentionList(t.data.list)},function(){return m.t.resetMyAttentionList(),0})},getCardInfo:function(){var t=this,e=Object(o.h)(window.location),n={};if(~~e.params.type===b.a.PIC){var i=e.path[0];i?(n.rid=~~i,n.type=~~e.params.type):this.redirectTo404()}else{var r=e.path[0];r?n.dynamic_id="".concat(r):this.redirectTo404()}this.bpapi({method:"get",url:v.a.API_VC+"/dynamic_svr/v1/dynamic_svr/get_dynamic_detail",data:n}).then(function(n){n.data.card?(t.cardInfo=n.data.card,t.defaultTab=~~e.params.tab||2,t.modifyTitle()):t.redirectTo404()},function(){t.redirectTo404()})},deleteHandler:function(){window.location.href="".concat(v.a.T)},adaptMobile:function(){var t=document.getElementsByTagName("body")[0],e=(window.innerWidth/632).toFixed(2),n="width: 632px; transform-origin: 0 0; transform: scale(".concat(e,")");t.setAttribute("style",n),this.styleString="min-height: ".concat(100/e,"vh")},modifyTitle:function(){this.cardInfo&&this.cardInfo.desc&&this.cardInfo.desc.user_profile&&this.cardInfo.desc.user_profile&&this.cardInfo.desc.user_profile.info&&this.cardInfo.desc.user_profile.info.uname?document.title="".concat(this.cardInfo.desc.user_profile.info.uname,"的动态-哔哩哔哩"):document.title="动态-哔哩哔哩"},redirectTo404:function(){window.location.href="".concat(v.a.MAIN,"/404")}},computed:{isSelf:function(){return!!this.myLoginInfo.isLogin&&m.t.getUid()===this.cardInfo.desc.uid},isGuest:function(){return!m.t.getUid()}}},_=(n(513),n(2)),w=Object(_.a)(y,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.isInit&&!t.isMobile?n("sticky-bar",{attrs:{"page-type":t.pageType,"login-info":t.myLoginInfo}}):t._e(),n("div",{staticClass:"detail-content"},[n("div",{staticClass:"detail-card",class:{"is-mobile":t.isMobile}},[t.cardInfo?n("card",{class:{"card-is-mobile":t.isMobile},style:t.styleString,attrs:{"card-info":t.cardInfo,"is-self":t.isSelf,"default-tab":t.defaultTab,"page-type":t.pageType},on:{delete:t.deleteHandler}}):t._e()],1)]),n("back-top"),n("check-login")],1)},[],!1,null,"61c053c3",null).exports;n(213),n(296),n(50),n(76),n(53),n(297);s.a.use(c.a),s.a.use(Object(u.a)()),s.a.use(i.b),new s.a({el:"#app",store:r.a,components:{BpPopup:c.a,Detail:w},computed:{appMarginTop:function(){return"IE 9"===Object(o.d)()?"30px":0}},mounted:function(){window.spmReportData={},window.reportConfig={sample:1,scrollTracker:!0,msgObjects:"spmReportData"};var t=document.createElement("script");t.src="https://s1.hdslb.com/bfs/seed/log/report/log-reporter.js",document.getElementsByTagName("body")[0].appendChild(t)}})}]);
//# sourceMappingURL=detail.e58da204.js.map